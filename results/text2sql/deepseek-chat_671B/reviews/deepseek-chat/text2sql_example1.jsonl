{"index": 48, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE research_docs (doc_id INT PRIMARY KEY, title TEXT, author TEXT, category TEXT, file_size INT, created_date DATE, updated_date DATE, version TEXT, status TEXT, tags TEXT, description TEXT);\nQuestion: 找出标题中包含'算法'或'设计'的文档，显示文档ID、标题、类别和创建日期，按创建日期降序排列。\nSQL:", "target": "SELECT doc_id, title, category, created_date FROM research_docs WHERE title LIKE '%算法%' OR title LIKE '%设计%' ORDER BY created_date DESC;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT doc_id, title, category, created_date FROM research_docs WHERE title LIKE '%算法%' OR title LIKE '%设计%' ORDER BY created_date DESC", "prediction": "```sql\nSELECT doc_id, title, category, created_date\nFROM research_docs\nWHERE title LIKE '%算法%' OR title LIKE '%设计%'\nORDER BY created_date DESC;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 48, "group_id": 48, "sample_metadata": {}}}
{"index": 9, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE users (user_id INT PRIMARY KEY, username TEXT, email TEXT, age INT, gender TEXT, registration_date DATE, last_login_date DATE, status TEXT, city TEXT, phone TEXT);\nQuestion: 统计每个状态（status）的用户数量，并计算各状态用户占总用户数的百分比。\nSQL:", "target": "SELECT status, COUNT(*) as count, ROUND(COUNT(*) * 100.0 / (SELECT COUNT(*) FROM users), 2) as percentage FROM users GROUP BY status;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.46474358974358976}, "extracted_prediction": "SELECT      status,     COUNT(*) AS user_count,     ROUND(COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (), 2) AS percentage FROM users GROUP BY status ORDER BY user_count DESC", "prediction": "```sql\nSELECT \n    status,\n    COUNT(*) AS user_count,\n    ROUND(COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (), 2) AS percentage\nFROM users\nGROUP BY status\nORDER BY user_count DESC;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 9, "group_id": 9, "sample_metadata": {}}}
{"index": 77, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE user_interaction_logs (log_id INT PRIMARY KEY, user_id INT, action_type TEXT, page_url TEXT, session_id TEXT, timestamp TIMESTAMP, ip_address TEXT, device_type TEXT, browser TEXT, duration INT, status_code INT);\nQuestion: 找出每个会话中操作时长最长的日志，显示会话ID、日志ID、操作类型和时长，按时长降序排列。\nSQL:", "target": "SELECT session_id, log_id, action_type, duration FROM user_interaction_logs l1 WHERE duration = (SELECT MAX(duration) FROM user_interaction_logs l2 WHERE l2.session_id = l1.session_id) ORDER BY duration DESC;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.5066666666666666}, "extracted_prediction": "SELECT      session_id,     log_id,     action_type,     duration FROM user_interaction_logs WHERE (session_id, duration) IN (     SELECT          session_id,         MAX(duration) AS max_duration     FROM user_interaction_logs     GROUP BY session_id ) ORDER BY duration DESC", "prediction": "```sql\nSELECT \n    session_id,\n    log_id,\n    action_type,\n    duration\nFROM user_interaction_logs\nWHERE (session_id, duration) IN (\n    SELECT \n        session_id,\n        MAX(duration) AS max_duration\n    FROM user_interaction_logs\n    GROUP BY session_id\n)\nORDER BY duration DESC;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 77, "group_id": 77, "sample_metadata": {}}}
{"index": 47, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE research_docs (doc_id INT PRIMARY KEY, title TEXT, author TEXT, category TEXT, file_size INT, created_date DATE, updated_date DATE, version TEXT, status TEXT, tags TEXT, description TEXT);\nQuestion: 查询最近6个月内更新的文档，找出每个作者更新的文档数量，只显示更新数量大于10的作者。\nSQL:", "target": "SELECT author, COUNT(*) as update_count FROM research_docs WHERE updated_date >= DATE('now', '-6 months') GROUP BY author HAVING COUNT(*) > 10 ORDER BY update_count DESC;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.8181216931216931}, "extracted_prediction": "SELECT      author,     COUNT(doc_id) AS update_count FROM research_docs WHERE updated_date >= DATE_SUB(CURDATE(), INTERVAL 6 MONTH) GROUP BY author HAVING COUNT(doc_id) > 10 ORDER BY update_count DESC", "prediction": "```sql\nSELECT \n    author,\n    COUNT(doc_id) AS update_count\nFROM research_docs\nWHERE updated_date >= DATE_SUB(CURDATE(), INTERVAL 6 MONTH)\nGROUP BY author\nHAVING COUNT(doc_id) > 10\nORDER BY update_count DESC;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 47, "group_id": 47, "sample_metadata": {}}}
{"index": 46, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE research_docs (doc_id INT PRIMARY KEY, title TEXT, author TEXT, category TEXT, file_size INT, created_date DATE, updated_date DATE, version TEXT, status TEXT, tags TEXT, description TEXT);\nQuestion: 统计每个类别的文档数量和平均文件大小，按文档数量降序排列。\nSQL:", "target": "SELECT category, COUNT(*) as doc_count, AVG(file_size) as avg_size FROM research_docs GROUP BY category ORDER BY doc_count DESC;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.7261904761904762}, "extracted_prediction": "SELECT      category,     COUNT(doc_id) AS document_count,     AVG(file_size) AS avg_file_size FROM research_docs GROUP BY category ORDER BY document_count DESC", "prediction": "```sql\nSELECT \n    category,\n    COUNT(doc_id) AS document_count,\n    AVG(file_size) AS avg_file_size\nFROM research_docs\nGROUP BY category\nORDER BY document_count DESC;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 46, "group_id": 46, "sample_metadata": {}}}
{"index": 45, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE research_docs (doc_id INT PRIMARY KEY, title TEXT, author TEXT, category TEXT, file_size INT, created_date DATE, updated_date DATE, version TEXT, status TEXT, tags TEXT, description TEXT);\nQuestion: 查询所有研发文档中，创建时间在2023年且文档大小超过1MB的文档，显示文档ID、标题、大小和创建时间，按大小降序排列。\nSQL:", "target": "SELECT doc_id, title, file_size, created_date FROM research_docs WHERE strftime('%Y', created_date) = '2023' AND file_size > 1048576 ORDER BY file_size DESC;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.541958041958042}, "extracted_prediction": "SELECT doc_id, title, file_size, created_date FROM research_docs WHERE EXTRACT(YEAR FROM created_date) = 2023   AND file_size > 1048576  -- 1MB = 1024*1024 bytes ORDER BY file_size DESC", "prediction": "```sql\nSELECT doc_id, title, file_size, created_date\nFROM research_docs\nWHERE EXTRACT(YEAR FROM created_date) = 2023\n  AND file_size > 1048576  -- 1MB = 1024*1024 bytes\nORDER BY file_size DESC;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 45, "group_id": 45, "sample_metadata": {}}}
{"index": 13, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE users (user_id INT PRIMARY KEY, username TEXT, email TEXT, age INT, gender TEXT, registration_date DATE, last_login_date DATE, status TEXT, city TEXT, phone TEXT);\nQuestion: 统计2023年每个月新增用户数量，只显示新增用户数超过50的月份。\nSQL:", "target": "SELECT strftime('%Y-%m', registration_date) as month, COUNT(*) as count FROM users WHERE strftime('%Y', registration_date) = '2023' GROUP BY month HAVING COUNT(*) > 50 ORDER BY month;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.4515993265993266}, "extracted_prediction": "SELECT      EXTRACT(MONTH FROM registration_date) AS month,     COUNT(*) AS new_user_count FROM users WHERE EXTRACT(YEAR FROM registration_date) = 2023 GROUP BY EXTRACT(MONTH FROM registration_date) HAVING COUNT(*) > 50 ORDER BY month", "prediction": "```sql\nSELECT \n    EXTRACT(MONTH FROM registration_date) AS month,\n    COUNT(*) AS new_user_count\nFROM users\nWHERE EXTRACT(YEAR FROM registration_date) = 2023\nGROUP BY EXTRACT(MONTH FROM registration_date)\nHAVING COUNT(*) > 50\nORDER BY month;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 13, "group_id": 13, "sample_metadata": {}}}
{"index": 12, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE users (user_id INT PRIMARY KEY, username TEXT, email TEXT, age INT, gender TEXT, registration_date DATE, last_login_date DATE, status TEXT, city TEXT, phone TEXT);\nQuestion: 查询每个城市中年龄最大的用户，显示城市、用户名和年龄。\nSQL:", "target": "SELECT city, username, age FROM users u1 WHERE age = (SELECT MAX(age) FROM users u2 WHERE u2.city = u1.city);", "sample_score": {"score": {"value": {"sql_ast_sim": 0.75}, "extracted_prediction": "SELECT      city,     username,     age FROM users u1 WHERE age = (     SELECT MAX(age)     FROM users u2     WHERE u2.city = u1.city ) ORDER BY city", "prediction": "```sql\nSELECT \n    city,\n    username,\n    age\nFROM users u1\nWHERE age = (\n    SELECT MAX(age)\n    FROM users u2\n    WHERE u2.city = u1.city\n)\nORDER BY city;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 12, "group_id": 12, "sample_metadata": {}}}
{"index": 44, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE orders (order_id INT PRIMARY KEY, user_id INT, order_date DATE, total_amount DECIMAL(10,2), status TEXT, payment_method TEXT, shipping_address TEXT, discount DECIMAL(10,2), tax DECIMAL(10,2), created_at TIMESTAMP);\nQuestion: 找出每个支付方式中订单金额最大的订单，显示支付方式、订单号和金额。\nSQL:", "target": "SELECT payment_method, order_id, total_amount FROM orders o1 WHERE total_amount = (SELECT MAX(total_amount) FROM orders o2 WHERE o2.payment_method = o1.payment_method);", "sample_score": {"score": {"value": {"sql_ast_sim": 0.203030303030303}, "extracted_prediction": "SELECT      payment_method,     order_id,     total_amount FROM (     SELECT          payment_method,         order_id,         total_amount,         ROW_NUMBER() OVER (PARTITION BY payment_method ORDER BY total_amount DESC) AS rn     FROM orders ) ranked WHERE rn = 1", "prediction": "```sql\nSELECT \n    payment_method,\n    order_id,\n    total_amount\nFROM (\n    SELECT \n        payment_method,\n        order_id,\n        total_amount,\n        ROW_NUMBER() OVER (PARTITION BY payment_method ORDER BY total_amount DESC) AS rn\n    FROM orders\n) ranked\nWHERE rn = 1;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 44, "group_id": 44, "sample_metadata": {}}}
{"index": 16, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE users (user_id INT PRIMARY KEY, username TEXT, email TEXT, age INT, gender TEXT, registration_date DATE, last_login_date DATE, status TEXT, city TEXT, phone TEXT);\nQuestion: 查询注册时间距离今天正好365天的用户数量。\nSQL:", "target": "SELECT COUNT(*) FROM users WHERE registration_date = DATE('now', '-365 days');", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT COUNT(*)  FROM users  WHERE registration_date = DATE('now', '-365 days')", "prediction": "```sql\nSELECT COUNT(*) \nFROM users \nWHERE registration_date = DATE('now', '-365 days');\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 16, "group_id": 16, "sample_metadata": {}}}
{"index": 73, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE user_interaction_logs (log_id INT PRIMARY KEY, user_id INT, action_type TEXT, page_url TEXT, session_id TEXT, timestamp TIMESTAMP, ip_address TEXT, device_type TEXT, browser TEXT, duration INT, status_code INT);\nQuestion: 找出每个用户操作时长最长的日志，显示用户ID、日志ID、操作类型和时长。\nSQL:", "target": "SELECT user_id, log_id, action_type, duration FROM user_interaction_logs l1 WHERE duration = (SELECT MAX(duration) FROM user_interaction_logs l2 WHERE l2.user_id = l1.user_id);", "sample_score": {"score": {"value": {"sql_ast_sim": 0.2619047619047619}, "extracted_prediction": "SELECT      user_id,     log_id,     action_type,     duration FROM (     SELECT          user_id,         log_id,         action_type,         duration,         ROW_NUMBER() OVER (PARTITION BY user_id ORDER BY duration DESC) AS rn     FROM user_interaction_logs     WHERE duration IS NOT NULL ) ranked WHERE rn = 1", "prediction": "```sql\nSELECT \n    user_id,\n    log_id,\n    action_type,\n    duration\nFROM (\n    SELECT \n        user_id,\n        log_id,\n        action_type,\n        duration,\n        ROW_NUMBER() OVER (PARTITION BY user_id ORDER BY duration DESC) AS rn\n    FROM user_interaction_logs\n    WHERE duration IS NOT NULL\n) ranked\nWHERE rn = 1;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 73, "group_id": 73, "sample_metadata": {}}}
{"index": 15, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE users (user_id INT PRIMARY KEY, username TEXT, email TEXT, age INT, gender TEXT, registration_date DATE, last_login_date DATE, status TEXT, city TEXT, phone TEXT);\nQuestion: 找出年龄在所在城市平均年龄以上的用户，显示用户ID、用户名、城市和年龄。\nSQL:", "target": "SELECT user_id, username, city, age FROM users u1 WHERE age > (SELECT AVG(age) FROM users u2 WHERE u2.city = u1.city);", "sample_score": {"score": {"value": {"sql_ast_sim": 0.18611111111111112}, "extracted_prediction": "SELECT      u.user_id,     u.username,     u.city,     u.age FROM users u INNER JOIN (     SELECT          city,         AVG(age) AS avg_age     FROM users     GROUP BY city ) city_avg ON u.city = city_avg.city WHERE u.age > city_avg.avg_age", "prediction": "```sql\nSELECT \n    u.user_id,\n    u.username,\n    u.city,\n    u.age\nFROM users u\nINNER JOIN (\n    SELECT \n        city,\n        AVG(age) AS avg_age\n    FROM users\n    GROUP BY city\n) city_avg ON u.city = city_avg.city\nWHERE u.age > city_avg.avg_age;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 15, "group_id": 15, "sample_metadata": {}}}
{"index": 43, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE orders (order_id INT PRIMARY KEY, user_id INT, order_date DATE, total_amount DECIMAL(10,2), status TEXT, payment_method TEXT, shipping_address TEXT, discount DECIMAL(10,2), tax DECIMAL(10,2), created_at TIMESTAMP);\nQuestion: 查询订单金额大于平均值且状态为已完成的订单，显示订单号和金额，按金额降序排列。\nSQL:", "target": "SELECT order_id, total_amount FROM orders WHERE total_amount > (SELECT AVG(total_amount) FROM orders) AND status = 'completed' ORDER BY total_amount DESC;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.6904761904761905}, "extracted_prediction": "SELECT order_id, total_amount FROM orders WHERE status = '已完成'   AND total_amount > (SELECT AVG(total_amount) FROM orders) ORDER BY total_amount DESC", "prediction": "```sql\nSELECT order_id, total_amount\nFROM orders\nWHERE status = '已完成'\n  AND total_amount > (SELECT AVG(total_amount) FROM orders)\nORDER BY total_amount DESC;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 43, "group_id": 43, "sample_metadata": {}}}
{"index": 67, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE user_interaction_logs (log_id INT PRIMARY KEY, user_id INT, action_type TEXT, page_url TEXT, session_id TEXT, timestamp TIMESTAMP, ip_address TEXT, device_type TEXT, browser TEXT, duration INT, status_code INT);\nQuestion: 统计每个设备类型的日志数量和平均操作时长，按日志数量降序排列。\nSQL:", "target": "SELECT device_type, COUNT(*) as log_count, AVG(duration) as avg_duration FROM user_interaction_logs GROUP BY device_type ORDER BY log_count DESC;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.9583333333333334}, "extracted_prediction": "SELECT      device_type,     COUNT(log_id) AS log_count,     AVG(duration) AS avg_duration FROM user_interaction_logs GROUP BY device_type ORDER BY log_count DESC", "prediction": "```sql\nSELECT \n    device_type,\n    COUNT(log_id) AS log_count,\n    AVG(duration) AS avg_duration\nFROM user_interaction_logs\nGROUP BY device_type\nORDER BY log_count DESC;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 67, "group_id": 67, "sample_metadata": {}}}
{"index": 76, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE user_interaction_logs (log_id INT PRIMARY KEY, user_id INT, action_type TEXT, page_url TEXT, session_id TEXT, timestamp TIMESTAMP, ip_address TEXT, device_type TEXT, browser TEXT, duration INT, status_code INT);\nQuestion: 查询操作类型为'click'或'view'的日志，按设备类型统计数量和平均时长，按数量降序排列。\nSQL:", "target": "SELECT device_type, COUNT(*) as count, AVG(duration) as avg_duration FROM user_interaction_logs WHERE action_type IN ('click', 'view') GROUP BY device_type ORDER BY count DESC;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.8484848484848484}, "extracted_prediction": "SELECT      device_type,     COUNT(*) AS log_count,     AVG(duration) AS avg_duration FROM user_interaction_logs WHERE action_type IN ('click', 'view') GROUP BY device_type ORDER BY log_count DESC", "prediction": "```sql\nSELECT \n    device_type,\n    COUNT(*) AS log_count,\n    AVG(duration) AS avg_duration\nFROM user_interaction_logs\nWHERE action_type IN ('click', 'view')\nGROUP BY device_type\nORDER BY log_count DESC;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 76, "group_id": 76, "sample_metadata": {}}}
{"index": 79, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE user_interaction_logs (log_id INT PRIMARY KEY, user_id INT, action_type TEXT, page_url TEXT, session_id TEXT, timestamp TIMESTAMP, ip_address TEXT, device_type TEXT, browser TEXT, duration INT, status_code INT);\nQuestion: 统计每个操作类型在不同设备类型下的平均操作时长，使用透视表格式显示。\nSQL:", "target": "SELECT action_type, AVG(CASE WHEN device_type = 'desktop' THEN duration END) as desktop_avg, AVG(CASE WHEN device_type = 'mobile' THEN duration END) as mobile_avg, AVG(CASE WHEN device_type = 'tablet' THEN duration END) as tablet_avg FROM user_interaction_logs GROUP BY action_type;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.32727272727272727}, "extracted_prediction": "SELECT      device_type,     AVG(CASE WHEN action_type = 'click' THEN duration END) AS avg_duration_click,     AVG(CASE WHEN action_type = 'scroll' THEN duration END) AS avg_duration_scroll,     AVG(CASE WHEN action_type = 'hover' THEN duration END) AS avg_duration_hover,     AVG(CASE WHEN action_type = 'input' THEN duration END) AS avg_duration_input,     AVG(CASE WHEN action_type = 'submit' THEN duration END) AS avg_duration_submit FROM user_interaction_logs WHERE duration IS NOT NULL GROUP BY device_type ORDER BY device_type", "prediction": "```sql\nSELECT \n    device_type,\n    AVG(CASE WHEN action_type = 'click' THEN duration END) AS avg_duration_click,\n    AVG(CASE WHEN action_type = 'scroll' THEN duration END) AS avg_duration_scroll,\n    AVG(CASE WHEN action_type = 'hover' THEN duration END) AS avg_duration_hover,\n    AVG(CASE WHEN action_type = 'input' THEN duration END) AS avg_duration_input,\n    AVG(CASE WHEN action_type = 'submit' THEN duration END) AS avg_duration_submit\nFROM user_interaction_logs\nWHERE duration IS NOT NULL\nGROUP BY device_type\nORDER BY device_type;\n```\n\n**说明：**\n1. 使用 `CASE WHEN` 语句为每个 `action_type` 创建单独的列，计算平均时长。\n2. `AVG()` 函数会自动忽略 `NULL` 值，因此当某设备类型没有特定操作类型时，对应单元格会显示为 `NULL`。\n3. `WHERE duration IS NOT NULL` 确保只计算有效时长的记录。\n4. 如果操作类型不固定或未知，可以动态生成列，但标准 SQL 需要预先定义列结构。\n5. 结果以 `device_type` 为行，不同 `action_type` 的平均时长为列，形成透视表格式。", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 79, "group_id": 79, "sample_metadata": {}}}
{"index": 25, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE orders (order_id INT PRIMARY KEY, user_id INT, order_date DATE, total_amount DECIMAL(10,2), status TEXT, payment_method TEXT, shipping_address TEXT, discount DECIMAL(10,2), tax DECIMAL(10,2), created_at TIMESTAMP);\nQuestion: 查询订单总金额超过10000元的订单，显示订单号、用户ID、订单金额和下单时间，按金额降序排列。\nSQL:", "target": "SELECT order_id, user_id, total_amount, order_date FROM orders WHERE total_amount > 10000 ORDER BY total_amount DESC;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT order_id, user_id, total_amount, order_date FROM orders WHERE total_amount > 10000 ORDER BY total_amount DESC", "prediction": "```sql\nSELECT order_id, user_id, total_amount, order_date\nFROM orders\nWHERE total_amount > 10000\nORDER BY total_amount DESC;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 25, "group_id": 25, "sample_metadata": {}}}
{"index": 42, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE orders (order_id INT PRIMARY KEY, user_id INT, order_date DATE, total_amount DECIMAL(10,2), status TEXT, payment_method TEXT, shipping_address TEXT, discount DECIMAL(10,2), tax DECIMAL(10,2), created_at TIMESTAMP);\nQuestion: 统计每个用户的总订单数、总订单金额和平均订单金额，只显示订单数大于5的用户，按总金额降序排列。\nSQL:", "target": "SELECT user_id, COUNT(*) as order_count, SUM(total_amount) as total_amount, AVG(total_amount) as avg_amount FROM orders GROUP BY user_id HAVING COUNT(*) > 5 ORDER BY total_amount DESC;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.8857142857142858}, "extracted_prediction": "SELECT      user_id,     COUNT(order_id) AS total_orders,     SUM(total_amount) AS total_amount,     AVG(total_amount) AS avg_amount FROM orders GROUP BY user_id HAVING COUNT(order_id) > 5 ORDER BY total_amount DESC", "prediction": "```sql\nSELECT \n    user_id,\n    COUNT(order_id) AS total_orders,\n    SUM(total_amount) AS total_amount,\n    AVG(total_amount) AS avg_amount\nFROM orders\nGROUP BY user_id\nHAVING COUNT(order_id) > 5\nORDER BY total_amount DESC;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 42, "group_id": 42, "sample_metadata": {}}}
{"index": 59, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE research_docs (doc_id INT PRIMARY KEY, title TEXT, author TEXT, category TEXT, file_size INT, created_date DATE, updated_date DATE, version TEXT, status TEXT, tags TEXT, description TEXT);\nQuestion: 查询描述长度大于100个字符的文档，显示文档ID、标题和描述长度，按描述长度降序排列。\nSQL:", "target": "SELECT doc_id, title, LENGTH(description) as desc_length FROM research_docs WHERE LENGTH(description) > 100 ORDER BY desc_length DESC;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.7833333333333333}, "extracted_prediction": "SELECT doc_id, title, LENGTH(description) AS description_length FROM research_docs WHERE LENGTH(description) > 100 ORDER BY description_length DESC", "prediction": "```sql\nSELECT doc_id, title, LENGTH(description) AS description_length\nFROM research_docs\nWHERE LENGTH(description) > 100\nORDER BY description_length DESC;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 59, "group_id": 59, "sample_metadata": {}}}
{"index": 32, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE orders (order_id INT PRIMARY KEY, user_id INT, order_date DATE, total_amount DECIMAL(10,2), status TEXT, payment_method TEXT, shipping_address TEXT, discount DECIMAL(10,2), tax DECIMAL(10,2), created_at TIMESTAMP);\nQuestion: 找出订单金额在所在状态的平均金额以上的订单，显示订单号、状态和金额。\nSQL:", "target": "SELECT order_id, status, total_amount FROM orders o1 WHERE total_amount > (SELECT AVG(total_amount) FROM orders o2 WHERE o2.status = o1.status);", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT      order_id,     status,     total_amount FROM orders o1 WHERE total_amount > (     SELECT AVG(total_amount)     FROM orders o2     WHERE o2.status = o1.status )", "prediction": "```sql\nSELECT \n    order_id,\n    status,\n    total_amount\nFROM orders o1\nWHERE total_amount > (\n    SELECT AVG(total_amount)\n    FROM orders o2\n    WHERE o2.status = o1.status\n);\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 32, "group_id": 32, "sample_metadata": {}}}
{"index": 71, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE user_interaction_logs (log_id INT PRIMARY KEY, user_id INT, action_type TEXT, page_url TEXT, session_id TEXT, timestamp TIMESTAMP, ip_address TEXT, device_type TEXT, browser TEXT, duration INT, status_code INT);\nQuestion: 统计每个浏览器在不同设备类型下的日志数量，使用交叉表格式显示。\nSQL:", "target": "SELECT browser, SUM(CASE WHEN device_type = 'desktop' THEN 1 ELSE 0 END) as desktop_count, SUM(CASE WHEN device_type = 'mobile' THEN 1 ELSE 0 END) as mobile_count, SUM(CASE WHEN device_type = 'tablet' THEN 1 ELSE 0 END) as tablet_count FROM user_interaction_logs GROUP BY browser;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.6203703703703703}, "extracted_prediction": "SELECT      browser,     COUNT(CASE WHEN device_type = 'Desktop' THEN 1 END) AS Desktop,     COUNT(CASE WHEN device_type = 'Mobile' THEN 1 END) AS Mobile,     COUNT(CASE WHEN device_type = 'Tablet' THEN 1 END) AS Tablet,     COUNT(CASE WHEN device_type NOT IN ('Desktop', 'Mobile', 'Tablet') THEN 1 END) AS Other,     COUNT(*) AS Total FROM user_interaction_logs GROUP BY browser ORDER BY browser", "prediction": "```sql\nSELECT \n    browser,\n    COUNT(CASE WHEN device_type = 'Desktop' THEN 1 END) AS Desktop,\n    COUNT(CASE WHEN device_type = 'Mobile' THEN 1 END) AS Mobile,\n    COUNT(CASE WHEN device_type = 'Tablet' THEN 1 END) AS Tablet,\n    COUNT(CASE WHEN device_type NOT IN ('Desktop', 'Mobile', 'Tablet') THEN 1 END) AS Other,\n    COUNT(*) AS Total\nFROM user_interaction_logs\nGROUP BY browser\nORDER BY browser;\n```\n\n或者使用更通用的方式，自动适配所有设备类型：\n\n```sql\nSELECT \n    browser,\n    SUM(CASE WHEN device_type = 'Desktop' THEN 1 ELSE 0 END) AS Desktop,\n    SUM(CASE WHEN device_type = 'Mobile' THEN 1 ELSE 0 END) AS Mobile,\n    SUM(CASE WHEN device_type = 'Tablet' THEN 1 ELSE 0 END) AS Tablet,\n    SUM(CASE WHEN device_type NOT IN ('Desktop', 'Mobile', 'Tablet') THEN 1 ELSE 0 END) AS Other,\n    COUNT(*) AS Total\nFROM user_interaction_logs\nGROUP BY browser\nORDER BY browser;\n```\n\n如果你需要完全动态的设备类型列（不知道具体有哪些设备类型），可以使用以下查询先查看所有设备类型：\n\n```sql\nSELECT DISTINCT device_type FROM user_interaction_logs ORDER BY device_type;\n```\n\n然后根据实际结果调整上述查询中的设备类型分类。", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 71, "group_id": 71, "sample_metadata": {}}}
{"index": 62, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE research_docs (doc_id INT PRIMARY KEY, title TEXT, author TEXT, category TEXT, file_size INT, created_date DATE, updated_date DATE, version TEXT, status TEXT, tags TEXT, description TEXT);\nQuestion: 找出标题长度大于30个字符且文件大小小于500KB的文档，显示文档ID、标题和文件大小。\nSQL:", "target": "SELECT doc_id, title, file_size FROM research_docs WHERE LENGTH(title) > 30 AND file_size < 512000 ORDER BY file_size ASC;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.75}, "extracted_prediction": "SELECT doc_id, title, file_size FROM research_docs WHERE LENGTH(title) > 30 AND file_size < 500", "prediction": "```sql\nSELECT doc_id, title, file_size\nFROM research_docs\nWHERE LENGTH(title) > 30 AND file_size < 500;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 62, "group_id": 62, "sample_metadata": {}}}
{"index": 69, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE user_interaction_logs (log_id INT PRIMARY KEY, user_id INT, action_type TEXT, page_url TEXT, session_id TEXT, timestamp TIMESTAMP, ip_address TEXT, device_type TEXT, browser TEXT, duration INT, status_code INT);\nQuestion: 找出操作时长在平均值以上的日志，按用户ID分组统计数量，只显示数量大于20的用户。\nSQL:", "target": "SELECT user_id, COUNT(*) as count FROM user_interaction_logs WHERE duration > (SELECT AVG(duration) FROM user_interaction_logs) GROUP BY user_id HAVING COUNT(*) > 20;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.6380952380952382}, "extracted_prediction": "SELECT      user_id,     COUNT(*) AS log_count FROM user_interaction_logs WHERE duration > (     SELECT AVG(duration)      FROM user_interaction_logs     WHERE duration IS NOT NULL ) GROUP BY user_id HAVING COUNT(*) > 20 ORDER BY log_count DESC", "prediction": "```sql\nSELECT \n    user_id,\n    COUNT(*) AS log_count\nFROM user_interaction_logs\nWHERE duration > (\n    SELECT AVG(duration) \n    FROM user_interaction_logs\n    WHERE duration IS NOT NULL\n)\nGROUP BY user_id\nHAVING COUNT(*) > 20\nORDER BY log_count DESC;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 69, "group_id": 69, "sample_metadata": {}}}
{"index": 75, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE user_interaction_logs (log_id INT PRIMARY KEY, user_id INT, action_type TEXT, page_url TEXT, session_id TEXT, timestamp TIMESTAMP, ip_address TEXT, device_type TEXT, browser TEXT, duration INT, status_code INT);\nQuestion: 统计2023年每个季度的日志总数量和平均操作时长，按季度排序。\nSQL:", "target": "SELECT CASE WHEN strftime('%m', timestamp) IN ('01','02','03') THEN 'Q1' WHEN strftime('%m', timestamp) IN ('04','05','06') THEN 'Q2' WHEN strftime('%m', timestamp) IN ('07','08','09') THEN 'Q3' ELSE 'Q4' END as quarter, COUNT(*) as total_count, AVG(duration) as avg_duration FROM user_interaction_logs WHERE strftime('%Y', timestamp) = '2023' GROUP BY quarter ORDER BY quarter;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.32126984126984126}, "extracted_prediction": "SELECT      EXTRACT(QUARTER FROM timestamp) AS quarter,     COUNT(*) AS total_logs,     AVG(duration) AS avg_duration FROM user_interaction_logs WHERE EXTRACT(YEAR FROM timestamp) = 2023 GROUP BY EXTRACT(QUARTER FROM timestamp) ORDER BY quarter", "prediction": "```sql\nSELECT \n    EXTRACT(QUARTER FROM timestamp) AS quarter,\n    COUNT(*) AS total_logs,\n    AVG(duration) AS avg_duration\nFROM user_interaction_logs\nWHERE EXTRACT(YEAR FROM timestamp) = 2023\nGROUP BY EXTRACT(QUARTER FROM timestamp)\nORDER BY quarter;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 75, "group_id": 75, "sample_metadata": {}}}
{"index": 41, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE orders (order_id INT PRIMARY KEY, user_id INT, order_date DATE, total_amount DECIMAL(10,2), status TEXT, payment_method TEXT, shipping_address TEXT, discount DECIMAL(10,2), tax DECIMAL(10,2), created_at TIMESTAMP);\nQuestion: 查询2023年12月的订单，按日期统计每天的订单数量和总金额，只显示订单数量超过10的日期。\nSQL:", "target": "SELECT order_date, COUNT(*) as count, SUM(total_amount) as total FROM orders WHERE strftime('%Y-%m', order_date) = '2023-12' GROUP BY order_date HAVING COUNT(*) > 10 ORDER BY order_date;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.7634920634920634}, "extracted_prediction": "SELECT      order_date,     COUNT(order_id) AS order_count,     SUM(total_amount) AS total_amount FROM orders WHERE order_date >= '2023-12-01'      AND order_date <= '2023-12-31' GROUP BY order_date HAVING COUNT(order_id) > 10 ORDER BY order_date", "prediction": "```sql\nSELECT \n    order_date,\n    COUNT(order_id) AS order_count,\n    SUM(total_amount) AS total_amount\nFROM orders\nWHERE order_date >= '2023-12-01' \n    AND order_date <= '2023-12-31'\nGROUP BY order_date\nHAVING COUNT(order_id) > 10\nORDER BY order_date;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 41, "group_id": 41, "sample_metadata": {}}}
{"index": 58, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE research_docs (doc_id INT PRIMARY KEY, title TEXT, author TEXT, category TEXT, file_size INT, created_date DATE, updated_date DATE, version TEXT, status TEXT, tags TEXT, description TEXT);\nQuestion: 找出每个作者在2023年创建的文档总大小，只显示总大小超过50MB的作者，按总大小降序排列。\nSQL:", "target": "SELECT author, SUM(file_size) as total_size FROM research_docs WHERE strftime('%Y', created_date) = '2023' GROUP BY author HAVING SUM(file_size) > 52428800 ORDER BY total_size DESC;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.6427609427609428}, "extracted_prediction": "SELECT      author,     SUM(file_size) AS total_size FROM research_docs WHERE      EXTRACT(YEAR FROM created_date) = 2023 GROUP BY author HAVING SUM(file_size) > 50 * 1024 * 1024  -- 假设file_size的单位是字节，50MB = 50 * 1024 * 1024 字节 ORDER BY total_size DESC", "prediction": "```sql\nSELECT \n    author,\n    SUM(file_size) AS total_size\nFROM research_docs\nWHERE \n    EXTRACT(YEAR FROM created_date) = 2023\nGROUP BY author\nHAVING SUM(file_size) > 50 * 1024 * 1024  -- 假设file_size的单位是字节，50MB = 50 * 1024 * 1024 字节\nORDER BY total_size DESC;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 58, "group_id": 58, "sample_metadata": {}}}
{"index": 19, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE users (user_id INT PRIMARY KEY, username TEXT, email TEXT, age INT, gender TEXT, registration_date DATE, last_login_date DATE, status TEXT, city TEXT, phone TEXT);\nQuestion: 找出最后登录时间在最近7天内，且注册时间超过6个月的用户，显示用户名和最后登录时间。\nSQL:", "target": "SELECT username, last_login_date FROM users WHERE last_login_date >= DATE('now', '-7 days') AND registration_date < DATE('now', '-6 months');", "sample_score": {"score": {"value": {"sql_ast_sim": 0.9393939393939394}, "extracted_prediction": "SELECT username, last_login_date FROM users WHERE last_login_date >= DATE('now', '-7 days')   AND registration_date <= DATE('now', '-6 months')", "prediction": "```sql\nSELECT username, last_login_date\nFROM users\nWHERE last_login_date >= DATE('now', '-7 days')\n  AND registration_date <= DATE('now', '-6 months');\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 19, "group_id": 19, "sample_metadata": {}}}
{"index": 40, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE orders (order_id INT PRIMARY KEY, user_id INT, order_date DATE, total_amount DECIMAL(10,2), status TEXT, payment_method TEXT, shipping_address TEXT, discount DECIMAL(10,2), tax DECIMAL(10,2), created_at TIMESTAMP);\nQuestion: 找出税费金额最高的前5个订单，显示订单号、总金额、税费和税费占比。\nSQL:", "target": "SELECT order_id, total_amount, tax, ROUND(tax * 100.0 / total_amount, 2) as tax_rate FROM orders ORDER BY tax DESC LIMIT 5;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.9583333333333334}, "extracted_prediction": "SELECT      order_id,     total_amount,     tax,     ROUND((tax / total_amount) * 100, 2) AS tax_percentage FROM orders ORDER BY tax DESC LIMIT 5", "prediction": "```sql\nSELECT \n    order_id,\n    total_amount,\n    tax,\n    ROUND((tax / total_amount) * 100, 2) AS tax_percentage\nFROM orders\nORDER BY tax DESC\nLIMIT 5;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 40, "group_id": 40, "sample_metadata": {}}}
{"index": 57, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE research_docs (doc_id INT PRIMARY KEY, title TEXT, author TEXT, category TEXT, file_size INT, created_date DATE, updated_date DATE, version TEXT, status TEXT, tags TEXT, description TEXT);\nQuestion: 查询文件大小在1MB到10MB之间的文档，按类别统计数量和总大小，按总大小降序排列。\nSQL:", "target": "SELECT category, COUNT(*) as count, SUM(file_size) as total_size FROM research_docs WHERE file_size BETWEEN 1048576 AND 10485760 GROUP BY category ORDER BY total_size DESC;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.8818181818181818}, "extracted_prediction": "SELECT      category,     COUNT(*) AS doc_count,     SUM(file_size) AS total_size FROM research_docs WHERE file_size BETWEEN 1048576 AND 10485760  -- 1MB = 1048576 bytes, 10MB = 10485760 bytes GROUP BY category ORDER BY total_size DESC", "prediction": "```sql\nSELECT \n    category,\n    COUNT(*) AS doc_count,\n    SUM(file_size) AS total_size\nFROM research_docs\nWHERE file_size BETWEEN 1048576 AND 10485760  -- 1MB = 1048576 bytes, 10MB = 10485760 bytes\nGROUP BY category\nORDER BY total_size DESC;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 57, "group_id": 57, "sample_metadata": {}}}
{"index": 68, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE user_interaction_logs (log_id INT PRIMARY KEY, user_id INT, action_type TEXT, page_url TEXT, session_id TEXT, timestamp TIMESTAMP, ip_address TEXT, device_type TEXT, browser TEXT, duration INT, status_code INT);\nQuestion: 查询2023年每个月的日志数量，只显示日志数量超过10000的月份，按月份排序。\nSQL:", "target": "SELECT strftime('%Y-%m', timestamp) as month, COUNT(*) as log_count FROM user_interaction_logs WHERE strftime('%Y', timestamp) = '2023' GROUP BY month HAVING COUNT(*) > 10000 ORDER BY month;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.449074074074074}, "extracted_prediction": "SELECT      EXTRACT(MONTH FROM timestamp) AS month,     COUNT(*) AS log_count FROM user_interaction_logs WHERE EXTRACT(YEAR FROM timestamp) = 2023 GROUP BY EXTRACT(MONTH FROM timestamp) HAVING COUNT(*) > 10000 ORDER BY month", "prediction": "```sql\nSELECT \n    EXTRACT(MONTH FROM timestamp) AS month,\n    COUNT(*) AS log_count\nFROM user_interaction_logs\nWHERE EXTRACT(YEAR FROM timestamp) = 2023\nGROUP BY EXTRACT(MONTH FROM timestamp)\nHAVING COUNT(*) > 10000\nORDER BY month;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 68, "group_id": 68, "sample_metadata": {}}}
{"index": 74, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE user_interaction_logs (log_id INT PRIMARY KEY, user_id INT, action_type TEXT, page_url TEXT, session_id TEXT, timestamp TIMESTAMP, ip_address TEXT, device_type TEXT, browser TEXT, duration INT, status_code INT);\nQuestion: 查询状态码不为200的日志，统计每个状态码的日志数量和平均操作时长。\nSQL:", "target": "SELECT status_code, COUNT(*) as count, AVG(duration) as avg_duration FROM user_interaction_logs WHERE status_code != 200 GROUP BY status_code ORDER BY count DESC;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.7818181818181819}, "extracted_prediction": "SELECT      status_code,     COUNT(*) AS log_count,     AVG(duration) AS avg_duration FROM user_interaction_logs WHERE status_code != 200 GROUP BY status_code", "prediction": "```sql\nSELECT \n    status_code,\n    COUNT(*) AS log_count,\n    AVG(duration) AS avg_duration\nFROM user_interaction_logs\nWHERE status_code != 200\nGROUP BY status_code;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 74, "group_id": 74, "sample_metadata": {}}}
{"index": 26, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE orders (order_id INT PRIMARY KEY, user_id INT, order_date DATE, total_amount DECIMAL(10,2), status TEXT, payment_method TEXT, shipping_address TEXT, discount DECIMAL(10,2), tax DECIMAL(10,2), created_at TIMESTAMP);\nQuestion: 统计每个支付方式的订单数量和总金额，按总金额降序排列。\nSQL:", "target": "SELECT payment_method, COUNT(*) as order_count, SUM(total_amount) as total_amount FROM orders GROUP BY payment_method ORDER BY total_amount DESC;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.9545454545454546}, "extracted_prediction": "SELECT      payment_method,     COUNT(order_id) AS order_count,     SUM(total_amount) AS total_amount FROM orders GROUP BY payment_method ORDER BY total_amount DESC", "prediction": "```sql\nSELECT \n    payment_method,\n    COUNT(order_id) AS order_count,\n    SUM(total_amount) AS total_amount\nFROM orders\nGROUP BY payment_method\nORDER BY total_amount DESC;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 26, "group_id": 26, "sample_metadata": {}}}
{"index": 20, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE users (user_id INT PRIMARY KEY, username TEXT, email TEXT, age INT, gender TEXT, registration_date DATE, last_login_date DATE, status TEXT, city TEXT, phone TEXT);\nQuestion: 计算每个城市用户的平均注册时长（以天为单位），显示城市和平均天数。\nSQL:", "target": "SELECT city, AVG(julianday('now') - julianday(registration_date)) as avg_days FROM users GROUP BY city;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.6346153846153846}, "extracted_prediction": "SELECT      city,     AVG(DATEDIFF(CURDATE(), registration_date)) AS avg_registration_duration_days FROM users WHERE city IS NOT NULL GROUP BY city", "prediction": "```sql\nSELECT \n    city,\n    AVG(DATEDIFF(CURDATE(), registration_date)) AS avg_registration_duration_days\nFROM users\nWHERE city IS NOT NULL\nGROUP BY city;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 20, "group_id": 20, "sample_metadata": {}}}
{"index": 23, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE users (user_id INT PRIMARY KEY, username TEXT, email TEXT, age INT, gender TEXT, registration_date DATE, last_login_date DATE, status TEXT, city TEXT, phone TEXT);\nQuestion: 找出注册时间最早的用户所在的城市，并查询该城市所有用户的平均年龄。\nSQL:", "target": "SELECT city, AVG(age) as avg_age FROM users WHERE city = (SELECT city FROM users ORDER BY registration_date ASC LIMIT 1) GROUP BY city;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.6477272727272727}, "extracted_prediction": "SELECT      city,     AVG(age) AS average_age FROM users WHERE city = (     SELECT city     FROM users     WHERE registration_date = (         SELECT MIN(registration_date)         FROM users     )     LIMIT 1 ) GROUP BY city", "prediction": "```sql\nSELECT \n    city,\n    AVG(age) AS average_age\nFROM users\nWHERE city = (\n    SELECT city\n    FROM users\n    WHERE registration_date = (\n        SELECT MIN(registration_date)\n        FROM users\n    )\n    LIMIT 1\n)\nGROUP BY city;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 23, "group_id": 23, "sample_metadata": {}}}
{"index": 39, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE orders (order_id INT PRIMARY KEY, user_id INT, order_date DATE, total_amount DECIMAL(10,2), status TEXT, payment_method TEXT, shipping_address TEXT, discount DECIMAL(10,2), tax DECIMAL(10,2), created_at TIMESTAMP);\nQuestion: 查询订单金额在1000到5000元之间，且创建时间在最近3个月内的订单，按订单金额升序排列。\nSQL:", "target": "SELECT * FROM orders WHERE total_amount BETWEEN 1000 AND 5000 AND created_at >= datetime('now', '-3 months') ORDER BY total_amount ASC;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.9}, "extracted_prediction": "SELECT * FROM orders WHERE total_amount BETWEEN 1000 AND 5000   AND created_at >= DATE_SUB(CURDATE(), INTERVAL 3 MONTH) ORDER BY total_amount ASC", "prediction": "```sql\nSELECT *\nFROM orders\nWHERE total_amount BETWEEN 1000 AND 5000\n  AND created_at >= DATE_SUB(CURDATE(), INTERVAL 3 MONTH)\nORDER BY total_amount ASC;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 39, "group_id": 39, "sample_metadata": {}}}
{"index": 56, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE research_docs (doc_id INT PRIMARY KEY, title TEXT, author TEXT, category TEXT, file_size INT, created_date DATE, updated_date DATE, version TEXT, status TEXT, tags TEXT, description TEXT);\nQuestion: 统计每个类别中不同状态的文档数量，使用透视表格式显示。\nSQL:", "target": "SELECT category, SUM(CASE WHEN status = 'draft' THEN 1 ELSE 0 END) as draft_count, SUM(CASE WHEN status = 'published' THEN 1 ELSE 0 END) as published_count, SUM(CASE WHEN status = 'archived' THEN 1 ELSE 0 END) as archived_count FROM research_docs GROUP BY category;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.6818181818181819}, "extracted_prediction": "SELECT      category,     COUNT(CASE WHEN status = 'draft' THEN 1 END) AS draft_count,     COUNT(CASE WHEN status = 'review' THEN 1 END) AS review_count,     COUNT(CASE WHEN status = 'published' THEN 1 END) AS published_count,     COUNT(CASE WHEN status = 'archived' THEN 1 END) AS archived_count,     COUNT(*) AS total_count FROM research_docs GROUP BY category ORDER BY category", "prediction": "```sql\nSELECT \n    category,\n    COUNT(CASE WHEN status = 'draft' THEN 1 END) AS draft_count,\n    COUNT(CASE WHEN status = 'review' THEN 1 END) AS review_count,\n    COUNT(CASE WHEN status = 'published' THEN 1 END) AS published_count,\n    COUNT(CASE WHEN status = 'archived' THEN 1 END) AS archived_count,\n    COUNT(*) AS total_count\nFROM research_docs\nGROUP BY category\nORDER BY category;\n```\n\n如果需要动态生成所有状态列的透视表（当状态值不固定时），可以使用以下方法：\n\n```sql\nSELECT \n    category,\n    COUNT(*) FILTER (WHERE status = 'draft') AS draft_count,\n    COUNT(*) FILTER (WHERE status = 'review') AS review_count,\n    COUNT(*) FILTER (WHERE status = 'published') AS published_count,\n    COUNT(*) FILTER (WHERE status = 'archived') AS archived_count,\n    -- 可以继续添加其他状态\n    COUNT(*) AS total_count\nFROM research_docs\nGROUP BY category\nORDER BY category;\n```\n\n**说明：**\n1. 使用 `CASE WHEN` 或 `FILTER` 子句为每个状态创建单独的计数列\n2. 按 `category` 分组，统计每个类别中不同状态的文档数量\n3. 包含总计列显示每个类别的文档总数\n4. 结果以透视表格式显示，类别为行，不同状态为列", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 56, "group_id": 56, "sample_metadata": {}}}
{"index": 21, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE users (user_id INT PRIMARY KEY, username TEXT, email TEXT, age INT, gender TEXT, registration_date DATE, last_login_date DATE, status TEXT, city TEXT, phone TEXT);\nQuestion: 查询状态为活跃且年龄在25-40岁之间的女性用户，按年龄升序排列，显示前20条。\nSQL:", "target": "SELECT * FROM users WHERE status = 'active' AND age BETWEEN 25 AND 40 AND gender = 'female' ORDER BY age ASC LIMIT 20;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.8}, "extracted_prediction": "SELECT user_id, username, email, age, gender, registration_date,         last_login_date, status, city, phone FROM users WHERE status = '活跃'   AND gender = '女性'   AND age BETWEEN 25 AND 40 ORDER BY age ASC LIMIT 20", "prediction": "```sql\nSELECT user_id, username, email, age, gender, registration_date, \n       last_login_date, status, city, phone\nFROM users\nWHERE status = '活跃'\n  AND gender = '女性'\n  AND age BETWEEN 25 AND 40\nORDER BY age ASC\nLIMIT 20;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 21, "group_id": 21, "sample_metadata": {}}}
{"index": 29, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE orders (order_id INT PRIMARY KEY, user_id INT, order_date DATE, total_amount DECIMAL(10,2), status TEXT, payment_method TEXT, shipping_address TEXT, discount DECIMAL(10,2), tax DECIMAL(10,2), created_at TIMESTAMP);\nQuestion: 查询状态为已完成且订单金额在平均值以上的订单数量，按用户ID分组统计。\nSQL:", "target": "SELECT user_id, COUNT(*) as count FROM orders WHERE status = 'completed' AND total_amount > (SELECT AVG(total_amount) FROM orders) GROUP BY user_id;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.655}, "extracted_prediction": "SELECT      user_id,     COUNT(*) AS order_count FROM orders WHERE status = '已完成'     AND total_amount > (         SELECT AVG(total_amount)          FROM orders          WHERE status = '已完成'     ) GROUP BY user_id ORDER BY user_id", "prediction": "```sql\nSELECT \n    user_id,\n    COUNT(*) AS order_count\nFROM orders\nWHERE status = '已完成'\n    AND total_amount > (\n        SELECT AVG(total_amount) \n        FROM orders \n        WHERE status = '已完成'\n    )\nGROUP BY user_id\nORDER BY user_id;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 29, "group_id": 29, "sample_metadata": {}}}
{"index": 11, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE users (user_id INT PRIMARY KEY, username TEXT, email TEXT, age INT, gender TEXT, registration_date DATE, last_login_date DATE, status TEXT, city TEXT, phone TEXT);\nQuestion: 找出注册时间在周末（周六或周日）的用户，显示用户名、注册日期和星期几。\nSQL:", "target": "SELECT username, registration_date, CASE CAST(strftime('%w', registration_date) AS INTEGER) WHEN 0 THEN 'Sunday' WHEN 6 THEN 'Saturday' END as day_of_week FROM users WHERE strftime('%w', registration_date) IN ('0', '6');", "sample_score": {"score": {"value": {"sql_ast_sim": 0.21428571428571427}, "extracted_prediction": "SELECT      username,     registration_date,     TO_CHAR(registration_date, 'Day') AS weekday FROM users WHERE EXTRACT(DOW FROM registration_date) IN (0, 6)", "prediction": "```sql\nSELECT \n    username,\n    registration_date,\n    TO_CHAR(registration_date, 'Day') AS weekday\nFROM users\nWHERE EXTRACT(DOW FROM registration_date) IN (0, 6);\n```\n\n**说明：**\n- `EXTRACT(DOW FROM registration_date)` 提取注册日期的星期几（0=周日，6=周六）。\n- `TO_CHAR(registration_date, 'Day')` 将日期转换为星期几的名称。\n- 如果使用的数据库系统不同，星期几的数值可能略有差异（例如某些系统中1=周日），请根据实际数据库调整数值。", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 11, "group_id": 11, "sample_metadata": {}}}
{"index": 38, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE orders (order_id INT PRIMARY KEY, user_id INT, order_date DATE, total_amount DECIMAL(10,2), status TEXT, payment_method TEXT, shipping_address TEXT, discount DECIMAL(10,2), tax DECIMAL(10,2), created_at TIMESTAMP);\nQuestion: 统计每个支付方式在不同状态下的订单数量，使用交叉表格式显示。\nSQL:", "target": "SELECT payment_method, SUM(CASE WHEN status = 'pending' THEN 1 ELSE 0 END) as pending_count, SUM(CASE WHEN status = 'completed' THEN 1 ELSE 0 END) as completed_count, SUM(CASE WHEN status = 'cancelled' THEN 1 ELSE 0 END) as cancelled_count FROM orders GROUP BY payment_method;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.6388888888888888}, "extracted_prediction": "SELECT      payment_method,     COUNT(CASE WHEN status = 'pending' THEN 1 END) AS pending_count,     COUNT(CASE WHEN status = 'processing' THEN 1 END) AS processing_count,     COUNT(CASE WHEN status = 'shipped' THEN 1 END) AS shipped_count,     COUNT(CASE WHEN status = 'delivered' THEN 1 END) AS delivered_count,     COUNT(CASE WHEN status = 'cancelled' THEN 1 END) AS cancelled_count,     COUNT(CASE WHEN status NOT IN ('pending', 'processing', 'shipped', 'delivered', 'cancelled') THEN 1 END) AS other_status_count,     COUNT(*) AS total_orders FROM orders GROUP BY payment_method ORDER BY payment_method", "prediction": "```sql\nSELECT \n    payment_method,\n    COUNT(CASE WHEN status = 'pending' THEN 1 END) AS pending_count,\n    COUNT(CASE WHEN status = 'processing' THEN 1 END) AS processing_count,\n    COUNT(CASE WHEN status = 'shipped' THEN 1 END) AS shipped_count,\n    COUNT(CASE WHEN status = 'delivered' THEN 1 END) AS delivered_count,\n    COUNT(CASE WHEN status = 'cancelled' THEN 1 END) AS cancelled_count,\n    COUNT(CASE WHEN status NOT IN ('pending', 'processing', 'shipped', 'delivered', 'cancelled') THEN 1 END) AS other_status_count,\n    COUNT(*) AS total_orders\nFROM orders\nGROUP BY payment_method\nORDER BY payment_method;\n```\n\n如果已知所有状态值，也可以使用更简洁的动态方式（但SQL标准不支持动态列）。上面的查询假设了常见的订单状态，你可以根据实际数据中的状态值调整 `CASE WHEN` 条件。", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 38, "group_id": 38, "sample_metadata": {}}}
{"index": 55, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE research_docs (doc_id INT PRIMARY KEY, title TEXT, author TEXT, category TEXT, file_size INT, created_date DATE, updated_date DATE, version TEXT, status TEXT, tags TEXT, description TEXT);\nQuestion: 找出更新日期距离创建日期超过1年的文档，显示文档ID、标题、创建日期和更新日期。\nSQL:", "target": "SELECT doc_id, title, created_date, updated_date FROM research_docs WHERE julianday(updated_date) - julianday(created_date) > 365;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.8484848484848485}, "extracted_prediction": "SELECT doc_id, title, created_date, updated_date FROM research_docs WHERE updated_date > DATE_ADD(created_date, INTERVAL 1 YEAR)", "prediction": "```sql\nSELECT doc_id, title, created_date, updated_date\nFROM research_docs\nWHERE updated_date > DATE_ADD(created_date, INTERVAL 1 YEAR);\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 55, "group_id": 55, "sample_metadata": {}}}
{"index": 0, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE users (user_id INT PRIMARY KEY, username TEXT, email TEXT, age INT, gender TEXT, registration_date DATE, last_login_date DATE, status TEXT, city TEXT, phone TEXT);\nQuestion: 查询所有注册时间在2023年1月1日之后且年龄在25到35岁之间的用户，按注册时间降序排列，只显示前10条。\nSQL:", "target": "SELECT * FROM users WHERE registration_date > '2023-01-01' AND age BETWEEN 25 AND 35 ORDER BY registration_date DESC LIMIT 10;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT * FROM users WHERE registration_date > '2023-01-01'   AND age BETWEEN 25 AND 35 ORDER BY registration_date DESC LIMIT 10", "prediction": "```sql\nSELECT *\nFROM users\nWHERE registration_date > '2023-01-01'\n  AND age BETWEEN 25 AND 35\nORDER BY registration_date DESC\nLIMIT 10;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 0, "group_id": 0, "sample_metadata": {}}}
{"index": 64, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE user_interaction_logs (log_id INT PRIMARY KEY, user_id INT, action_type TEXT, page_url TEXT, session_id TEXT, timestamp TIMESTAMP, ip_address TEXT, device_type TEXT, browser TEXT, duration INT, status_code INT);\nQuestion: 统计每个操作类型（action_type）的日志数量和平均操作时长，按日志数量降序排列。\nSQL:", "target": "SELECT action_type, COUNT(*) as log_count, AVG(duration) as avg_duration FROM user_interaction_logs GROUP BY action_type ORDER BY log_count DESC;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.9583333333333334}, "extracted_prediction": "SELECT      action_type,     COUNT(log_id) AS log_count,     AVG(duration) AS avg_duration FROM user_interaction_logs GROUP BY action_type ORDER BY log_count DESC", "prediction": "```sql\nSELECT \n    action_type,\n    COUNT(log_id) AS log_count,\n    AVG(duration) AS avg_duration\nFROM user_interaction_logs\nGROUP BY action_type\nORDER BY log_count DESC;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 64, "group_id": 64, "sample_metadata": {}}}
{"index": 8, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE users (user_id INT PRIMARY KEY, username TEXT, email TEXT, age INT, gender TEXT, registration_date DATE, last_login_date DATE, status TEXT, city TEXT, phone TEXT);\nQuestion: 找出注册超过1年但从未登录过的用户，显示用户ID、用户名和注册日期。\nSQL:", "target": "SELECT user_id, username, registration_date FROM users WHERE registration_date < DATE('now', '-1 year') AND (last_login_date IS NULL OR last_login_date = registration_date);", "sample_score": {"score": {"value": {"sql_ast_sim": 0.6195652173913043}, "extracted_prediction": "SELECT user_id, username, registration_date FROM users WHERE registration_date <= DATE_SUB(CURDATE(), INTERVAL 1 YEAR)   AND (last_login_date IS NULL OR last_login_date = '')   AND status != 'deleted' -- 可选：排除已删除账户 ORDER BY registration_date", "prediction": "```sql\nSELECT user_id, username, registration_date\nFROM users\nWHERE registration_date <= DATE_SUB(CURDATE(), INTERVAL 1 YEAR)\n  AND (last_login_date IS NULL OR last_login_date = '')\n  AND status != 'deleted' -- 可选：排除已删除账户\nORDER BY registration_date;\n```\n\n**说明：**\n1. `DATE_SUB(CURDATE(), INTERVAL 1 YEAR)` 计算一年前的日期，用于判断注册是否超过一年。\n2. `last_login_date IS NULL OR last_login_date = ''` 确保用户从未登录过（包括空值或空字符串）。\n3. 添加 `status != 'deleted'` 可排除已标记删除的账户（根据实际业务逻辑可选）。\n4. 结果按注册日期排序便于查看。", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 8, "group_id": 8, "sample_metadata": {}}}
{"index": 7, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE users (user_id INT PRIMARY KEY, username TEXT, email TEXT, age INT, gender TEXT, registration_date DATE, last_login_date DATE, status TEXT, city TEXT, phone TEXT);\nQuestion: 查询年龄在平均值以上的用户数量，按城市分组统计。\nSQL:", "target": "SELECT city, COUNT(*) as count FROM users WHERE age > (SELECT AVG(age) FROM users) GROUP BY city;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.78}, "extracted_prediction": "SELECT      city,     COUNT(*) AS user_count FROM users WHERE age > (SELECT AVG(age) FROM users) GROUP BY city ORDER BY user_count DESC", "prediction": "```sql\nSELECT \n    city,\n    COUNT(*) AS user_count\nFROM users\nWHERE age > (SELECT AVG(age) FROM users)\nGROUP BY city\nORDER BY user_count DESC;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 7, "group_id": 7, "sample_metadata": {}}}
{"index": 31, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE orders (order_id INT PRIMARY KEY, user_id INT, order_date DATE, total_amount DECIMAL(10,2), status TEXT, payment_method TEXT, shipping_address TEXT, discount DECIMAL(10,2), tax DECIMAL(10,2), created_at TIMESTAMP);\nQuestion: 查询最近30天内下单的订单，计算每个用户的订单总金额，只显示总金额超过5000元的用户。\nSQL:", "target": "SELECT user_id, SUM(total_amount) as total FROM orders WHERE order_date >= DATE('now', '-30 days') GROUP BY user_id HAVING SUM(total_amount) > 5000 ORDER BY total DESC;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.7546296296296297}, "extracted_prediction": "SELECT      user_id,     SUM(total_amount) AS total_order_amount FROM orders WHERE order_date >= DATE_SUB(CURDATE(), INTERVAL 30 DAY) GROUP BY user_id HAVING SUM(total_amount) > 5000 ORDER BY total_order_amount DESC", "prediction": "```sql\nSELECT \n    user_id,\n    SUM(total_amount) AS total_order_amount\nFROM orders\nWHERE order_date >= DATE_SUB(CURDATE(), INTERVAL 30 DAY)\nGROUP BY user_id\nHAVING SUM(total_amount) > 5000\nORDER BY total_order_amount DESC;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 31, "group_id": 31, "sample_metadata": {}}}
{"index": 18, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE users (user_id INT PRIMARY KEY, username TEXT, email TEXT, age INT, gender TEXT, registration_date DATE, last_login_date DATE, status TEXT, city TEXT, phone TEXT);\nQuestion: 查询用户名以字母开头且长度为6到10个字符的用户，显示用户名和邮箱。\nSQL:", "target": "SELECT username, email FROM users WHERE username GLOB '[a-zA-Z]*' AND LENGTH(username) BETWEEN 6 AND 10;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.9333333333333332}, "extracted_prediction": "SELECT username, email FROM users WHERE username REGEXP '^[A-Za-z]'   AND LENGTH(username) BETWEEN 6 AND 10", "prediction": "```sql\nSELECT username, email\nFROM users\nWHERE username REGEXP '^[A-Za-z]'\n  AND LENGTH(username) BETWEEN 6 AND 10;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 18, "group_id": 18, "sample_metadata": {}}}
{"index": 37, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE orders (order_id INT PRIMARY KEY, user_id INT, order_date DATE, total_amount DECIMAL(10,2), status TEXT, payment_method TEXT, shipping_address TEXT, discount DECIMAL(10,2), tax DECIMAL(10,2), created_at TIMESTAMP);\nQuestion: 查询配送地址包含'北京'的订单，统计每个状态的订单数量。\nSQL:", "target": "SELECT status, COUNT(*) as count FROM orders WHERE shipping_address LIKE '%北京%' GROUP BY status;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.96875}, "extracted_prediction": "SELECT      status,     COUNT(*) AS order_count FROM orders WHERE shipping_address LIKE '%北京%' GROUP BY status", "prediction": "```sql\nSELECT \n    status,\n    COUNT(*) AS order_count\nFROM orders\nWHERE shipping_address LIKE '%北京%'\nGROUP BY status;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 37, "group_id": 37, "sample_metadata": {}}}
{"index": 54, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE research_docs (doc_id INT PRIMARY KEY, title TEXT, author TEXT, category TEXT, file_size INT, created_date DATE, updated_date DATE, version TEXT, status TEXT, tags TEXT, description TEXT);\nQuestion: 查询标签中包含'机器学习'的文档，显示文档ID、标题、作者和创建日期，按创建日期降序排列，显示前30条。\nSQL:", "target": "SELECT doc_id, title, author, created_date FROM research_docs WHERE tags LIKE '%机器学习%' ORDER BY created_date DESC LIMIT 30;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT doc_id, title, author, created_date FROM research_docs WHERE tags LIKE '%机器学习%' ORDER BY created_date DESC LIMIT 30", "prediction": "```sql\nSELECT doc_id, title, author, created_date\nFROM research_docs\nWHERE tags LIKE '%机器学习%'\nORDER BY created_date DESC\nLIMIT 30;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 54, "group_id": 54, "sample_metadata": {}}}
{"index": 17, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE users (user_id INT PRIMARY KEY, username TEXT, email TEXT, age INT, gender TEXT, registration_date DATE, last_login_date DATE, status TEXT, city TEXT, phone TEXT);\nQuestion: 统计每个性别在不同城市的分布情况，显示性别、城市和用户数量，按性别和用户数量降序排列。\nSQL:", "target": "SELECT gender, city, COUNT(*) as count FROM users GROUP BY gender, city ORDER BY gender, count DESC;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.6599999999999999}, "extracted_prediction": "SELECT      gender,     city,     COUNT(user_id) AS user_count FROM users WHERE gender IS NOT NULL      AND city IS NOT NULL GROUP BY gender, city ORDER BY gender, user_count DESC", "prediction": "```sql\nSELECT \n    gender,\n    city,\n    COUNT(user_id) AS user_count\nFROM users\nWHERE gender IS NOT NULL \n    AND city IS NOT NULL\nGROUP BY gender, city\nORDER BY gender, user_count DESC;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 17, "group_id": 17, "sample_metadata": {}}}
{"index": 6, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE users (user_id INT PRIMARY KEY, username TEXT, email TEXT, age INT, gender TEXT, registration_date DATE, last_login_date DATE, status TEXT, city TEXT, phone TEXT);\nQuestion: 找出用户名长度大于8且包含数字的用户，显示用户名和注册日期。\nSQL:", "target": "SELECT username, registration_date FROM users WHERE LENGTH(username) > 8 AND username GLOB '*[0-9]*';", "sample_score": {"score": {"value": {"sql_ast_sim": 0.9333333333333332}, "extracted_prediction": "SELECT username, registration_date FROM users WHERE LENGTH(username) > 8    AND username REGEXP '[0-9]'", "prediction": "```sql\nSELECT username, registration_date\nFROM users\nWHERE LENGTH(username) > 8 \n  AND username REGEXP '[0-9]';\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 6, "group_id": 6, "sample_metadata": {}}}
{"index": 70, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE user_interaction_logs (log_id INT PRIMARY KEY, user_id INT, action_type TEXT, page_url TEXT, session_id TEXT, timestamp TIMESTAMP, ip_address TEXT, device_type TEXT, browser TEXT, duration INT, status_code INT);\nQuestion: 查询页面URL包含'product'的日志，统计每个操作类型的日志数量。\nSQL:", "target": "SELECT action_type, COUNT(*) as count FROM user_interaction_logs WHERE page_url LIKE '%product%' GROUP BY action_type;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.96875}, "extracted_prediction": "SELECT      action_type,     COUNT(*) AS log_count FROM user_interaction_logs WHERE page_url LIKE '%product%' GROUP BY action_type", "prediction": "```sql\nSELECT \n    action_type,\n    COUNT(*) AS log_count\nFROM user_interaction_logs\nWHERE page_url LIKE '%product%'\nGROUP BY action_type;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 70, "group_id": 70, "sample_metadata": {}}}
{"index": 14, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE users (user_id INT PRIMARY KEY, username TEXT, email TEXT, age INT, gender TEXT, registration_date DATE, last_login_date DATE, status TEXT, city TEXT, phone TEXT);\nQuestion: 查询邮箱地址中包含公司域名（包含'company'或'corp'）的用户，按注册时间升序排列。\nSQL:", "target": "SELECT * FROM users WHERE email LIKE '%company%' OR email LIKE '%corp%' ORDER BY registration_date ASC;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT * FROM users WHERE email LIKE '%company%' OR email LIKE '%corp%' ORDER BY registration_date ASC", "prediction": "```sql\nSELECT *\nFROM users\nWHERE email LIKE '%company%' OR email LIKE '%corp%'\nORDER BY registration_date ASC;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 14, "group_id": 14, "sample_metadata": {}}}
{"index": 5, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE users (user_id INT PRIMARY KEY, username TEXT, email TEXT, age INT, gender TEXT, registration_date DATE, last_login_date DATE, status TEXT, city TEXT, phone TEXT);\nQuestion: 查询2023年每个季度注册的用户数量，按季度排序。\nSQL:", "target": "SELECT CASE WHEN strftime('%m', registration_date) IN ('01','02','03') THEN 'Q1' WHEN strftime('%m', registration_date) IN ('04','05','06') THEN 'Q2' WHEN strftime('%m', registration_date) IN ('07','08','09') THEN 'Q3' ELSE 'Q4' END as quarter, COUNT(*) as count FROM users WHERE strftime('%Y', registration_date) = '2023' GROUP BY quarter ORDER BY quarter;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.32908496732026143}, "extracted_prediction": "SELECT      EXTRACT(QUARTER FROM registration_date) AS quarter,     COUNT(*) AS user_count FROM users WHERE EXTRACT(YEAR FROM registration_date) = 2023 GROUP BY EXTRACT(QUARTER FROM registration_date) ORDER BY quarter", "prediction": "```sql\nSELECT \n    EXTRACT(QUARTER FROM registration_date) AS quarter,\n    COUNT(*) AS user_count\nFROM users\nWHERE EXTRACT(YEAR FROM registration_date) = 2023\nGROUP BY EXTRACT(QUARTER FROM registration_date)\nORDER BY quarter;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 5, "group_id": 5, "sample_metadata": {}}}
{"index": 33, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE orders (order_id INT PRIMARY KEY, user_id INT, order_date DATE, total_amount DECIMAL(10,2), status TEXT, payment_method TEXT, shipping_address TEXT, discount DECIMAL(10,2), tax DECIMAL(10,2), created_at TIMESTAMP);\nQuestion: 查询使用信用卡支付且订单金额大于1000元的订单，按下单时间降序排列，显示前50条。\nSQL:", "target": "SELECT * FROM orders WHERE payment_method = 'credit_card' AND total_amount > 1000 ORDER BY order_date DESC LIMIT 50;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.8666666666666666}, "extracted_prediction": "SELECT * FROM orders WHERE payment_method = '信用卡'   AND total_amount > 1000 ORDER BY created_at DESC LIMIT 50", "prediction": "```sql\nSELECT *\nFROM orders\nWHERE payment_method = '信用卡'\n  AND total_amount > 1000\nORDER BY created_at DESC\nLIMIT 50;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 33, "group_id": 33, "sample_metadata": {}}}
{"index": 53, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE research_docs (doc_id INT PRIMARY KEY, title TEXT, author TEXT, category TEXT, file_size INT, created_date DATE, updated_date DATE, version TEXT, status TEXT, tags TEXT, description TEXT);\nQuestion: 统计2023年每个月创建的文档数量，只显示创建数量超过20的月份，按月份排序。\nSQL:", "target": "SELECT strftime('%Y-%m', created_date) as month, COUNT(*) as count FROM research_docs WHERE strftime('%Y', created_date) = '2023' GROUP BY month HAVING COUNT(*) > 20 ORDER BY month;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.4515993265993266}, "extracted_prediction": "SELECT      EXTRACT(MONTH FROM created_date) AS month,     COUNT(*) AS document_count FROM research_docs WHERE EXTRACT(YEAR FROM created_date) = 2023 GROUP BY EXTRACT(MONTH FROM created_date) HAVING COUNT(*) > 20 ORDER BY month", "prediction": "```sql\nSELECT \n    EXTRACT(MONTH FROM created_date) AS month,\n    COUNT(*) AS document_count\nFROM research_docs\nWHERE EXTRACT(YEAR FROM created_date) = 2023\nGROUP BY EXTRACT(MONTH FROM created_date)\nHAVING COUNT(*) > 20\nORDER BY month;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 53, "group_id": 53, "sample_metadata": {}}}
{"index": 66, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE user_interaction_logs (log_id INT PRIMARY KEY, user_id INT, action_type TEXT, page_url TEXT, session_id TEXT, timestamp TIMESTAMP, ip_address TEXT, device_type TEXT, browser TEXT, duration INT, status_code INT);\nQuestion: 找出每个会话（session_id）中的操作次数和总时长，只显示操作次数大于10的会话，按总时长降序排列。\nSQL:", "target": "SELECT session_id, COUNT(*) as action_count, SUM(duration) as total_duration FROM user_interaction_logs GROUP BY session_id HAVING COUNT(*) > 10 ORDER BY total_duration DESC;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.8813186813186814}, "extracted_prediction": "SELECT      session_id,     COUNT(log_id) AS operation_count,     SUM(duration) AS total_duration FROM user_interaction_logs GROUP BY session_id HAVING COUNT(log_id) > 10 ORDER BY total_duration DESC", "prediction": "```sql\nSELECT \n    session_id,\n    COUNT(log_id) AS operation_count,\n    SUM(duration) AS total_duration\nFROM user_interaction_logs\nGROUP BY session_id\nHAVING COUNT(log_id) > 10\nORDER BY total_duration DESC;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 66, "group_id": 66, "sample_metadata": {}}}
{"index": 34, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE orders (order_id INT PRIMARY KEY, user_id INT, order_date DATE, total_amount DECIMAL(10,2), status TEXT, payment_method TEXT, shipping_address TEXT, discount DECIMAL(10,2), tax DECIMAL(10,2), created_at TIMESTAMP);\nQuestion: 统计2023年每个季度的订单总金额和平均订单金额，按季度排序。\nSQL:", "target": "SELECT CASE WHEN strftime('%m', order_date) IN ('01','02','03') THEN 'Q1' WHEN strftime('%m', order_date) IN ('04','05','06') THEN 'Q2' WHEN strftime('%m', order_date) IN ('07','08','09') THEN 'Q3' ELSE 'Q4' END as quarter, SUM(total_amount) as total, AVG(total_amount) as avg_amount FROM orders WHERE strftime('%Y', order_date) = '2023' GROUP BY quarter ORDER BY quarter;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.32317460317460317}, "extracted_prediction": "SELECT      EXTRACT(QUARTER FROM order_date) AS quarter,     SUM(total_amount) AS total_order_amount,     AVG(total_amount) AS avg_order_amount FROM orders WHERE EXTRACT(YEAR FROM order_date) = 2023 GROUP BY EXTRACT(QUARTER FROM order_date) ORDER BY quarter", "prediction": "```sql\nSELECT \n    EXTRACT(QUARTER FROM order_date) AS quarter,\n    SUM(total_amount) AS total_order_amount,\n    AVG(total_amount) AS avg_order_amount\nFROM orders\nWHERE EXTRACT(YEAR FROM order_date) = 2023\nGROUP BY EXTRACT(QUARTER FROM order_date)\nORDER BY quarter;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 34, "group_id": 34, "sample_metadata": {}}}
{"index": 65, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE user_interaction_logs (log_id INT PRIMARY KEY, user_id INT, action_type TEXT, page_url TEXT, session_id TEXT, timestamp TIMESTAMP, ip_address TEXT, device_type TEXT, browser TEXT, duration INT, status_code INT);\nQuestion: 查询状态码为200且操作时长超过5秒的日志，显示日志ID、用户ID、操作类型和时长，按时长降序排列，显示前100条。\nSQL:", "target": "SELECT log_id, user_id, action_type, duration FROM user_interaction_logs WHERE status_code = 200 AND duration > 5 ORDER BY duration DESC LIMIT 100;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT log_id, user_id, action_type, duration FROM user_interaction_logs WHERE status_code = 200   AND duration > 5 ORDER BY duration DESC LIMIT 100", "prediction": "```sql\nSELECT log_id, user_id, action_type, duration\nFROM user_interaction_logs\nWHERE status_code = 200\n  AND duration > 5\nORDER BY duration DESC\nLIMIT 100;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 65, "group_id": 65, "sample_metadata": {}}}
{"index": 72, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE user_interaction_logs (log_id INT PRIMARY KEY, user_id INT, action_type TEXT, page_url TEXT, session_id TEXT, timestamp TIMESTAMP, ip_address TEXT, device_type TEXT, browser TEXT, duration INT, status_code INT);\nQuestion: 查询IP地址以192.168开头的日志，找出每个用户的操作次数，按操作次数降序排列，显示前50个用户。\nSQL:", "target": "SELECT user_id, COUNT(*) as action_count FROM user_interaction_logs WHERE ip_address LIKE '192.168%' GROUP BY user_id ORDER BY action_count DESC LIMIT 50;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.8518518518518517}, "extracted_prediction": "SELECT      user_id,     COUNT(*) AS operation_count FROM user_interaction_logs WHERE ip_address LIKE '192.168%' GROUP BY user_id ORDER BY operation_count DESC LIMIT 50", "prediction": "```sql\nSELECT \n    user_id,\n    COUNT(*) AS operation_count\nFROM user_interaction_logs\nWHERE ip_address LIKE '192.168%'\nGROUP BY user_id\nORDER BY operation_count DESC\nLIMIT 50;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 72, "group_id": 72, "sample_metadata": {}}}
{"index": 35, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE orders (order_id INT PRIMARY KEY, user_id INT, order_date DATE, total_amount DECIMAL(10,2), status TEXT, payment_method TEXT, shipping_address TEXT, discount DECIMAL(10,2), tax DECIMAL(10,2), created_at TIMESTAMP);\nQuestion: 查询折扣率（折扣金额/总金额）大于0.2的订单，显示订单号、总金额、折扣金额和折扣率，按折扣率降序排列。\nSQL:", "target": "SELECT order_id, total_amount, discount, ROUND(discount * 100.0 / total_amount, 2) as discount_rate FROM orders WHERE discount * 1.0 / total_amount > 0.2 ORDER BY discount_rate DESC;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.8363636363636364}, "extracted_prediction": "SELECT      order_id,     total_amount,     discount,     discount / total_amount AS discount_rate FROM orders WHERE discount / total_amount > 0.2 ORDER BY discount_rate DESC", "prediction": "```sql\nSELECT \n    order_id,\n    total_amount,\n    discount,\n    discount / total_amount AS discount_rate\nFROM orders\nWHERE discount / total_amount > 0.2\nORDER BY discount_rate DESC;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 35, "group_id": 35, "sample_metadata": {}}}
{"index": 63, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE user_interaction_logs (log_id INT PRIMARY KEY, user_id INT, action_type TEXT, page_url TEXT, session_id TEXT, timestamp TIMESTAMP, ip_address TEXT, device_type TEXT, browser TEXT, duration INT, status_code INT);\nQuestion: 查询最近7天内访问的用户交互日志，统计每个用户的操作次数，只显示操作次数超过50的用户，按操作次数降序排列。\nSQL:", "target": "SELECT user_id, COUNT(*) as action_count FROM user_interaction_logs WHERE timestamp >= datetime('now', '-7 days') GROUP BY user_id HAVING COUNT(*) > 50 ORDER BY action_count DESC;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.7407407407407408}, "extracted_prediction": "SELECT      user_id,     COUNT(*) AS operation_count FROM user_interaction_logs WHERE timestamp >= CURRENT_DATE - INTERVAL '7 days' GROUP BY user_id HAVING COUNT(*) > 50 ORDER BY operation_count DESC", "prediction": "```sql\nSELECT \n    user_id,\n    COUNT(*) AS operation_count\nFROM user_interaction_logs\nWHERE timestamp >= CURRENT_DATE - INTERVAL '7 days'\nGROUP BY user_id\nHAVING COUNT(*) > 50\nORDER BY operation_count DESC;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 63, "group_id": 63, "sample_metadata": {}}}
{"index": 3, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE users (user_id INT PRIMARY KEY, username TEXT, email TEXT, age INT, gender TEXT, registration_date DATE, last_login_date DATE, status TEXT, city TEXT, phone TEXT);\nQuestion: 找出邮箱域名是gmail.com的用户中，注册时间最早的前5名用户。\nSQL:", "target": "SELECT * FROM users WHERE email LIKE '%@gmail.com' ORDER BY registration_date ASC LIMIT 5;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.8}, "extracted_prediction": "SELECT user_id, username, email, age, gender, registration_date, last_login_date, status, city, phone FROM users WHERE email LIKE '%@gmail.com' ORDER BY registration_date ASC LIMIT 5", "prediction": "```sql\nSELECT user_id, username, email, age, gender, registration_date, last_login_date, status, city, phone\nFROM users\nWHERE email LIKE '%@gmail.com'\nORDER BY registration_date ASC\nLIMIT 5;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 3, "group_id": 3, "sample_metadata": {}}}
{"index": 24, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE users (user_id INT PRIMARY KEY, username TEXT, email TEXT, age INT, gender TEXT, registration_date DATE, last_login_date DATE, status TEXT, city TEXT, phone TEXT);\nQuestion: 查询2023年下半年（7-12月）注册的用户中，按月份统计注册人数，只显示注册人数最多的前3个月。\nSQL:", "target": "SELECT strftime('%Y-%m', registration_date) as month, COUNT(*) as count FROM users WHERE strftime('%Y', registration_date) = '2023' AND CAST(strftime('%m', registration_date) AS INTEGER) BETWEEN 7 AND 12 GROUP BY month ORDER BY count DESC LIMIT 3;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.33030303030303027}, "extracted_prediction": "SELECT      EXTRACT(MONTH FROM registration_date) AS month,     COUNT(*) AS registration_count FROM users WHERE EXTRACT(YEAR FROM registration_date) = 2023     AND EXTRACT(MONTH FROM registration_date) BETWEEN 7 AND 12 GROUP BY EXTRACT(MONTH FROM registration_date) ORDER BY registration_count DESC LIMIT 3", "prediction": "```sql\nSELECT \n    EXTRACT(MONTH FROM registration_date) AS month,\n    COUNT(*) AS registration_count\nFROM users\nWHERE EXTRACT(YEAR FROM registration_date) = 2023\n    AND EXTRACT(MONTH FROM registration_date) BETWEEN 7 AND 12\nGROUP BY EXTRACT(MONTH FROM registration_date)\nORDER BY registration_count DESC\nLIMIT 3;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 24, "group_id": 24, "sample_metadata": {}}}
{"index": 52, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE research_docs (doc_id INT PRIMARY KEY, title TEXT, author TEXT, category TEXT, file_size INT, created_date DATE, updated_date DATE, version TEXT, status TEXT, tags TEXT, description TEXT);\nQuestion: 查询版本号为v2.0及以上的文档，统计每个类别的文档数量。\nSQL:", "target": "SELECT category, COUNT(*) as count FROM research_docs WHERE CAST(SUBSTR(version, 2) AS REAL) >= 2.0 GROUP BY category;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.7642045454545454}, "extracted_prediction": "SELECT      category,     COUNT(*) AS document_count FROM research_docs WHERE version >= 'v2.0' GROUP BY category", "prediction": "```sql\nSELECT \n    category,\n    COUNT(*) AS document_count\nFROM research_docs\nWHERE version >= 'v2.0'\nGROUP BY category;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 52, "group_id": 52, "sample_metadata": {}}}
{"index": 4, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE users (user_id INT PRIMARY KEY, username TEXT, email TEXT, age INT, gender TEXT, registration_date DATE, last_login_date DATE, status TEXT, city TEXT, phone TEXT);\nQuestion: 计算每个性别用户的平均年龄，并显示平均年龄大于30的性别分组。\nSQL:", "target": "SELECT gender, AVG(age) as avg_age FROM users GROUP BY gender HAVING AVG(age) > 30;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.9444444444444444}, "extracted_prediction": "SELECT      gender,     AVG(age) AS average_age FROM users GROUP BY gender HAVING AVG(age) > 30", "prediction": "```sql\nSELECT \n    gender,\n    AVG(age) AS average_age\nFROM users\nGROUP BY gender\nHAVING AVG(age) > 30;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 4, "group_id": 4, "sample_metadata": {}}}
{"index": 36, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE orders (order_id INT PRIMARY KEY, user_id INT, order_date DATE, total_amount DECIMAL(10,2), status TEXT, payment_method TEXT, shipping_address TEXT, discount DECIMAL(10,2), tax DECIMAL(10,2), created_at TIMESTAMP);\nQuestion: 找出每个用户订单金额最大的订单，显示用户ID、订单号和订单金额。\nSQL:", "target": "SELECT user_id, order_id, total_amount FROM orders o1 WHERE total_amount = (SELECT MAX(total_amount) FROM orders o2 WHERE o2.user_id = o1.user_id);", "sample_score": {"score": {"value": {"sql_ast_sim": 0.203030303030303}, "extracted_prediction": "SELECT      user_id,     order_id,     total_amount FROM (     SELECT          user_id,         order_id,         total_amount,         ROW_NUMBER() OVER (PARTITION BY user_id ORDER BY total_amount DESC) AS rn     FROM orders ) ranked_orders WHERE rn = 1", "prediction": "```sql\nSELECT \n    user_id,\n    order_id,\n    total_amount\nFROM (\n    SELECT \n        user_id,\n        order_id,\n        total_amount,\n        ROW_NUMBER() OVER (PARTITION BY user_id ORDER BY total_amount DESC) AS rn\n    FROM orders\n) ranked_orders\nWHERE rn = 1;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 36, "group_id": 36, "sample_metadata": {}}}
{"index": 61, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE research_docs (doc_id INT PRIMARY KEY, title TEXT, author TEXT, category TEXT, file_size INT, created_date DATE, updated_date DATE, version TEXT, status TEXT, tags TEXT, description TEXT);\nQuestion: 查询创建时间在周末的文档，统计每个类别的文档数量。\nSQL:", "target": "SELECT category, COUNT(*) as count FROM research_docs WHERE strftime('%w', created_date) IN ('0', '6') GROUP BY category;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.4257936507936508}, "extracted_prediction": "SELECT      category,     COUNT(*) AS document_count FROM research_docs WHERE EXTRACT(DOW FROM created_date) IN (0, 6) GROUP BY category ORDER BY document_count DESC", "prediction": "```sql\nSELECT \n    category,\n    COUNT(*) AS document_count\nFROM research_docs\nWHERE EXTRACT(DOW FROM created_date) IN (0, 6)\nGROUP BY category\nORDER BY document_count DESC;\n```\n\n**说明：**\n- `EXTRACT(DOW FROM created_date)` 提取创建日期的星期几（0=周日，6=周六）\n- `WHERE` 子句筛选出创建时间在周末（周六或周日）的文档\n- `GROUP BY category` 按类别分组统计\n- 结果按文档数量降序排列，便于查看数量最多的类别", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 61, "group_id": 61, "sample_metadata": {}}}
{"index": 78, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE user_interaction_logs (log_id INT PRIMARY KEY, user_id INT, action_type TEXT, page_url TEXT, session_id TEXT, timestamp TIMESTAMP, ip_address TEXT, device_type TEXT, browser TEXT, duration INT, status_code INT);\nQuestion: 查询最近24小时内的日志，统计每个小时的日志数量，按小时排序。\nSQL:", "target": "SELECT strftime('%Y-%m-%d %H:00:00', timestamp) as hour, COUNT(*) as count FROM user_interaction_logs WHERE timestamp >= datetime('now', '-24 hours') GROUP BY hour ORDER BY hour;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.6611111111111111}, "extracted_prediction": "SELECT      DATE_TRUNC('hour', timestamp) AS hour,     COUNT(*) AS log_count FROM user_interaction_logs WHERE timestamp >= NOW() - INTERVAL '24 hours' GROUP BY DATE_TRUNC('hour', timestamp) ORDER BY hour", "prediction": "```sql\nSELECT \n    DATE_TRUNC('hour', timestamp) AS hour,\n    COUNT(*) AS log_count\nFROM user_interaction_logs\nWHERE timestamp >= NOW() - INTERVAL '24 hours'\nGROUP BY DATE_TRUNC('hour', timestamp)\nORDER BY hour;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 78, "group_id": 78, "sample_metadata": {}}}
{"index": 60, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE research_docs (doc_id INT PRIMARY KEY, title TEXT, author TEXT, category TEXT, file_size INT, created_date DATE, updated_date DATE, version TEXT, status TEXT, tags TEXT, description TEXT);\nQuestion: 统计每个类别中文件大小最大的文档，显示类别、文档ID、标题和大小。\nSQL:", "target": "SELECT category, doc_id, title, file_size FROM research_docs r1 WHERE file_size = (SELECT MAX(file_size) FROM research_docs r2 WHERE r2.category = r1.category);", "sample_score": {"score": {"value": {"sql_ast_sim": 0.75}, "extracted_prediction": "SELECT      category,     doc_id,     title,     file_size FROM research_docs r1 WHERE file_size = (     SELECT MAX(file_size)     FROM research_docs r2     WHERE r1.category = r2.category ) ORDER BY category", "prediction": "```sql\nSELECT \n    category,\n    doc_id,\n    title,\n    file_size\nFROM research_docs r1\nWHERE file_size = (\n    SELECT MAX(file_size)\n    FROM research_docs r2\n    WHERE r1.category = r2.category\n)\nORDER BY category;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 60, "group_id": 60, "sample_metadata": {}}}
{"index": 10, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE users (user_id INT PRIMARY KEY, username TEXT, email TEXT, age INT, gender TEXT, registration_date DATE, last_login_date DATE, status TEXT, city TEXT, phone TEXT);\nQuestion: 查询手机号以138开头的用户中，年龄最大的前3名用户信息。\nSQL:", "target": "SELECT * FROM users WHERE phone LIKE '138%' ORDER BY age DESC LIMIT 3;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT * FROM users WHERE phone LIKE '138%' ORDER BY age DESC LIMIT 3", "prediction": "```sql\nSELECT *\nFROM users\nWHERE phone LIKE '138%'\nORDER BY age DESC\nLIMIT 3;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 10, "group_id": 10, "sample_metadata": {}}}
{"index": 51, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE research_docs (doc_id INT PRIMARY KEY, title TEXT, author TEXT, category TEXT, file_size INT, created_date DATE, updated_date DATE, version TEXT, status TEXT, tags TEXT, description TEXT);\nQuestion: 找出每个作者创建的文档中，文件大小最大的文档，显示作者、文档ID、标题和大小。\nSQL:", "target": "SELECT author, doc_id, title, file_size FROM research_docs r1 WHERE file_size = (SELECT MAX(file_size) FROM research_docs r2 WHERE r2.author = r1.author);", "sample_score": {"score": {"value": {"sql_ast_sim": 0.75}, "extracted_prediction": "SELECT      author,     doc_id,     title,     file_size FROM research_docs r1 WHERE file_size = (     SELECT MAX(file_size)     FROM research_docs r2     WHERE r2.author = r1.author ) ORDER BY author", "prediction": "```sql\nSELECT \n    author,\n    doc_id,\n    title,\n    file_size\nFROM research_docs r1\nWHERE file_size = (\n    SELECT MAX(file_size)\n    FROM research_docs r2\n    WHERE r2.author = r1.author\n)\nORDER BY author;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 51, "group_id": 51, "sample_metadata": {}}}
{"index": 28, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE orders (order_id INT PRIMARY KEY, user_id INT, order_date DATE, total_amount DECIMAL(10,2), status TEXT, payment_method TEXT, shipping_address TEXT, discount DECIMAL(10,2), tax DECIMAL(10,2), created_at TIMESTAMP);\nQuestion: 找出折扣金额最高的前10个订单，显示订单号、总金额、折扣金额和实际支付金额。\nSQL:", "target": "SELECT order_id, total_amount, discount, (total_amount - discount + tax) as final_amount FROM orders ORDER BY discount DESC LIMIT 10;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.875}, "extracted_prediction": "SELECT      order_id,     total_amount,     discount,     total_amount - discount AS actual_payment FROM orders ORDER BY discount DESC LIMIT 10", "prediction": "```sql\nSELECT \n    order_id,\n    total_amount,\n    discount,\n    total_amount - discount AS actual_payment\nFROM orders\nORDER BY discount DESC\nLIMIT 10;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 28, "group_id": 28, "sample_metadata": {}}}
{"index": 2, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE users (user_id INT PRIMARY KEY, username TEXT, email TEXT, age INT, gender TEXT, registration_date DATE, last_login_date DATE, status TEXT, city TEXT, phone TEXT);\nQuestion: 查询最近30天内登录过且状态为活跃的用户，显示用户名、邮箱和最后登录时间。\nSQL:", "target": "SELECT username, email, last_login_date FROM users WHERE status = 'active' AND last_login_date >= DATE('now', '-30 days');", "sample_score": {"score": {"value": {"sql_ast_sim": 0.8666666666666667}, "extracted_prediction": "SELECT username, email, last_login_date FROM users WHERE status = '活跃'   AND last_login_date >= DATE_SUB(CURDATE(), INTERVAL 30 DAY)", "prediction": "```sql\nSELECT username, email, last_login_date\nFROM users\nWHERE status = '活跃'\n  AND last_login_date >= DATE_SUB(CURDATE(), INTERVAL 30 DAY);\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 2, "group_id": 2, "sample_metadata": {}}}
{"index": 50, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE research_docs (doc_id INT PRIMARY KEY, title TEXT, author TEXT, category TEXT, file_size INT, created_date DATE, updated_date DATE, version TEXT, status TEXT, tags TEXT, description TEXT);\nQuestion: 查询文件大小在平均值以上的文档，按类别分组统计数量，只显示数量大于5的类别。\nSQL:", "target": "SELECT category, COUNT(*) as count FROM research_docs WHERE file_size > (SELECT AVG(file_size) FROM research_docs) GROUP BY category HAVING COUNT(*) > 5;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.8166666666666668}, "extracted_prediction": "SELECT      category,     COUNT(*) AS doc_count FROM research_docs WHERE file_size > (     SELECT AVG(file_size)      FROM research_docs ) GROUP BY category HAVING COUNT(*) > 5 ORDER BY doc_count DESC", "prediction": "```sql\nSELECT \n    category,\n    COUNT(*) AS doc_count\nFROM research_docs\nWHERE file_size > (\n    SELECT AVG(file_size) \n    FROM research_docs\n)\nGROUP BY category\nHAVING COUNT(*) > 5\nORDER BY doc_count DESC;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 50, "group_id": 50, "sample_metadata": {}}}
{"index": 30, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE orders (order_id INT PRIMARY KEY, user_id INT, order_date DATE, total_amount DECIMAL(10,2), status TEXT, payment_method TEXT, shipping_address TEXT, discount DECIMAL(10,2), tax DECIMAL(10,2), created_at TIMESTAMP);\nQuestion: 统计每个状态的订单数量和平均订单金额，按订单数量降序排列。\nSQL:", "target": "SELECT status, COUNT(*) as count, AVG(total_amount) as avg_amount FROM orders GROUP BY status ORDER BY count DESC;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.7371794871794872}, "extracted_prediction": "SELECT      status,     COUNT(order_id) AS order_count,     AVG(total_amount) AS avg_order_amount FROM orders GROUP BY status ORDER BY order_count DESC", "prediction": "```sql\nSELECT \n    status,\n    COUNT(order_id) AS order_count,\n    AVG(total_amount) AS avg_order_amount\nFROM orders\nGROUP BY status\nORDER BY order_count DESC;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 30, "group_id": 30, "sample_metadata": {}}}
{"index": 22, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE users (user_id INT PRIMARY KEY, username TEXT, email TEXT, age INT, gender TEXT, registration_date DATE, last_login_date DATE, status TEXT, city TEXT, phone TEXT);\nQuestion: 统计每个城市中不同性别的用户数量，使用透视表格式显示。\nSQL:", "target": "SELECT city, SUM(CASE WHEN gender = 'male' THEN 1 ELSE 0 END) as male_count, SUM(CASE WHEN gender = 'female' THEN 1 ELSE 0 END) as female_count, SUM(CASE WHEN gender NOT IN ('male', 'female') OR gender IS NULL THEN 1 ELSE 0 END) as other_count FROM users GROUP BY city;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.7019230769230769}, "extracted_prediction": "SELECT      city,     COUNT(CASE WHEN gender = 'Male' THEN 1 END) AS male_count,     COUNT(CASE WHEN gender = 'Female' THEN 1 END) AS female_count,     COUNT(CASE WHEN gender NOT IN ('Male', 'Female') OR gender IS NULL THEN 1 END) AS other_count,     COUNT(*) AS total_count FROM users GROUP BY city ORDER BY city", "prediction": "```sql\nSELECT \n    city,\n    COUNT(CASE WHEN gender = 'Male' THEN 1 END) AS male_count,\n    COUNT(CASE WHEN gender = 'Female' THEN 1 END) AS female_count,\n    COUNT(CASE WHEN gender NOT IN ('Male', 'Female') OR gender IS NULL THEN 1 END) AS other_count,\n    COUNT(*) AS total_count\nFROM users\nGROUP BY city\nORDER BY city;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 22, "group_id": 22, "sample_metadata": {}}}
{"index": 49, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE research_docs (doc_id INT PRIMARY KEY, title TEXT, author TEXT, category TEXT, file_size INT, created_date DATE, updated_date DATE, version TEXT, status TEXT, tags TEXT, description TEXT);\nQuestion: 统计每个状态的文档数量和总文件大小，按总文件大小降序排列。\nSQL:", "target": "SELECT status, COUNT(*) as count, SUM(file_size) as total_size FROM research_docs GROUP BY status ORDER BY total_size DESC;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.7371794871794872}, "extracted_prediction": "SELECT      status,     COUNT(doc_id) AS document_count,     SUM(file_size) AS total_file_size FROM research_docs GROUP BY status ORDER BY total_file_size DESC", "prediction": "```sql\nSELECT \n    status,\n    COUNT(doc_id) AS document_count,\n    SUM(file_size) AS total_file_size\nFROM research_docs\nGROUP BY status\nORDER BY total_file_size DESC;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 49, "group_id": 49, "sample_metadata": {}}}
{"index": 27, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE orders (order_id INT PRIMARY KEY, user_id INT, order_date DATE, total_amount DECIMAL(10,2), status TEXT, payment_method TEXT, shipping_address TEXT, discount DECIMAL(10,2), tax DECIMAL(10,2), created_at TIMESTAMP);\nQuestion: 查询2023年每个月的订单总金额，只显示总金额超过50000元的月份。\nSQL:", "target": "SELECT strftime('%Y-%m', order_date) as month, SUM(total_amount) as total FROM orders WHERE strftime('%Y', order_date) = '2023' GROUP BY month HAVING SUM(total_amount) > 50000 ORDER BY month;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.4503367003367003}, "extracted_prediction": "SELECT      EXTRACT(MONTH FROM order_date) AS month,     SUM(total_amount) AS total_amount FROM orders WHERE EXTRACT(YEAR FROM order_date) = 2023 GROUP BY EXTRACT(MONTH FROM order_date) HAVING SUM(total_amount) > 50000 ORDER BY month", "prediction": "```sql\nSELECT \n    EXTRACT(MONTH FROM order_date) AS month,\n    SUM(total_amount) AS total_amount\nFROM orders\nWHERE EXTRACT(YEAR FROM order_date) = 2023\nGROUP BY EXTRACT(MONTH FROM order_date)\nHAVING SUM(total_amount) > 50000\nORDER BY month;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 27, "group_id": 27, "sample_metadata": {}}}
{"index": 1, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE users (user_id INT PRIMARY KEY, username TEXT, email TEXT, age INT, gender TEXT, registration_date DATE, last_login_date DATE, status TEXT, city TEXT, phone TEXT);\nQuestion: 统计每个城市的用户数量，只显示用户数量大于100的城市，按用户数量降序排列。\nSQL:", "target": "SELECT city, COUNT(*) as user_count FROM users GROUP BY city HAVING COUNT(*) > 100 ORDER BY user_count DESC;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.8984126984126984}, "extracted_prediction": "SELECT      city,     COUNT(user_id) AS user_count FROM users GROUP BY city HAVING COUNT(user_id) > 100 ORDER BY user_count DESC", "prediction": "```sql\nSELECT \n    city,\n    COUNT(user_id) AS user_count\nFROM users\nGROUP BY city\nHAVING COUNT(user_id) > 100\nORDER BY user_count DESC;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 1, "group_id": 1, "sample_metadata": {}}}

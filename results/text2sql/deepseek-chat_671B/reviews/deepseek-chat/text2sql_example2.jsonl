{"index": 88, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE interaction_logs (log_id INT, ip_address TEXT, timestamp TIMESTAMP);\nQuestion: 查询日志中的异常IP地址（访问频率超过100次/天的IP）。\nSQL:", "target": "SELECT ip_address, COUNT(*) as access_count FROM interaction_logs WHERE DATE(timestamp) = CURRENT_DATE GROUP BY ip_address HAVING COUNT(*) > 100;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.4583333333333333}, "extracted_prediction": "SELECT      ip_address,     DATE(timestamp) AS access_date,     COUNT(*) AS daily_access_count FROM interaction_logs GROUP BY ip_address, DATE(timestamp) HAVING COUNT(*) > 100 ORDER BY daily_access_count DESC", "prediction": "```sql\nSELECT \n    ip_address,\n    DATE(timestamp) AS access_date,\n    COUNT(*) AS daily_access_count\nFROM interaction_logs\nGROUP BY ip_address, DATE(timestamp)\nHAVING COUNT(*) > 100\nORDER BY daily_access_count DESC;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 88, "group_id": 88, "sample_metadata": {}}}
{"index": 30, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE orders (order_id INT, user_id INT, amount DECIMAL(10,2));\nQuestion: 查询每个用户的平均订单金额。\nSQL:", "target": "SELECT user_id, AVG(amount) as avg_amount FROM orders GROUP BY user_id;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.9259259259259259}, "extracted_prediction": "SELECT      user_id,     AVG(amount) AS average_order_amount FROM orders GROUP BY user_id", "prediction": "```sql\nSELECT \n    user_id,\n    AVG(amount) AS average_order_amount\nFROM orders\nGROUP BY user_id;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 30, "group_id": 30, "sample_metadata": {}}}
{"index": 10, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE users (user_id INT, name TEXT, age INT, registration_date DATE);\nQuestion: 查询年龄在20到40之间的用户，并按注册日期升序排列。\nSQL:", "target": "SELECT * FROM users WHERE age BETWEEN 20 AND 40 ORDER BY registration_date ASC;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.75}, "extracted_prediction": "SELECT user_id, name, age, registration_date FROM users WHERE age BETWEEN 20 AND 40 ORDER BY registration_date ASC", "prediction": "```sql\nSELECT user_id, name, age, registration_date\nFROM users\nWHERE age BETWEEN 20 AND 40\nORDER BY registration_date ASC;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 10, "group_id": 10, "sample_metadata": {}}}
{"index": 47, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE orders (order_id INT, user_id INT, order_date DATE);\nQuestion: 查询每个用户的最后一次订单日期。\nSQL:", "target": "SELECT user_id, MAX(order_date) as last_order_date FROM orders GROUP BY user_id;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT      user_id,     MAX(order_date) AS last_order_date FROM orders GROUP BY user_id", "prediction": "```sql\nSELECT \n    user_id,\n    MAX(order_date) AS last_order_date\nFROM orders\nGROUP BY user_id;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 47, "group_id": 47, "sample_metadata": {}}}
{"index": 51, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE documents (doc_id INT, category TEXT, version INT);\nQuestion: 查询每个类别的文档平均版本号。\nSQL:", "target": "SELECT category, AVG(version) as avg_version FROM documents GROUP BY category;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.9259259259259259}, "extracted_prediction": "SELECT category, AVG(version) AS average_version FROM documents GROUP BY category", "prediction": "```sql\nSELECT category, AVG(version) AS average_version\nFROM documents\nGROUP BY category;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 51, "group_id": 51, "sample_metadata": {}}}
{"index": 39, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE orders (order_id INT, user_id INT, order_date DATE);\nQuestion: 查询每个用户的第一次订单日期。\nSQL:", "target": "SELECT user_id, MIN(order_date) as first_order_date FROM orders GROUP BY user_id;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT      user_id,     MIN(order_date) AS first_order_date FROM orders GROUP BY user_id", "prediction": "```sql\nSELECT \n    user_id,\n    MIN(order_date) AS first_order_date\nFROM orders\nGROUP BY user_id;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 39, "group_id": 39, "sample_metadata": {}}}
{"index": 59, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE documents (doc_id INT, author TEXT, created_date DATE);\nQuestion: 查询每个作者的文档平均创建间隔（按天计算）。\nSQL:", "target": "SELECT author, AVG(created_date - LAG(created_date) OVER (PARTITION BY author ORDER BY created_date)) as avg_interval FROM documents GROUP BY author;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.45999999999999996}, "extracted_prediction": "SELECT      author,     AVG(date_diff) AS avg_creation_interval_days FROM (     SELECT          author,         DATEDIFF(             LEAD(created_date) OVER (PARTITION BY author ORDER BY created_date),             created_date         ) AS date_diff     FROM documents ) AS intervals WHERE date_diff IS NOT NULL GROUP BY author", "prediction": "```sql\nSELECT \n    author,\n    AVG(date_diff) AS avg_creation_interval_days\nFROM (\n    SELECT \n        author,\n        DATEDIFF(\n            LEAD(created_date) OVER (PARTITION BY author ORDER BY created_date),\n            created_date\n        ) AS date_diff\n    FROM documents\n) AS intervals\nWHERE date_diff IS NOT NULL\nGROUP BY author;\n```\n\n**说明：**\n1. 使用窗口函数 `LEAD()` 获取同一作者下一篇文档的创建日期\n2. `DATEDIFF()` 计算当前文档与下一篇文档的日期差（按天）\n3. 过滤掉最后一条文档的 `NULL` 间隔\n4. 按作者分组计算平均间隔天数\n\n如果数据库不支持 `LEAD()` 窗口函数（如 MySQL 8.0 以下版本），可以使用以下替代方案：\n\n```sql\nSELECT \n    d1.author,\n    AVG(DATEDIFF(MIN(d2.created_date), d1.created_date)) AS avg_creation_interval_days\nFROM documents d1\nJOIN documents d2 \n    ON d1.author = d2.author \n    AND d1.created_date < d2.created_date\nGROUP BY d1.author, d1.created_date\nHAVING MIN(d2.created_date) IS NOT NULL;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 59, "group_id": 59, "sample_metadata": {}}}
{"index": 19, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE users (user_id INT, country TEXT, age INT);\nQuestion: 查询每个国家的用户年龄的标准差。\nSQL:", "target": "SELECT country, STDDEV(age) as age_stddev FROM users GROUP BY country;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.75}, "extracted_prediction": "SELECT      country,     STDDEV(age) AS age_stddev FROM users WHERE age IS NOT NULL GROUP BY country", "prediction": "```sql\nSELECT \n    country,\n    STDDEV(age) AS age_stddev\nFROM users\nWHERE age IS NOT NULL\nGROUP BY country;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 19, "group_id": 19, "sample_metadata": {}}}
{"index": 67, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE documents (doc_id INT, category TEXT);\nQuestion: 查询文档表中没有类别的文档ID。\nSQL:", "target": "SELECT doc_id FROM documents WHERE category IS NULL OR category = '';", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT doc_id FROM documents WHERE category IS NULL OR category = ''", "prediction": "```sql\nSELECT doc_id\nFROM documents\nWHERE category IS NULL OR category = '';\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 67, "group_id": 67, "sample_metadata": {}}}
{"index": 52, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE documents (doc_id INT, title TEXT);\nQuestion: 查询标题包含'设计'的文档ID和标题。\nSQL:", "target": "SELECT doc_id, title FROM documents WHERE title LIKE '%设计%';", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT doc_id, title FROM documents WHERE title LIKE '%设计%'", "prediction": "```sql\nSELECT doc_id, title\nFROM documents\nWHERE title LIKE '%设计%';\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 52, "group_id": 52, "sample_metadata": {}}}
{"index": 95, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE interaction_logs (log_id INT, action TEXT);\nQuestion: 查询用户交互日志中的页面浏览量（action为'view'）的总数。\nSQL:", "target": "SELECT COUNT(*) as view_count FROM interaction_logs WHERE action = 'view';", "sample_score": {"score": {"value": {"sql_ast_sim": 0.9047619047619048}, "extracted_prediction": "SELECT COUNT(*) AS total_page_views FROM interaction_logs WHERE action = 'view'", "prediction": "```sql\nSELECT COUNT(*) AS total_page_views\nFROM interaction_logs\nWHERE action = 'view';\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 95, "group_id": 95, "sample_metadata": {}}}
{"index": 94, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE interaction_logs (log_id INT, action TEXT, duration INT);\nQuestion: 查询每个操作类型的总持续时间。\nSQL:", "target": "SELECT action, SUM(duration) as total_duration FROM interaction_logs GROUP BY action;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT      action,     SUM(duration) AS total_duration FROM interaction_logs GROUP BY action", "prediction": "```sql\nSELECT \n    action,\n    SUM(duration) AS total_duration\nFROM interaction_logs\nGROUP BY action;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 94, "group_id": 94, "sample_metadata": {}}}
{"index": 64, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE documents (doc_id INT, modified_date DATE);\nQuestion: 查询每个文档的修改次数（基于修改日期是否多次）。\nSQL:", "target": "SELECT doc_id, COUNT(DISTINCT modified_date) as modification_count FROM documents GROUP BY doc_id;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.7222222222222222}, "extracted_prediction": "SELECT      doc_id,     COUNT(modified_date) AS modification_count FROM documents GROUP BY doc_id HAVING COUNT(modified_date) > 0", "prediction": "```sql\nSELECT \n    doc_id,\n    COUNT(modified_date) AS modification_count\nFROM documents\nGROUP BY doc_id\nHAVING COUNT(modified_date) > 0;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 64, "group_id": 64, "sample_metadata": {}}}
{"index": 90, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE interaction_logs (log_id INT, timestamp TIMESTAMP);\nQuestion: 查询日志表中时间戳在夜间（22:00到06:00）的日志ID和时间戳。\nSQL:", "target": "SELECT log_id, timestamp FROM interaction_logs WHERE EXTRACT(HOUR FROM timestamp) >= 22 OR EXTRACT(HOUR FROM timestamp) < 6;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT log_id, timestamp FROM interaction_logs WHERE EXTRACT(HOUR FROM timestamp) >= 22     OR EXTRACT(HOUR FROM timestamp) < 6", "prediction": "```sql\nSELECT log_id, timestamp\nFROM interaction_logs\nWHERE EXTRACT(HOUR FROM timestamp) >= 22 \n   OR EXTRACT(HOUR FROM timestamp) < 6;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 90, "group_id": 90, "sample_metadata": {}}}
{"index": 50, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE documents (doc_id INT, title TEXT, modified_date DATE);\nQuestion: 查询最近一个月内修改过的文档标题和修改日期。\nSQL:", "target": "SELECT title, modified_date FROM documents WHERE modified_date >= CURRENT_DATE - INTERVAL '1 month';", "sample_score": {"score": {"value": {"sql_ast_sim": 0.5625}, "extracted_prediction": "SELECT title, modified_date FROM documents WHERE modified_date >= DATE_SUB(CURDATE(), INTERVAL 1 MONTH) ORDER BY modified_date DESC", "prediction": "```sql\nSELECT title, modified_date\nFROM documents\nWHERE modified_date >= DATE_SUB(CURDATE(), INTERVAL 1 MONTH)\nORDER BY modified_date DESC;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 50, "group_id": 50, "sample_metadata": {}}}
{"index": 83, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE interaction_logs (log_id INT, duration INT);\nQuestion: 查询操作日志中持续时间超过10秒的操作ID（假设有duration列）。\nSQL:", "target": "SELECT log_id FROM interaction_logs WHERE duration > 10;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT log_id FROM interaction_logs WHERE duration > 10", "prediction": "```sql\nSELECT log_id\nFROM interaction_logs\nWHERE duration > 10;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 83, "group_id": 83, "sample_metadata": {}}}
{"index": 58, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE documents (doc_id INT, title TEXT);\nQuestion: 查询文档中标题长度超过50个字符的文档ID和标题。\nSQL:", "target": "SELECT doc_id, title FROM documents WHERE LENGTH(title) > 50;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT doc_id, title FROM documents WHERE LENGTH(title) > 50", "prediction": "```sql\nSELECT doc_id, title\nFROM documents\nWHERE LENGTH(title) > 50;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 58, "group_id": 58, "sample_metadata": {}}}
{"index": 3, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE user_accounts (account_id INT, username TEXT, signup_date DATE);\nQuestion: 查询注册日期最早的前10名用户的用户名和注册日期。\nSQL:", "target": "SELECT username, signup_date FROM user_accounts ORDER BY signup_date ASC LIMIT 10;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT username, signup_date FROM user_accounts ORDER BY signup_date ASC LIMIT 10", "prediction": "```sql\nSELECT username, signup_date\nFROM user_accounts\nORDER BY signup_date ASC\nLIMIT 10;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 3, "group_id": 3, "sample_metadata": {}}}
{"index": 0, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE users (user_id INT, username TEXT, country TEXT, registration_date DATE);\nQuestion: 查询每个国家在2023年注册的用户数量user_count，并按数量降序排列。\nSQL:", "target": "SELECT country, COUNT(*) as user_count FROM users WHERE EXTRACT(YEAR FROM registration_date) = 2023 GROUP BY country ORDER BY user_count DESC;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT      country,     COUNT(*) AS user_count FROM users WHERE EXTRACT(YEAR FROM registration_date) = 2023 GROUP BY country ORDER BY user_count DESC", "prediction": "```sql\nSELECT \n    country,\n    COUNT(*) AS user_count\nFROM users\nWHERE EXTRACT(YEAR FROM registration_date) = 2023\nGROUP BY country\nORDER BY user_count DESC;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 0, "group_id": 0, "sample_metadata": {}}}
{"index": 77, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE interaction_logs (log_id INT, user_id INT);\nQuestion: 查询操作次数最多的用户ID和操作次数。\nSQL:", "target": "SELECT user_id, COUNT(*) as action_count FROM interaction_logs GROUP BY user_id ORDER BY action_count DESC LIMIT 1;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.7866666666666666}, "extracted_prediction": "SELECT      user_id,     COUNT(log_id) AS operation_count FROM interaction_logs GROUP BY user_id ORDER BY operation_count DESC LIMIT 1", "prediction": "```sql\nSELECT \n    user_id,\n    COUNT(log_id) AS operation_count\nFROM interaction_logs\nGROUP BY user_id\nORDER BY operation_count DESC\nLIMIT 1;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 77, "group_id": 77, "sample_metadata": {}}}
{"index": 84, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE interaction_logs (log_id INT, action TEXT, duration INT);\nQuestion: 查询每个操作类型的平均持续时间。\nSQL:", "target": "SELECT action, AVG(duration) as avg_duration FROM interaction_logs GROUP BY action;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.9259259259259259}, "extracted_prediction": "SELECT      action,     AVG(duration) AS average_duration FROM interaction_logs GROUP BY action", "prediction": "```sql\nSELECT \n    action,\n    AVG(duration) AS average_duration\nFROM interaction_logs\nGROUP BY action;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 84, "group_id": 84, "sample_metadata": {}}}
{"index": 6, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE users (user_id INT, name TEXT, email TEXT);\nQuestion: 查询用户表中没有邮箱地址的用户姓名。\nSQL:", "target": "SELECT name FROM users WHERE email IS NULL OR email = '';", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT name  FROM users  WHERE email IS NULL OR email = ''", "prediction": "```sql\nSELECT name \nFROM users \nWHERE email IS NULL OR email = '';\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 6, "group_id": 6, "sample_metadata": {}}}
{"index": 54, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE documents (doc_id INT, title TEXT, created_date DATE);\nQuestion: 查询创建日期在2023年的文档标题和创建日期。\nSQL:", "target": "SELECT title, created_date FROM documents WHERE EXTRACT(YEAR FROM created_date) = 2023;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT title, created_date FROM documents WHERE EXTRACT(YEAR FROM created_date) = 2023", "prediction": "```sql\nSELECT title, created_date\nFROM documents\nWHERE EXTRACT(YEAR FROM created_date) = 2023;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 54, "group_id": 54, "sample_metadata": {}}}
{"index": 32, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE orders (order_id INT, order_date DATE);\nQuestion: 查询最近一周内的订单ID和订单日期。\nSQL:", "target": "SELECT order_id, order_date FROM orders WHERE order_date >= CURRENT_DATE - INTERVAL '7 days';", "sample_score": {"score": {"value": {"sql_ast_sim": 0.5625}, "extracted_prediction": "SELECT order_id, order_date FROM orders WHERE order_date >= DATE_SUB(CURDATE(), INTERVAL 7 DAY) ORDER BY order_date DESC", "prediction": "```sql\nSELECT order_id, order_date\nFROM orders\nWHERE order_date >= DATE_SUB(CURDATE(), INTERVAL 7 DAY)\nORDER BY order_date DESC;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 32, "group_id": 32, "sample_metadata": {}}}
{"index": 37, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE orders (order_id INT, status TEXT, amount DECIMAL(10,2));\nQuestion: 查询每个订单状态的订单总金额。\nSQL:", "target": "SELECT status, SUM(amount) as total_amount FROM orders GROUP BY status;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT status, SUM(amount) AS total_amount FROM orders GROUP BY status", "prediction": "```sql\nSELECT status, SUM(amount) AS total_amount\nFROM orders\nGROUP BY status;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 37, "group_id": 37, "sample_metadata": {}}}
{"index": 55, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE documents (doc_id INT, author TEXT, views INT);\nQuestion: 查询每个作者的文档总浏览量。\nSQL:", "target": "SELECT author, SUM(views) as total_views FROM documents GROUP BY author;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT author, SUM(views) AS total_views FROM documents GROUP BY author", "prediction": "```sql\nSELECT author, SUM(views) AS total_views\nFROM documents\nGROUP BY author;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 55, "group_id": 55, "sample_metadata": {}}}
{"index": 98, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE interaction_logs (log_id INT, ip_country TEXT);\nQuestion: 查询操作日志的地理分布（基于IP地址的国家代码）。\nSQL:", "target": "SELECT ip_country, COUNT(*) as log_count FROM interaction_logs GROUP BY ip_country;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.5555555555555556}, "extracted_prediction": "SELECT      ip_country,     COUNT(log_id) AS log_count FROM interaction_logs WHERE ip_country IS NOT NULL GROUP BY ip_country ORDER BY log_count DESC", "prediction": "```sql\nSELECT \n    ip_country,\n    COUNT(log_id) AS log_count\nFROM interaction_logs\nWHERE ip_country IS NOT NULL\nGROUP BY ip_country\nORDER BY log_count DESC;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 98, "group_id": 98, "sample_metadata": {}}}
{"index": 87, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE interaction_logs (log_id INT, user_id INT);\nQuestion: 查询操作频率最高的前10个用户ID和操作次数。\nSQL:", "target": "SELECT user_id, COUNT(*) as action_count FROM interaction_logs GROUP BY user_id ORDER BY action_count DESC LIMIT 10;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.7866666666666666}, "extracted_prediction": "SELECT      user_id,     COUNT(log_id) AS operation_count FROM interaction_logs GROUP BY user_id ORDER BY operation_count DESC LIMIT 10", "prediction": "```sql\nSELECT \n    user_id,\n    COUNT(log_id) AS operation_count\nFROM interaction_logs\nGROUP BY user_id\nORDER BY operation_count DESC\nLIMIT 10;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 87, "group_id": 87, "sample_metadata": {}}}
{"index": 93, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE interaction_logs (log_id INT, user_id INT, action TEXT, timestamp TIMESTAMP);\nQuestion: 查询日志表中操作重复的记录（相同用户、操作和时间戳）。\nSQL:", "target": "SELECT user_id, action, timestamp, COUNT(*) as duplicate_count FROM interaction_logs GROUP BY user_id, action, timestamp HAVING COUNT(*) > 1;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.775}, "extracted_prediction": "SELECT * FROM interaction_logs GROUP BY user_id, action, timestamp HAVING COUNT(*) > 1", "prediction": "```sql\nSELECT *\nFROM interaction_logs\nGROUP BY user_id, action, timestamp\nHAVING COUNT(*) > 1;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 93, "group_id": 93, "sample_metadata": {}}}
{"index": 71, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE documents (doc_id INT, author TEXT);\nQuestion: 查询文档表中作者为空的文档ID。\nSQL:", "target": "SELECT doc_id FROM documents WHERE author IS NULL;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT doc_id  FROM documents  WHERE author IS NULL", "prediction": "```sql\nSELECT doc_id \nFROM documents \nWHERE author IS NULL;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 71, "group_id": 71, "sample_metadata": {}}}
{"index": 29, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE orders (order_id INT, order_date DATE);\nQuestion: 查询订单日期在节假日（例如2023-12-25）内的订单ID和日期。\nSQL:", "target": "SELECT order_id, order_date FROM orders WHERE order_date = '2023-12-25';", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT order_id, order_date FROM orders WHERE order_date = '2023-12-25'", "prediction": "```sql\nSELECT order_id, order_date\nFROM orders\nWHERE order_date = '2023-12-25';\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 29, "group_id": 29, "sample_metadata": {}}}
{"index": 75, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE interaction_logs (log_id INT, timestamp TIMESTAMP);\nQuestion: 查询在2023-10-01这天内的所有日志ID和时间戳。\nSQL:", "target": "SELECT log_id, timestamp FROM interaction_logs WHERE DATE(timestamp) = '2023-10-01';", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT log_id, timestamp FROM interaction_logs WHERE DATE(timestamp) = '2023-10-01'", "prediction": "```sql\nSELECT log_id, timestamp\nFROM interaction_logs\nWHERE DATE(timestamp) = '2023-10-01';\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 75, "group_id": 75, "sample_metadata": {}}}
{"index": 18, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE users (user_id INT, registration_date DATE, last_login_date DATE);\nQuestion: 查询注册日期和最后登录日期相同的用户ID和日期。\nSQL:", "target": "SELECT user_id, registration_date FROM users WHERE registration_date = last_login_date;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT user_id, registration_date FROM users WHERE registration_date = last_login_date", "prediction": "```sql\nSELECT user_id, registration_date\nFROM users\nWHERE registration_date = last_login_date;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 18, "group_id": 18, "sample_metadata": {}}}
{"index": 89, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE interaction_logs (log_id INT, user_id INT, action TEXT);\nQuestion: 查询每个操作类型的用户数量。\nSQL:", "target": "SELECT action, COUNT(DISTINCT user_id) as user_count FROM interaction_logs GROUP BY action;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT action, COUNT(DISTINCT user_id) AS user_count FROM interaction_logs GROUP BY action", "prediction": "```sql\nSELECT action, COUNT(DISTINCT user_id) AS user_count\nFROM interaction_logs\nGROUP BY action;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 89, "group_id": 89, "sample_metadata": {}}}
{"index": 28, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE orders (order_id INT, payment_method TEXT);\nQuestion: 查询每个支付方式的订单数量。\nSQL:", "target": "SELECT payment_method, COUNT(*) as order_count FROM orders GROUP BY payment_method;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.9259259259259259}, "extracted_prediction": "SELECT payment_method, COUNT(order_id) AS order_count FROM orders GROUP BY payment_method", "prediction": "```sql\nSELECT payment_method, COUNT(order_id) AS order_count\nFROM orders\nGROUP BY payment_method;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 28, "group_id": 28, "sample_metadata": {}}}
{"index": 61, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE documents (doc_id INT, category TEXT);\nQuestion: 查询每个类别的文档数量，并只显示数量大于10的类别。\nSQL:", "target": "SELECT category, COUNT(*) as doc_count FROM documents GROUP BY category HAVING COUNT(*) > 10;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.9444444444444444}, "extracted_prediction": "SELECT category, COUNT(*) AS document_count FROM documents GROUP BY category HAVING COUNT(*) > 10", "prediction": "```sql\nSELECT category, COUNT(*) AS document_count\nFROM documents\nGROUP BY category\nHAVING COUNT(*) > 10;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 61, "group_id": 61, "sample_metadata": {}}}
{"index": 74, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE interaction_logs (log_id INT, user_id INT);\nQuestion: 查询每个用户的操作日志数量。\nSQL:", "target": "SELECT user_id, COUNT(*) as log_count FROM interaction_logs GROUP BY user_id;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.8666666666666667}, "extracted_prediction": "SELECT user_id, COUNT(log_id) AS operation_count FROM interaction_logs GROUP BY user_id", "prediction": "```sql\nSELECT user_id, COUNT(log_id) AS operation_count\nFROM interaction_logs\nGROUP BY user_id;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 74, "group_id": 74, "sample_metadata": {}}}
{"index": 63, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE documents (doc_id INT, title TEXT, author TEXT, created_date DATE);\nQuestion: 查询作者为'张三'的所有文档标题和创建日期。\nSQL:", "target": "SELECT title, created_date FROM documents WHERE author = '张三';", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT title, created_date  FROM documents  WHERE author = '张三'", "prediction": "```sql\nSELECT title, created_date \nFROM documents \nWHERE author = '张三';\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 63, "group_id": 63, "sample_metadata": {}}}
{"index": 80, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE interaction_logs (log_id INT, timestamp TIMESTAMP);\nQuestion: 查询每个小时的操作频率（基于时间戳）。\nSQL:", "target": "SELECT EXTRACT(HOUR FROM timestamp) as hour, COUNT(*) as action_count FROM interaction_logs GROUP BY EXTRACT(HOUR FROM timestamp) ORDER BY hour;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.34791666666666665}, "extracted_prediction": "SELECT      DATE_TRUNC('hour', timestamp) AS hour,     COUNT(log_id) AS operation_count FROM      interaction_logs GROUP BY      DATE_TRUNC('hour', timestamp) ORDER BY      hour", "prediction": "```sql\nSELECT \n    DATE_TRUNC('hour', timestamp) AS hour,\n    COUNT(log_id) AS operation_count\nFROM \n    interaction_logs\nGROUP BY \n    DATE_TRUNC('hour', timestamp)\nORDER BY \n    hour;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 80, "group_id": 80, "sample_metadata": {}}}
{"index": 36, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE orders (order_id INT, amount DECIMAL(10,2));\nQuestion: 查询订单金额最低的5个订单的订单ID和金额。\nSQL:", "target": "SELECT order_id, amount FROM orders ORDER BY amount ASC LIMIT 5;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT order_id, amount FROM orders ORDER BY amount ASC LIMIT 5", "prediction": "```sql\nSELECT order_id, amount\nFROM orders\nORDER BY amount ASC\nLIMIT 5;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 36, "group_id": 36, "sample_metadata": {}}}
{"index": 48, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE orders (order_id INT, user_id INT);\nQuestion: 查询订单表中没有用户ID的订单ID。\nSQL:", "target": "SELECT order_id FROM orders WHERE user_id IS NULL;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT order_id FROM orders WHERE user_id IS NULL", "prediction": "```sql\nSELECT order_id\nFROM orders\nWHERE user_id IS NULL;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 48, "group_id": 48, "sample_metadata": {}}}
{"index": 70, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE documents (doc_id INT, category TEXT, created_date DATE);\nQuestion: 查询每个类别的平均文档年龄（从创建日期到当前日期的天数）。\nSQL:", "target": "SELECT category, AVG(CURRENT_DATE - created_date) as avg_age_days FROM documents GROUP BY category;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.8611111111111112}, "extracted_prediction": "SELECT      category,     AVG(JULIANDAY('now') - JULIANDAY(created_date)) AS avg_document_age_days FROM documents GROUP BY category", "prediction": "```sql\nSELECT \n    category,\n    AVG(JULIANDAY('now') - JULIANDAY(created_date)) AS avg_document_age_days\nFROM documents\nGROUP BY category;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 70, "group_id": 70, "sample_metadata": {}}}
{"index": 12, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE users (user_id INT, name TEXT, registration_date DATE);\nQuestion: 查询注册日期在周末（星期六或星期日）的用户姓名和注册日期。\nSQL:", "target": "SELECT name, registration_date FROM users WHERE EXTRACT(DOW FROM registration_date) IN (0, 6);", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT name, registration_date FROM users WHERE EXTRACT(DOW FROM registration_date) IN (0, 6)", "prediction": "```sql\nSELECT name, registration_date\nFROM users\nWHERE EXTRACT(DOW FROM registration_date) IN (0, 6);\n```\n\n**说明：**\n- `EXTRACT(DOW FROM registration_date)` 提取注册日期的星期几信息（0=星期日，1=星期一，...，6=星期六）\n- `IN (0, 6)` 筛选出星期日（0）和星期六（6）\n- 如果数据库系统不同，可能需要调整函数（例如MySQL使用`DAYOFWEEK()`，SQL Server使用`DATEPART(dw, ...)`）", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 12, "group_id": 12, "sample_metadata": {}}}
{"index": 17, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE users (user_id INT, username TEXT);\nQuestion: 查询用户表中重复的用户名及其出现次数。\nSQL:", "target": "SELECT username, COUNT(*) as occurrence FROM users GROUP BY username HAVING COUNT(*) > 1;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.9444444444444444}, "extracted_prediction": "SELECT username, COUNT(*) AS occurrence_count FROM users GROUP BY username HAVING COUNT(*) > 1", "prediction": "```sql\nSELECT username, COUNT(*) AS occurrence_count\nFROM users\nGROUP BY username\nHAVING COUNT(*) > 1;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 17, "group_id": 17, "sample_metadata": {}}}
{"index": 41, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE orders (order_id INT, payment_method TEXT, amount DECIMAL(10,2));\nQuestion: 查询每个支付方式的总金额。\nSQL:", "target": "SELECT payment_method, SUM(amount) as total_amount FROM orders GROUP BY payment_method;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT payment_method, SUM(amount) AS total_amount FROM orders GROUP BY payment_method", "prediction": "```sql\nSELECT payment_method, SUM(amount) AS total_amount\nFROM orders\nGROUP BY payment_method;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 41, "group_id": 41, "sample_metadata": {}}}
{"index": 45, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE orders (order_id INT, product_id INT);\nQuestion: 查询每个产品ID的订单数量。\nSQL:", "target": "SELECT product_id, COUNT(*) as order_count FROM orders GROUP BY product_id;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.9259259259259259}, "extracted_prediction": "SELECT product_id, COUNT(order_id) AS order_count FROM orders GROUP BY product_id", "prediction": "```sql\nSELECT product_id, COUNT(order_id) AS order_count\nFROM orders\nGROUP BY product_id;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 45, "group_id": 45, "sample_metadata": {}}}
{"index": 16, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE users (user_id INT, name TEXT, country TEXT, age INT);\nQuestion: 查询每个国家的最大年龄用户及其年龄。\nSQL:", "target": "SELECT country, name, MAX(age) as max_age FROM users GROUP BY country, name;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.2777777777777778}, "extracted_prediction": "SELECT      country,     name,     age FROM users u1 WHERE age = (     SELECT MAX(age)     FROM users u2     WHERE u1.country = u2.country )", "prediction": "```sql\nSELECT \n    country,\n    name,\n    age\nFROM users u1\nWHERE age = (\n    SELECT MAX(age)\n    FROM users u2\n    WHERE u1.country = u2.country\n);\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 16, "group_id": 16, "sample_metadata": {}}}
{"index": 25, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE orders (order_id INT, status TEXT, amount DECIMAL(10,2));\nQuestion: 查询状态为'completed'且金额超过1000的订单数量。\nSQL:", "target": "SELECT COUNT(*) as order_count FROM orders WHERE status = 'completed' AND amount > 1000;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.8888888888888888}, "extracted_prediction": "SELECT COUNT(*)  FROM orders  WHERE status = 'completed'    AND amount > 1000", "prediction": "```sql\nSELECT COUNT(*) \nFROM orders \nWHERE status = 'completed' \n  AND amount > 1000;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 25, "group_id": 25, "sample_metadata": {}}}
{"index": 20, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE users (user_id INT, name TEXT, age INT);\nQuestion: 查询年龄大于所有用户平均年龄的用户姓名和年龄。\nSQL:", "target": "SELECT name, age FROM users WHERE age > (SELECT AVG(age) FROM users);", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT name, age FROM users WHERE age > (SELECT AVG(age) FROM users)", "prediction": "```sql\nSELECT name, age\nFROM users\nWHERE age > (SELECT AVG(age) FROM users);\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 20, "group_id": 20, "sample_metadata": {}}}
{"index": 79, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE interaction_logs (log_id INT, ip_address TEXT, timestamp TIMESTAMP);\nQuestion: 查询来自特定IP地址'192.168.1.1'的日志ID和时间戳。\nSQL:", "target": "SELECT log_id, timestamp FROM interaction_logs WHERE ip_address = '192.168.1.1';", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT log_id, timestamp  FROM interaction_logs  WHERE ip_address = '192.168.1.1'", "prediction": "```sql\nSELECT log_id, timestamp \nFROM interaction_logs \nWHERE ip_address = '192.168.1.1';\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 79, "group_id": 79, "sample_metadata": {}}}
{"index": 68, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE documents (doc_id INT, author TEXT, title TEXT, version INT);\nQuestion: 查询每个作者的文档中，版本号最高的文档标题。\nSQL:", "target": "SELECT author, title, version FROM documents d1 WHERE version = (SELECT MAX(version) FROM documents d2 WHERE d2.author = d1.author);", "sample_score": {"score": {"value": {"sql_ast_sim": 0.18939393939393936}, "extracted_prediction": "SELECT d1.author, d1.title FROM documents d1 INNER JOIN (     SELECT author, MAX(version) AS max_version     FROM documents     GROUP BY author ) d2 ON d1.author = d2.author AND d1.version = d2.max_version", "prediction": "```sql\nSELECT d1.author, d1.title\nFROM documents d1\nINNER JOIN (\n    SELECT author, MAX(version) AS max_version\n    FROM documents\n    GROUP BY author\n) d2 ON d1.author = d2.author AND d1.version = d2.max_version;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 68, "group_id": 68, "sample_metadata": {}}}
{"index": 86, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE interaction_logs (log_id INT, session_id TEXT, timestamp TIMESTAMP);\nQuestion: 查询每个会话的起始和结束时间（最小和最大时间戳）。\nSQL:", "target": "SELECT session_id, MIN(timestamp) as start_time, MAX(timestamp) as end_time FROM interaction_logs GROUP BY session_id;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT      session_id,     MIN(timestamp) AS start_time,     MAX(timestamp) AS end_time FROM interaction_logs GROUP BY session_id", "prediction": "```sql\nSELECT \n    session_id,\n    MIN(timestamp) AS start_time,\n    MAX(timestamp) AS end_time\nFROM interaction_logs\nGROUP BY session_id;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 86, "group_id": 86, "sample_metadata": {}}}
{"index": 53, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE documents (doc_id INT, project_id INT);\nQuestion: 查询每个项目的文档数量。\nSQL:", "target": "SELECT project_id, COUNT(*) as doc_count FROM documents GROUP BY project_id;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.8666666666666667}, "extracted_prediction": "SELECT project_id, COUNT(doc_id) AS document_count FROM documents GROUP BY project_id", "prediction": "```sql\nSELECT project_id, COUNT(doc_id) AS document_count\nFROM documents\nGROUP BY project_id;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 53, "group_id": 53, "sample_metadata": {}}}
{"index": 91, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE interaction_logs (log_id INT, user_id INT, timestamp TIMESTAMP);\nQuestion: 查询每个用户的最后操作时间。\nSQL:", "target": "SELECT user_id, MAX(timestamp) as last_action_time FROM interaction_logs GROUP BY user_id;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.9259259259259259}, "extracted_prediction": "SELECT      user_id,     MAX(timestamp) AS last_operation_time FROM interaction_logs GROUP BY user_id", "prediction": "```sql\nSELECT \n    user_id,\n    MAX(timestamp) AS last_operation_time\nFROM interaction_logs\nGROUP BY user_id;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 91, "group_id": 91, "sample_metadata": {}}}
{"index": 27, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE orders (order_id INT, amount DECIMAL(10,2));\nQuestion: 查询订单金额最高的前10个订单的订单ID和金额。\nSQL:", "target": "SELECT order_id, amount FROM orders ORDER BY amount DESC LIMIT 10;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT order_id, amount FROM orders ORDER BY amount DESC LIMIT 10", "prediction": "```sql\nSELECT order_id, amount\nFROM orders\nORDER BY amount DESC\nLIMIT 10;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 27, "group_id": 27, "sample_metadata": {}}}
{"index": 92, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE interaction_logs (log_id INT, user_id INT, action TEXT, timestamp TIMESTAMP);\nQuestion: 查询操作链序列（连续操作相同action的用户）。\nSQL:", "target": "SELECT user_id, action, COUNT(*) as sequence_count FROM interaction_logs GROUP BY user_id, action HAVING COUNT(*) > 1;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.3760822510822511}, "extracted_prediction": "WITH ranked_logs AS (     SELECT          user_id,         action,         timestamp,         ROW_NUMBER() OVER (PARTITION BY user_id ORDER BY timestamp) AS rn,         ROW_NUMBER() OVER (PARTITION BY user_id, action ORDER BY timestamp) AS action_rn     FROM interaction_logs ), action_groups AS (     SELECT          user_id,         action,         timestamp,         rn - action_rn AS group_id     FROM ranked_logs ) SELECT      user_id,     action,     MIN(timestamp) AS start_time,     MAX(timestamp) AS end_time,     COUNT(*) AS consecutive_count FROM action_groups GROUP BY user_id, action, group_id HAVING COUNT(*) > 1 ORDER BY user_id, start_time", "prediction": "要查询连续操作相同 `action` 的用户，可以使用窗口函数来识别连续的操作序列。  \n\n以下是 SQL 查询：  \n\n```sql\nWITH ranked_logs AS (\n    SELECT \n        user_id,\n        action,\n        timestamp,\n        ROW_NUMBER() OVER (PARTITION BY user_id ORDER BY timestamp) AS rn,\n        ROW_NUMBER() OVER (PARTITION BY user_id, action ORDER BY timestamp) AS action_rn\n    FROM interaction_logs\n),\naction_groups AS (\n    SELECT \n        user_id,\n        action,\n        timestamp,\n        rn - action_rn AS group_id\n    FROM ranked_logs\n)\nSELECT \n    user_id,\n    action,\n    MIN(timestamp) AS start_time,\n    MAX(timestamp) AS end_time,\n    COUNT(*) AS consecutive_count\nFROM action_groups\nGROUP BY user_id, action, group_id\nHAVING COUNT(*) > 1\nORDER BY user_id, start_time;\n```\n\n**解释**：  \n1. `ranked_logs`：为每个用户按时间排序编号（`rn`），并为每个用户+操作组合按时间排序编号（`action_rn`）。  \n2. `action_groups`：用 `rn - action_rn` 作为分组标识，连续相同操作的差值会相同，从而形成组。  \n3. 最后按 `user_id, action, group_id` 分组，统计连续次数大于 1 的序列，并给出起止时间。", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 92, "group_id": 92, "sample_metadata": {}}}
{"index": 78, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE interaction_logs (log_id INT, session_id TEXT);\nQuestion: 查询每个会话的日志数量。\nSQL:", "target": "SELECT session_id, COUNT(*) as log_count FROM interaction_logs GROUP BY session_id;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.9259259259259259}, "extracted_prediction": "SELECT session_id, COUNT(log_id) AS log_count FROM interaction_logs GROUP BY session_id", "prediction": "```sql\nSELECT session_id, COUNT(log_id) AS log_count\nFROM interaction_logs\nGROUP BY session_id;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 78, "group_id": 78, "sample_metadata": {}}}
{"index": 40, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE orders (order_id INT, amount DECIMAL(10,2));\nQuestion: 查询订单金额在500到1000之间的订单ID和金额。\nSQL:", "target": "SELECT order_id, amount FROM orders WHERE amount BETWEEN 500 AND 1000;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT order_id, amount FROM orders WHERE amount BETWEEN 500 AND 1000", "prediction": "```sql\nSELECT order_id, amount\nFROM orders\nWHERE amount BETWEEN 500 AND 1000;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 40, "group_id": 40, "sample_metadata": {}}}
{"index": 31, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE orders (order_id INT, status TEXT);\nQuestion: 查询订单状态分布，显示每个状态的订单数量。\nSQL:", "target": "SELECT status, COUNT(*) as order_count FROM orders GROUP BY status;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.6944444444444444}, "extracted_prediction": "SELECT      status,     COUNT(order_id) AS order_count FROM orders GROUP BY status ORDER BY order_count DESC", "prediction": "```sql\nSELECT \n    status,\n    COUNT(order_id) AS order_count\nFROM orders\nGROUP BY status\nORDER BY order_count DESC;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 31, "group_id": 31, "sample_metadata": {}}}
{"index": 49, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE documents (doc_id INT, author TEXT);\nQuestion: 查询每个作者创建的文档数量。\nSQL:", "target": "SELECT author, COUNT(*) as doc_count FROM documents GROUP BY author;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.8666666666666667}, "extracted_prediction": "SELECT author, COUNT(doc_id) AS document_count FROM documents GROUP BY author", "prediction": "```sql\nSELECT author, COUNT(doc_id) AS document_count\nFROM documents\nGROUP BY author;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 49, "group_id": 49, "sample_metadata": {}}}
{"index": 69, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE documents (doc_id INT, title TEXT, views INT);\nQuestion: 查询文档的浏览量排名前10的文档标题和浏览量。\nSQL:", "target": "SELECT title, views FROM documents ORDER BY views DESC LIMIT 10;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT title, views FROM documents ORDER BY views DESC LIMIT 10", "prediction": "```sql\nSELECT title, views\nFROM documents\nORDER BY views DESC\nLIMIT 10;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 69, "group_id": 69, "sample_metadata": {}}}
{"index": 46, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE orders (order_id INT, amount DECIMAL(10,2));\nQuestion: 查询订单金额的分布，按金额范围分组（例如0-100, 101-500等）。\nSQL:", "target": "SELECT CASE WHEN amount <= 100 THEN '0-100' WHEN amount <= 500 THEN '101-500' ELSE '500+' END as amount_range, COUNT(*) as order_count FROM orders GROUP BY CASE WHEN amount <= 100 THEN '0-100' WHEN amount <= 500 THEN '101-500' ELSE '500+' END;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.5984848484848485}, "extracted_prediction": "SELECT      CASE          WHEN amount BETWEEN 0 AND 100 THEN '0-100'         WHEN amount BETWEEN 101 AND 500 THEN '101-500'         WHEN amount BETWEEN 501 AND 1000 THEN '501-1000'         WHEN amount > 1000 THEN '1000+'         ELSE '其他'     END AS amount_range,     COUNT(*) AS order_count,     SUM(amount) AS total_amount FROM orders GROUP BY      CASE          WHEN amount BETWEEN 0 AND 100 THEN '0-100'         WHEN amount BETWEEN 101 AND 500 THEN '101-500'         WHEN amount BETWEEN 501 AND 1000 THEN '501-1000'         WHEN amount > 1000 THEN '1000+'         ELSE '其他'     END ORDER BY MIN(amount)", "prediction": "```sql\nSELECT \n    CASE \n        WHEN amount BETWEEN 0 AND 100 THEN '0-100'\n        WHEN amount BETWEEN 101 AND 500 THEN '101-500'\n        WHEN amount BETWEEN 501 AND 1000 THEN '501-1000'\n        WHEN amount > 1000 THEN '1000+'\n        ELSE '其他'\n    END AS amount_range,\n    COUNT(*) AS order_count,\n    SUM(amount) AS total_amount\nFROM orders\nGROUP BY \n    CASE \n        WHEN amount BETWEEN 0 AND 100 THEN '0-100'\n        WHEN amount BETWEEN 101 AND 500 THEN '101-500'\n        WHEN amount BETWEEN 501 AND 1000 THEN '501-1000'\n        WHEN amount > 1000 THEN '1000+'\n        ELSE '其他'\n    END\nORDER BY MIN(amount);\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 46, "group_id": 46, "sample_metadata": {}}}
{"index": 8, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE users (user_id INT, username TEXT);\nQuestion: 查询用户名中包含'admin'的用户ID和用户名。\nSQL:", "target": "SELECT user_id, username FROM users WHERE username LIKE '%admin%';", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT user_id, username FROM users WHERE username LIKE '%admin%'", "prediction": "```sql\nSELECT user_id, username\nFROM users\nWHERE username LIKE '%admin%';\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 8, "group_id": 8, "sample_metadata": {}}}
{"index": 33, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE orders (order_id INT, amount DECIMAL(10,2));\nQuestion: 查询订单金额大于平均订单金额的订单ID和金额。\nSQL:", "target": "SELECT order_id, amount FROM orders WHERE amount > (SELECT AVG(amount) FROM orders);", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT order_id, amount FROM orders WHERE amount > (SELECT AVG(amount) FROM orders)", "prediction": "```sql\nSELECT order_id, amount\nFROM orders\nWHERE amount > (SELECT AVG(amount) FROM orders);\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 33, "group_id": 33, "sample_metadata": {}}}
{"index": 65, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE documents (doc_id INT, created_date DATE, modified_date DATE);\nQuestion: 查询创建日期和修改日期相同的文档ID。\nSQL:", "target": "SELECT doc_id FROM documents WHERE created_date = modified_date;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT doc_id FROM documents WHERE created_date = modified_date", "prediction": "```sql\nSELECT doc_id\nFROM documents\nWHERE created_date = modified_date;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 65, "group_id": 65, "sample_metadata": {}}}
{"index": 26, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE orders (order_id INT, user_id INT, amount DECIMAL(10,2));\nQuestion: 查询每个用户的订单总数和总金额。\nSQL:", "target": "SELECT user_id, COUNT(*) as order_count, SUM(amount) as total_amount FROM orders GROUP BY user_id;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.9444444444444445}, "extracted_prediction": "SELECT      user_id,     COUNT(order_id) AS order_count,     SUM(amount) AS total_amount FROM orders GROUP BY user_id", "prediction": "```sql\nSELECT \n    user_id,\n    COUNT(order_id) AS order_count,\n    SUM(amount) AS total_amount\nFROM orders\nGROUP BY user_id;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 26, "group_id": 26, "sample_metadata": {}}}
{"index": 35, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE orders (order_id INT, user_id INT, amount DECIMAL(10,2));\nQuestion: 查询用户ID为1001的所有订单ID和金额。\nSQL:", "target": "SELECT order_id, amount FROM orders WHERE user_id = 1001;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT order_id, amount  FROM orders  WHERE user_id = 1001", "prediction": "```sql\nSELECT order_id, amount \nFROM orders \nWHERE user_id = 1001;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 35, "group_id": 35, "sample_metadata": {}}}
{"index": 24, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE orders (order_id INT, order_date DATE, amount DECIMAL(10,2));\nQuestion: 查询2023年每个月的订单总金额。\nSQL:", "target": "SELECT EXTRACT(MONTH FROM order_date) as month, SUM(amount) as total_amount FROM orders WHERE EXTRACT(YEAR FROM order_date) = 2023 GROUP BY EXTRACT(MONTH FROM order_date) ORDER BY month;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT      EXTRACT(MONTH FROM order_date) AS month,     SUM(amount) AS total_amount FROM orders WHERE EXTRACT(YEAR FROM order_date) = 2023 GROUP BY EXTRACT(MONTH FROM order_date) ORDER BY month", "prediction": "```sql\nSELECT \n    EXTRACT(MONTH FROM order_date) AS month,\n    SUM(amount) AS total_amount\nFROM orders\nWHERE EXTRACT(YEAR FROM order_date) = 2023\nGROUP BY EXTRACT(MONTH FROM order_date)\nORDER BY month;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 24, "group_id": 24, "sample_metadata": {}}}
{"index": 43, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE orders (order_id INT, user_id INT, order_date DATE);\nQuestion: 查询每个用户的订单频率（平均每天订单数）。\nSQL:", "target": "SELECT user_id, COUNT(*) / COUNT(DISTINCT order_date) as avg_orders_per_day FROM orders GROUP BY user_id;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.9393939393939394}, "extracted_prediction": "SELECT      user_id,     COUNT(order_id) / COUNT(DISTINCT order_date) AS avg_orders_per_day FROM orders GROUP BY user_id", "prediction": "```sql\nSELECT \n    user_id,\n    COUNT(order_id) / COUNT(DISTINCT order_date) AS avg_orders_per_day\nFROM orders\nGROUP BY user_id;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 43, "group_id": 43, "sample_metadata": {}}}
{"index": 57, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE documents (doc_id INT, title TEXT, category TEXT, modified_date DATE);\nQuestion: 查询每个类别的文档中，最新修改的文档标题。\nSQL:", "target": "SELECT category, title, modified_date FROM documents d1 WHERE modified_date = (SELECT MAX(modified_date) FROM documents d2 WHERE d2.category = d1.category);", "sample_score": {"score": {"value": {"sql_ast_sim": 0.18939393939393936}, "extracted_prediction": "SELECT d1.title FROM documents d1 INNER JOIN (     SELECT category, MAX(modified_date) AS latest_date     FROM documents     GROUP BY category ) d2 ON d1.category = d2.category AND d1.modified_date = d2.latest_date", "prediction": "```sql\nSELECT d1.title\nFROM documents d1\nINNER JOIN (\n    SELECT category, MAX(modified_date) AS latest_date\n    FROM documents\n    GROUP BY category\n) d2 ON d1.category = d2.category AND d1.modified_date = d2.latest_date;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 57, "group_id": 57, "sample_metadata": {}}}
{"index": 22, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE users (user_id INT, country TEXT, registration_date DATE);\nQuestion: 查询每个国家的用户注册趋势，按年份统计数量。\nSQL:", "target": "SELECT country, EXTRACT(YEAR FROM registration_date) as year, COUNT(*) as user_count FROM users GROUP BY country, EXTRACT(YEAR FROM registration_date) ORDER BY country, year;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.6333333333333333}, "extracted_prediction": "SELECT      country,     EXTRACT(YEAR FROM registration_date) AS registration_year,     COUNT(user_id) AS user_count FROM users WHERE registration_date IS NOT NULL GROUP BY country, EXTRACT(YEAR FROM registration_date) ORDER BY country, registration_year", "prediction": "```sql\nSELECT \n    country,\n    EXTRACT(YEAR FROM registration_date) AS registration_year,\n    COUNT(user_id) AS user_count\nFROM users\nWHERE registration_date IS NOT NULL\nGROUP BY country, EXTRACT(YEAR FROM registration_date)\nORDER BY country, registration_year;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 22, "group_id": 22, "sample_metadata": {}}}
{"index": 66, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE documents (doc_id INT, version INT);\nQuestion: 查询每个文档的版本升级情况（版本号增加）。\nSQL:", "target": "SELECT doc_id, version FROM documents WHERE version > 1;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.13888888888888887}, "extracted_prediction": "SELECT      d1.doc_id,     d1.version AS old_version,     d2.version AS new_version FROM      documents d1 JOIN      documents d2 ON d1.doc_id = d2.doc_id      AND d1.version < d2.version ORDER BY      d1.doc_id,      d1.version,      d2.version", "prediction": "```sql\nSELECT \n    d1.doc_id,\n    d1.version AS old_version,\n    d2.version AS new_version\nFROM \n    documents d1\nJOIN \n    documents d2 ON d1.doc_id = d2.doc_id \n    AND d1.version < d2.version\nORDER BY \n    d1.doc_id, \n    d1.version, \n    d2.version;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 66, "group_id": 66, "sample_metadata": {}}}
{"index": 72, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE documents (doc_id INT, project_id INT, views INT);\nQuestion: 查询每个项目的文档总浏览量。\nSQL:", "target": "SELECT project_id, SUM(views) as total_views FROM documents GROUP BY project_id;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT project_id, SUM(views) AS total_views FROM documents GROUP BY project_id", "prediction": "```sql\nSELECT project_id, SUM(views) AS total_views\nFROM documents\nGROUP BY project_id;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 72, "group_id": 72, "sample_metadata": {}}}
{"index": 81, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE interaction_logs (log_id INT, user_id INT, action TEXT);\nQuestion: 查询用户交互日志中的错误操作（action为'error'）的日志ID和用户ID。\nSQL:", "target": "SELECT log_id, user_id FROM interaction_logs WHERE action = 'error';", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT log_id, user_id FROM interaction_logs WHERE action = 'error'", "prediction": "```sql\nSELECT log_id, user_id\nFROM interaction_logs\nWHERE action = 'error';\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 81, "group_id": 81, "sample_metadata": {}}}
{"index": 5, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE users (user_id INT, name TEXT, age INT);\nQuestion: 查询年龄小于18或大于60的用户姓名和年龄，并按年龄排序。\nSQL:", "target": "SELECT name, age FROM users WHERE age < 18 OR age > 60 ORDER BY age;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT name, age FROM users WHERE age < 18 OR age > 60 ORDER BY age", "prediction": "```sql\nSELECT name, age\nFROM users\nWHERE age < 18 OR age > 60\nORDER BY age;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 5, "group_id": 5, "sample_metadata": {}}}
{"index": 2, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE users (user_id INT, country TEXT, age INT);\nQuestion: 查询每个国家的用户平均年龄avg_age，并只显示平均年龄大于25的国家。\nSQL:", "target": "SELECT country, AVG(age) as avg_age FROM users GROUP BY country HAVING AVG(age) > 25;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT      country,     AVG(age) AS avg_age FROM users GROUP BY country HAVING AVG(age) > 25", "prediction": "```sql\nSELECT \n    country,\n    AVG(age) AS avg_age\nFROM users\nGROUP BY country\nHAVING AVG(age) > 25;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 2, "group_id": 2, "sample_metadata": {}}}
{"index": 21, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE users (user_id INT, username TEXT);\nQuestion: 查询用户名长度超过10个字符的用户姓名。\nSQL:", "target": "SELECT username FROM users WHERE LENGTH(username) > 10;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT username FROM users WHERE LENGTH(username) > 10", "prediction": "```sql\nSELECT username\nFROM users\nWHERE LENGTH(username) > 10;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 21, "group_id": 21, "sample_metadata": {}}}
{"index": 38, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE orders (order_id INT, order_date DATE, ship_date DATE);\nQuestion: 查询订单日期和发货日期相同的订单ID。\nSQL:", "target": "SELECT order_id FROM orders WHERE order_date = ship_date;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT order_id FROM orders WHERE order_date = ship_date", "prediction": "```sql\nSELECT order_id\nFROM orders\nWHERE order_date = ship_date;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 38, "group_id": 38, "sample_metadata": {}}}
{"index": 13, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE users (user_id INT, age INT);\nQuestion: 查询每个年龄的用户数量user_count，并只显示数量大于5的年龄。\nSQL:", "target": "SELECT age, COUNT(*) as user_count FROM users GROUP BY age HAVING COUNT(*) > 5;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT age, COUNT(*) AS user_count FROM users GROUP BY age HAVING COUNT(*) > 5", "prediction": "```sql\nSELECT age, COUNT(*) AS user_count\nFROM users\nGROUP BY age\nHAVING COUNT(*) > 5;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 13, "group_id": 13, "sample_metadata": {}}}
{"index": 11, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE users (user_id INT, country TEXT);\nQuestion: 查询每个国家的用户数量user_count，并计算占所有国家总用户数的百分比percentage。\nSQL:", "target": "SELECT country, COUNT(*) as user_count, (COUNT(*) * 100.0 / (SELECT COUNT(*) FROM users)) as percentage FROM users GROUP BY country;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.4855769230769231}, "extracted_prediction": "SELECT      country,     COUNT(*) AS user_count,     ROUND(COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (), 2) AS percentage FROM users GROUP BY country ORDER BY user_count DESC", "prediction": "```sql\nSELECT \n    country,\n    COUNT(*) AS user_count,\n    ROUND(COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (), 2) AS percentage\nFROM users\nGROUP BY country\nORDER BY user_count DESC;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 11, "group_id": 11, "sample_metadata": {}}}
{"index": 14, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE login_logs (user_id INT, login_time TIMESTAMP);\nQuestion: 查询最后登录时间在最近7天内的用户ID和登录时间。\nSQL:", "target": "SELECT user_id, login_time FROM login_logs WHERE login_time >= CURRENT_DATE - INTERVAL '7 days';", "sample_score": {"score": {"value": {"sql_ast_sim": 0.6666666666666666}, "extracted_prediction": "SELECT user_id, login_time FROM login_logs WHERE login_time >= CURRENT_TIMESTAMP - INTERVAL '7 days' ORDER BY login_time DESC", "prediction": "```sql\nSELECT user_id, login_time\nFROM login_logs\nWHERE login_time >= CURRENT_TIMESTAMP - INTERVAL '7 days'\nORDER BY login_time DESC;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 14, "group_id": 14, "sample_metadata": {}}}
{"index": 85, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE interaction_logs (log_id INT, user_id INT);\nQuestion: 查询日志表中用户ID为NULL的日志ID。\nSQL:", "target": "SELECT log_id FROM interaction_logs WHERE user_id IS NULL;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT log_id  FROM interaction_logs  WHERE user_id IS NULL", "prediction": "```sql\nSELECT log_id \nFROM interaction_logs \nWHERE user_id IS NULL;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 85, "group_id": 85, "sample_metadata": {}}}
{"index": 7, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE users (user_id INT, country TEXT, is_active BOOLEAN);\nQuestion: 查询每个国家活跃用户（is_active为true）的数量active_users。\nSQL:", "target": "SELECT country, COUNT(*) as active_users FROM users WHERE is_active = TRUE GROUP BY country;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT      country,     COUNT(*) AS active_users FROM users WHERE is_active = TRUE GROUP BY country", "prediction": "```sql\nSELECT \n    country,\n    COUNT(*) AS active_users\nFROM users\nWHERE is_active = TRUE\nGROUP BY country;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 7, "group_id": 7, "sample_metadata": {}}}
{"index": 97, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE interaction_logs (log_id INT, session_id TEXT);\nQuestion: 查询日志表中会话ID为空的日志ID。\nSQL:", "target": "SELECT log_id FROM interaction_logs WHERE session_id IS NULL OR session_id = '';", "sample_score": {"score": {"value": {"sql_ast_sim": 0.8333333333333334}, "extracted_prediction": "SELECT log_id  FROM interaction_logs  WHERE session_id IS NULL", "prediction": "```sql\nSELECT log_id \nFROM interaction_logs \nWHERE session_id IS NULL;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 97, "group_id": 97, "sample_metadata": {}}}
{"index": 82, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE interaction_logs (log_id INT, user_id INT, timestamp TIMESTAMP);\nQuestion: 查询每个用户的首次操作时间。\nSQL:", "target": "SELECT user_id, MIN(timestamp) as first_action_time FROM interaction_logs GROUP BY user_id;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.9259259259259259}, "extracted_prediction": "SELECT      user_id,     MIN(timestamp) AS first_operation_time FROM      interaction_logs GROUP BY      user_id", "prediction": "```sql\nSELECT \n    user_id,\n    MIN(timestamp) AS first_operation_time\nFROM \n    interaction_logs\nGROUP BY \n    user_id;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 82, "group_id": 82, "sample_metadata": {}}}
{"index": 60, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE documents (doc_id INT, title TEXT);\nQuestion: 查询文档表中重复的标题及其出现次数。\nSQL:", "target": "SELECT title, COUNT(*) as occurrence FROM documents GROUP BY title HAVING COUNT(*) > 1;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.9444444444444444}, "extracted_prediction": "SELECT title, COUNT(*) AS occurrence_count FROM documents GROUP BY title HAVING COUNT(*) > 1", "prediction": "```sql\nSELECT title, COUNT(*) AS occurrence_count\nFROM documents\nGROUP BY title\nHAVING COUNT(*) > 1;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 60, "group_id": 60, "sample_metadata": {}}}
{"index": 42, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE orders (order_id INT, user_id INT, order_date DATE);\nQuestion: 查询订单表中重复的订单（基于用户ID和订单日期）。\nSQL:", "target": "SELECT user_id, order_date, COUNT(*) as duplicate_count FROM orders GROUP BY user_id, order_date HAVING COUNT(*) > 1;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT      user_id,     order_date,     COUNT(*) AS duplicate_count FROM orders GROUP BY user_id, order_date HAVING COUNT(*) > 1", "prediction": "```sql\nSELECT \n    user_id,\n    order_date,\n    COUNT(*) AS duplicate_count\nFROM orders\nGROUP BY user_id, order_date\nHAVING COUNT(*) > 1;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 42, "group_id": 42, "sample_metadata": {}}}
{"index": 76, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE interaction_logs (log_id INT, action TEXT);\nQuestion: 查询每个操作类型的次数。\nSQL:", "target": "SELECT action, COUNT(*) as action_count FROM interaction_logs GROUP BY action;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.9583333333333334}, "extracted_prediction": "SELECT action, COUNT(*) AS count FROM interaction_logs GROUP BY action", "prediction": "```sql\nSELECT action, COUNT(*) AS count\nFROM interaction_logs\nGROUP BY action;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 76, "group_id": 76, "sample_metadata": {}}}
{"index": 23, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE users (user_id INT, age INT);\nQuestion: 查询用户表中年龄为NULL的用户ID。\nSQL:", "target": "SELECT user_id FROM users WHERE age IS NULL;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT user_id FROM users WHERE age IS NULL", "prediction": "```sql\nSELECT user_id\nFROM users\nWHERE age IS NULL;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 23, "group_id": 23, "sample_metadata": {}}}
{"index": 44, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE orders (order_id INT, status TEXT, order_date DATE);\nQuestion: 查询订单状态为'pending'且订单日期超过30天的订单ID。\nSQL:", "target": "SELECT order_id FROM orders WHERE status = 'pending' AND order_date < CURRENT_DATE - INTERVAL '30 days';", "sample_score": {"score": {"value": {"sql_ast_sim": 0.8333333333333334}, "extracted_prediction": "SELECT order_id FROM orders WHERE status = 'pending'   AND order_date < DATE('now', '-30 days')", "prediction": "```sql\nSELECT order_id\nFROM orders\nWHERE status = 'pending'\n  AND order_date < DATE('now', '-30 days');\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 44, "group_id": 44, "sample_metadata": {}}}
{"index": 34, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE orders (order_id INT, order_date DATE);\nQuestion: 查询2023年每个月的订单数量变化。\nSQL:", "target": "SELECT EXTRACT(MONTH FROM order_date) as month, COUNT(*) as order_count FROM orders WHERE EXTRACT(YEAR FROM order_date) = 2023 GROUP BY EXTRACT(MONTH FROM order_date) ORDER BY month;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.9692307692307691}, "extracted_prediction": "SELECT      EXTRACT(MONTH FROM order_date) AS month,     COUNT(order_id) AS order_count FROM orders WHERE EXTRACT(YEAR FROM order_date) = 2023 GROUP BY EXTRACT(MONTH FROM order_date) ORDER BY month", "prediction": "```sql\nSELECT \n    EXTRACT(MONTH FROM order_date) AS month,\n    COUNT(order_id) AS order_count\nFROM orders\nWHERE EXTRACT(YEAR FROM order_date) = 2023\nGROUP BY EXTRACT(MONTH FROM order_date)\nORDER BY month;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 34, "group_id": 34, "sample_metadata": {}}}
{"index": 4, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE users (user_id INT, registration_date DATE);\nQuestion: 查询2023年每个月month的用户注册数量user_count，并按月份升序排列。\nSQL:", "target": "SELECT EXTRACT(MONTH FROM registration_date) as month, COUNT(*) as user_count FROM users WHERE EXTRACT(YEAR FROM registration_date) = 2023 GROUP BY EXTRACT(MONTH FROM registration_date) ORDER BY month;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.8692307692307691}, "extracted_prediction": "SELECT      EXTRACT(MONTH FROM registration_date) AS month,     COUNT(user_id) AS user_count FROM users WHERE EXTRACT(YEAR FROM registration_date) = 2023 GROUP BY EXTRACT(MONTH FROM registration_date) ORDER BY month ASC", "prediction": "```sql\nSELECT \n    EXTRACT(MONTH FROM registration_date) AS month,\n    COUNT(user_id) AS user_count\nFROM users\nWHERE EXTRACT(YEAR FROM registration_date) = 2023\nGROUP BY EXTRACT(MONTH FROM registration_date)\nORDER BY month ASC;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 4, "group_id": 4, "sample_metadata": {}}}
{"index": 1, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE user_sessions (user_id INT, username TEXT, age INT, last_login TIMESTAMP);\nQuestion: 查询年龄大于30且最后登录时间在2023年之后的用户ID和用户名。\nSQL:", "target": "SELECT user_id, username FROM user_sessions WHERE age > 30 AND last_login >= '2023-01-01';", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT user_id, username FROM user_sessions WHERE age > 30   AND last_login >= '2024-01-01'", "prediction": "```sql\nSELECT user_id, username\nFROM user_sessions\nWHERE age > 30\n  AND last_login >= '2024-01-01';\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 1, "group_id": 1, "sample_metadata": {}}}
{"index": 56, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE documents (doc_id INT, version INT);\nQuestion: 查询版本号大于5的文档ID和版本号。\nSQL:", "target": "SELECT doc_id, version FROM documents WHERE version > 5;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT doc_id, version FROM documents WHERE version > 5", "prediction": "```sql\nSELECT doc_id, version\nFROM documents\nWHERE version > 5;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 56, "group_id": 56, "sample_metadata": {}}}
{"index": 15, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE users (user_id INT, name TEXT, email TEXT);\nQuestion: 查询邮箱地址以'gmail.com'结尾的用户姓名和邮箱。\nSQL:", "target": "SELECT name, email FROM users WHERE email LIKE '%gmail.com';", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT name, email FROM users WHERE email LIKE '%gmail.com'", "prediction": "```sql\nSELECT name, email\nFROM users\nWHERE email LIKE '%gmail.com';\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 15, "group_id": 15, "sample_metadata": {}}}
{"index": 96, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE interaction_logs (log_id INT, user_id INT, timestamp TIMESTAMP);\nQuestion: 查询每个用户的平均操作间隔（按秒计算）。\nSQL:", "target": "SELECT user_id, AVG(EXTRACT(EPOCH FROM (timestamp - LAG(timestamp) OVER (PARTITION BY user_id ORDER BY timestamp)))) as avg_interval_seconds FROM interaction_logs GROUP BY user_id;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.62}, "extracted_prediction": "SELECT      user_id,     AVG(time_diff) AS avg_interval_seconds FROM (     SELECT          user_id,         EXTRACT(EPOCH FROM (timestamp - LAG(timestamp) OVER (PARTITION BY user_id ORDER BY timestamp))) AS time_diff     FROM interaction_logs ) subquery WHERE time_diff IS NOT NULL GROUP BY user_id", "prediction": "```sql\nSELECT \n    user_id,\n    AVG(time_diff) AS avg_interval_seconds\nFROM (\n    SELECT \n        user_id,\n        EXTRACT(EPOCH FROM (timestamp - LAG(timestamp) OVER (PARTITION BY user_id ORDER BY timestamp))) AS time_diff\n    FROM interaction_logs\n) subquery\nWHERE time_diff IS NOT NULL\nGROUP BY user_id;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 96, "group_id": 96, "sample_metadata": {}}}
{"index": 62, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE documents (doc_id INT, created_date DATE);\nQuestion: 查询文档的创建年份分布。\nSQL:", "target": "SELECT EXTRACT(YEAR FROM created_date) as year, COUNT(*) as doc_count FROM documents GROUP BY EXTRACT(YEAR FROM created_date) ORDER BY year;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.7636363636363637}, "extracted_prediction": "SELECT      EXTRACT(YEAR FROM created_date) AS year,     COUNT(*) AS document_count FROM documents WHERE created_date IS NOT NULL GROUP BY EXTRACT(YEAR FROM created_date) ORDER BY year", "prediction": "```sql\nSELECT \n    EXTRACT(YEAR FROM created_date) AS year,\n    COUNT(*) AS document_count\nFROM documents\nWHERE created_date IS NOT NULL\nGROUP BY EXTRACT(YEAR FROM created_date)\nORDER BY year;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 62, "group_id": 62, "sample_metadata": {}}}
{"index": 9, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE login_logs (user_id INT, login_time TIMESTAMP);\nQuestion: 查询每个用户的最后一次登录时间last_login。\nSQL:", "target": "SELECT user_id, MAX(login_time) as last_login FROM login_logs GROUP BY user_id;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT      user_id,     MAX(login_time) AS last_login FROM login_logs GROUP BY user_id", "prediction": "```sql\nSELECT \n    user_id,\n    MAX(login_time) AS last_login\nFROM login_logs\nGROUP BY user_id;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 9, "group_id": 9, "sample_metadata": {}}}
{"index": 73, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE documents (doc_id INT, title TEXT);\nQuestion: 查询文档标题以'报告'结尾的文档ID和标题。\nSQL:", "target": "SELECT doc_id, title FROM documents WHERE title LIKE '%报告';", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT doc_id, title FROM documents WHERE title LIKE '%报告'", "prediction": "```sql\nSELECT doc_id, title\nFROM documents\nWHERE title LIKE '%报告';\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 73, "group_id": 73, "sample_metadata": {}}}

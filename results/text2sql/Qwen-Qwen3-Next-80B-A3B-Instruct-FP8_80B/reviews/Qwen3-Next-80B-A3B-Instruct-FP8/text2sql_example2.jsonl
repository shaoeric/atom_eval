{"index": 76, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE interaction_logs (log_id INT, action TEXT);\nQuestion: 查询每个操作类型的次数。\nSQL:", "target": "SELECT action, COUNT(*) as action_count FROM interaction_logs GROUP BY action;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.9583333333333334}, "extracted_prediction": "SELECT action, COUNT(*) AS count FROM interaction_logs GROUP BY action", "prediction": "SELECT action, COUNT(*) AS count\nFROM interaction_logs\nGROUP BY action;", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 76, "group_id": 76, "sample_metadata": {}}}
{"index": 97, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE interaction_logs (log_id INT, session_id TEXT);\nQuestion: 查询日志表中会话ID为空的日志ID。\nSQL:", "target": "SELECT log_id FROM interaction_logs WHERE session_id IS NULL OR session_id = '';", "sample_score": {"score": {"value": {"sql_ast_sim": 0.8333333333333334}, "extracted_prediction": "SELECT log_id  FROM interaction_logs  WHERE session_id IS NULL", "prediction": "SELECT log_id \nFROM interaction_logs \nWHERE session_id IS NULL;", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 97, "group_id": 97, "sample_metadata": {}}}
{"index": 63, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE documents (doc_id INT, title TEXT, author TEXT, created_date DATE);\nQuestion: 查询作者为'张三'的所有文档标题和创建日期。\nSQL:", "target": "SELECT title, created_date FROM documents WHERE author = '张三';", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT title, created_date  FROM documents  WHERE author = '张三'", "prediction": "SELECT title, created_date \nFROM documents \nWHERE author = '张三';", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 63, "group_id": 63, "sample_metadata": {}}}
{"index": 64, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE documents (doc_id INT, modified_date DATE);\nQuestion: 查询每个文档的修改次数（基于修改日期是否多次）。\nSQL:", "target": "SELECT doc_id, COUNT(DISTINCT modified_date) as modification_count FROM documents GROUP BY doc_id;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.9}, "extracted_prediction": "SELECT doc_id, COUNT(*) AS modification_count FROM documents GROUP BY doc_id", "prediction": "根据问题“查询每个文档的修改次数（基于修改日期是否多次）”，我们需要统计每个文档（`doc_id`）在 `documents` 表中出现的次数，即每个 `doc_id` 对应的修改记录数（因为每次修改都会有一条记录，修改日期不同代表不同修改）。\n\n因此，SQL 查询应按 `doc_id` 分组，并统计每组的记录数。\n\n```sql\nSELECT doc_id, COUNT(*) AS modification_count\nFROM documents\nGROUP BY doc_id;\n```\n\n### 说明：\n- `COUNT(*)`：统计每个 `doc_id` 对应的记录总数，即修改次数。\n- `GROUP BY doc_id`：按文档 ID 分组，以便为每个文档计算修改次数。\n- 结果将返回每个文档及其对应的修改次数。\n\n> 注意：虽然字段名为 `modified_date`，但问题并未要求按日期去重或分析日期变化，而是“基于修改日期是否多次”——这实际上暗示每条记录代表一次修改，因此直接计数即可。", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 64, "group_id": 64, "sample_metadata": {}}}
{"index": 83, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE interaction_logs (log_id INT, duration INT);\nQuestion: 查询操作日志中持续时间超过10秒的操作ID（假设有duration列）。\nSQL:", "target": "SELECT log_id FROM interaction_logs WHERE duration > 10;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT log_id  FROM interaction_logs  WHERE duration > 10", "prediction": "SELECT log_id \nFROM interaction_logs \nWHERE duration > 10;", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 83, "group_id": 83, "sample_metadata": {}}}
{"index": 73, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE documents (doc_id INT, title TEXT);\nQuestion: 查询文档标题以'报告'结尾的文档ID和标题。\nSQL:", "target": "SELECT doc_id, title FROM documents WHERE title LIKE '%报告';", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT doc_id, title FROM documents WHERE title LIKE '%报告'", "prediction": "SELECT doc_id, title\nFROM documents\nWHERE title LIKE '%报告';", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 73, "group_id": 73, "sample_metadata": {}}}
{"index": 84, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE interaction_logs (log_id INT, action TEXT, duration INT);\nQuestion: 查询每个操作类型的平均持续时间。\nSQL:", "target": "SELECT action, AVG(duration) as avg_duration FROM interaction_logs GROUP BY action;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT action, AVG(duration) AS avg_duration FROM interaction_logs GROUP BY action", "prediction": "SELECT action, AVG(duration) AS avg_duration\nFROM interaction_logs\nGROUP BY action;", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 84, "group_id": 84, "sample_metadata": {}}}
{"index": 87, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE interaction_logs (log_id INT, user_id INT);\nQuestion: 查询操作频率最高的前10个用户ID和操作次数。\nSQL:", "target": "SELECT user_id, COUNT(*) as action_count FROM interaction_logs GROUP BY user_id ORDER BY action_count DESC LIMIT 10;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.8222222222222222}, "extracted_prediction": "SELECT user_id, COUNT(*) AS operation_count FROM interaction_logs GROUP BY user_id ORDER BY operation_count DESC LIMIT 10", "prediction": "SELECT user_id, COUNT(*) AS operation_count\nFROM interaction_logs\nGROUP BY user_id\nORDER BY operation_count DESC\nLIMIT 10;", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 87, "group_id": 87, "sample_metadata": {}}}
{"index": 55, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE documents (doc_id INT, author TEXT, views INT);\nQuestion: 查询每个作者的文档总浏览量。\nSQL:", "target": "SELECT author, SUM(views) as total_views FROM documents GROUP BY author;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT author, SUM(views) AS total_views FROM documents GROUP BY author", "prediction": "SELECT author, SUM(views) AS total_views\nFROM documents\nGROUP BY author;", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 55, "group_id": 55, "sample_metadata": {}}}
{"index": 77, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE interaction_logs (log_id INT, user_id INT);\nQuestion: 查询操作次数最多的用户ID和操作次数。\nSQL:", "target": "SELECT user_id, COUNT(*) as action_count FROM interaction_logs GROUP BY user_id ORDER BY action_count DESC LIMIT 1;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.8222222222222222}, "extracted_prediction": "SELECT user_id, COUNT(*) AS operation_count FROM interaction_logs GROUP BY user_id ORDER BY operation_count DESC LIMIT 1", "prediction": "SELECT user_id, COUNT(*) AS operation_count\nFROM interaction_logs\nGROUP BY user_id\nORDER BY operation_count DESC\nLIMIT 1;", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 77, "group_id": 77, "sample_metadata": {}}}
{"index": 37, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE orders (order_id INT, status TEXT, amount DECIMAL(10,2));\nQuestion: 查询每个订单状态的订单总金额。\nSQL:", "target": "SELECT status, SUM(amount) as total_amount FROM orders GROUP BY status;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT status, SUM(amount) AS total_amount FROM orders GROUP BY status", "prediction": "SELECT status, SUM(amount) AS total_amount\nFROM orders\nGROUP BY status;", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 37, "group_id": 37, "sample_metadata": {}}}
{"index": 67, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE documents (doc_id INT, category TEXT);\nQuestion: 查询文档表中没有类别的文档ID。\nSQL:", "target": "SELECT doc_id FROM documents WHERE category IS NULL OR category = '';", "sample_score": {"score": {"value": {"sql_ast_sim": 0.8333333333333334}, "extracted_prediction": "SELECT doc_id FROM documents WHERE category IS NULL", "prediction": "SELECT doc_id FROM documents WHERE category IS NULL;", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 67, "group_id": 67, "sample_metadata": {}}}
{"index": 91, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE interaction_logs (log_id INT, user_id INT, timestamp TIMESTAMP);\nQuestion: 查询每个用户的最后操作时间。\nSQL:", "target": "SELECT user_id, MAX(timestamp) as last_action_time FROM interaction_logs GROUP BY user_id;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT user_id, MAX(timestamp) AS last_action_time FROM interaction_logs GROUP BY user_id", "prediction": "SELECT user_id, MAX(timestamp) AS last_action_time\nFROM interaction_logs\nGROUP BY user_id;", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 91, "group_id": 91, "sample_metadata": {}}}
{"index": 86, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE interaction_logs (log_id INT, session_id TEXT, timestamp TIMESTAMP);\nQuestion: 查询每个会话的起始和结束时间（最小和最大时间戳）。\nSQL:", "target": "SELECT session_id, MIN(timestamp) as start_time, MAX(timestamp) as end_time FROM interaction_logs GROUP BY session_id;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT      session_id,      MIN(timestamp) AS start_time,      MAX(timestamp) AS end_time FROM      interaction_logs GROUP BY      session_id", "prediction": "SELECT \n    session_id, \n    MIN(timestamp) AS start_time, \n    MAX(timestamp) AS end_time\nFROM \n    interaction_logs\nGROUP BY \n    session_id;", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 86, "group_id": 86, "sample_metadata": {}}}
{"index": 1, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE user_sessions (user_id INT, username TEXT, age INT, last_login TIMESTAMP);\nQuestion: 查询年龄大于30且最后登录时间在2023年之后的用户ID和用户名。\nSQL:", "target": "SELECT user_id, username FROM user_sessions WHERE age > 30 AND last_login >= '2023-01-01';", "sample_score": {"score": {"value": {"sql_ast_sim": 0.9523809523809524}, "extracted_prediction": "SELECT user_id, username FROM user_sessions WHERE age > 30 AND last_login > '2023-12-31 23:59:59'", "prediction": "SELECT user_id, username\nFROM user_sessions\nWHERE age > 30 AND last_login > '2023-12-31 23:59:59';", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 1, "group_id": 1, "sample_metadata": {}}}
{"index": 42, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE orders (order_id INT, user_id INT, order_date DATE);\nQuestion: 查询订单表中重复的订单（基于用户ID和订单日期）。\nSQL:", "target": "SELECT user_id, order_date, COUNT(*) as duplicate_count FROM orders GROUP BY user_id, order_date HAVING COUNT(*) > 1;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT user_id, order_date, COUNT(*) AS duplicate_count FROM orders GROUP BY user_id, order_date HAVING COUNT(*) > 1", "prediction": "要查询订单表中基于 `user_id` 和 `order_date` 的重复订单，可以使用 `GROUP BY` 和 `HAVING` 子句来找出出现次数大于1的组合。\n\nSQL 查询如下：\n\n```sql\nSELECT user_id, order_date, COUNT(*) AS duplicate_count\nFROM orders\nGROUP BY user_id, order_date\nHAVING COUNT(*) > 1;\n```\n\n### 说明：\n- `GROUP BY user_id, order_date`：按用户ID和订单日期分组。\n- `COUNT(*)`：统计每个组合出现的次数。\n- `HAVING COUNT(*) > 1`：筛选出出现次数大于1的组合，即重复的订单。\n- 返回结果包括重复的 `user_id`、`order_date` 以及重复次数。\n\n如果你只想返回重复的记录（而不是聚合后的统计），可以使用子查询或窗口函数。以下是使用窗口函数返回所有重复原始记录的版本：\n\n```sql\nSELECT order_id, user_id, order_date\nFROM (\n    SELECT order_id, user_id, order_date,\n           COUNT(*) OVER (PARTITION BY user_id, order_date) AS cnt\n    FROM orders\n) t\nWHERE cnt > 1;\n```\n\n这个版本会返回**所有**重复的原始订单行（包括每个重复记录的 `order_id`），而不仅仅是分组统计。\n\n根据你的需求选择：\n- 如果只需要知道哪些组合重复 → 用第一个查询。\n- 如果需要看到所有重复的订单记录 → 用第二个查询。", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 42, "group_id": 42, "sample_metadata": {}}}
{"index": 57, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE documents (doc_id INT, title TEXT, category TEXT, modified_date DATE);\nQuestion: 查询每个类别的文档中，最新修改的文档标题。\nSQL:", "target": "SELECT category, title, modified_date FROM documents d1 WHERE modified_date = (SELECT MAX(modified_date) FROM documents d2 WHERE d2.category = d1.category);", "sample_score": {"score": {"value": {"sql_ast_sim": 0.203030303030303}, "extracted_prediction": "SELECT category, title, modified_date FROM (     SELECT category, title, modified_date,            ROW_NUMBER() OVER (PARTITION BY category ORDER BY modified_date DESC) AS rn     FROM documents ) ranked WHERE rn = 1", "prediction": "SELECT category, title, modified_date\nFROM (\n    SELECT category, title, modified_date,\n           ROW_NUMBER() OVER (PARTITION BY category ORDER BY modified_date DESC) AS rn\n    FROM documents\n) ranked\nWHERE rn = 1;", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 57, "group_id": 57, "sample_metadata": {}}}
{"index": 89, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE interaction_logs (log_id INT, user_id INT, action TEXT);\nQuestion: 查询每个操作类型的用户数量。\nSQL:", "target": "SELECT action, COUNT(DISTINCT user_id) as user_count FROM interaction_logs GROUP BY action;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.9629629629629629}, "extracted_prediction": "SELECT action, COUNT(user_id) AS user_count FROM interaction_logs GROUP BY action", "prediction": "SELECT action, COUNT(user_id) AS user_count\nFROM interaction_logs\nGROUP BY action;", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 89, "group_id": 89, "sample_metadata": {}}}
{"index": 98, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE interaction_logs (log_id INT, ip_country TEXT);\nQuestion: 查询操作日志的地理分布（基于IP地址的国家代码）。\nSQL:", "target": "SELECT ip_country, COUNT(*) as log_count FROM interaction_logs GROUP BY ip_country;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.71875}, "extracted_prediction": "SELECT ip_country, COUNT(*) AS count FROM interaction_logs GROUP BY ip_country ORDER BY ip_country", "prediction": "SELECT ip_country, COUNT(*) AS count\nFROM interaction_logs\nGROUP BY ip_country\nORDER BY ip_country;", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 98, "group_id": 98, "sample_metadata": {}}}
{"index": 92, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE interaction_logs (log_id INT, user_id INT, action TEXT, timestamp TIMESTAMP);\nQuestion: 查询操作链序列（连续操作相同action的用户）。\nSQL:", "target": "SELECT user_id, action, COUNT(*) as sequence_count FROM interaction_logs GROUP BY user_id, action HAVING COUNT(*) > 1;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.19642857142857142}, "extracted_prediction": "WITH ranked_logs AS (     SELECT          user_id,         action,         timestamp,         LAG(action) OVER (PARTITION BY user_id ORDER BY timestamp) AS prev_action     FROM interaction_logs ), grouped_chains AS (     SELECT          user_id,         action,         timestamp,         SUM(CASE WHEN action = prev_action THEN 0 ELSE 1 END)              OVER (PARTITION BY user_id ORDER BY timestamp) AS chain_group     FROM ranked_logs ) SELECT      user_id,     action,     COUNT(*) AS chain_length,     MIN(timestamp) AS chain_start,     MAX(timestamp) AS chain_end FROM grouped_chains GROUP BY user_id, action, chain_group ORDER BY user_id, chain_start", "prediction": "要查询“操作链序列（连续操作相同 action 的用户）”，我们需要找出每个用户在时间上连续发生的、**相同 action** 的操作序列。换句话说，我们要识别出用户在相邻时间戳上重复执行了相同操作的“连续块”。\n\n这通常可以通过 **窗口函数** 实现，特别是使用 `LAG()` 或 `LEAD()` 来比较当前行与前一行的 `action` 和 `user_id`，然后通过分组聚合来提取连续的“链”。\n\n### 思路：\n1. 使用 `LAG()` 获取每个用户上一条记录的 `action`。\n2. 如果当前行的 `action` 与上一行的 `action` 相同，且 `user_id` 相同，则属于同一“操作链”。\n3. 为每个“操作链”分配一个组号（通过累计不连续的标记）。\n4. 按 `user_id` 和组号分组，统计每个连续链的起止时间、操作类型、长度等。\n\n### SQL 查询（返回每个连续相同操作的链）：\n\n```sql\nWITH ranked_logs AS (\n    SELECT \n        user_id,\n        action,\n        timestamp,\n        LAG(action) OVER (PARTITION BY user_id ORDER BY timestamp) AS prev_action\n    FROM interaction_logs\n),\ngrouped_chains AS (\n    SELECT \n        user_id,\n        action,\n        timestamp,\n        SUM(CASE WHEN action = prev_action THEN 0 ELSE 1 END) \n            OVER (PARTITION BY user_id ORDER BY timestamp) AS chain_group\n    FROM ranked_logs\n)\nSELECT \n    user_id,\n    action,\n    COUNT(*) AS chain_length,\n    MIN(timestamp) AS chain_start,\n    MAX(timestamp) AS chain_end\nFROM grouped_chains\nGROUP BY user_id, action, chain_group\nORDER BY user_id, chain_start;\n```\n\n### 说明：\n- `ranked_logs`：计算每条记录的前一个 `action`。\n- `grouped_chains`：每当 `action` 与前一条不同时，`SUM(...)` 增加 1，从而为每个“连续相同 action 块”分配唯一组号 `chain_group`。\n- 最终查询：按 `user_id` 和 `chain_group` 分组，统计每个连续操作链的长度、起止时间。\n\n### 输出示例：\n| user_id | action | chain_length | chain_start         | chain_end           |\n|---------|--------|--------------|---------------------|---------------------|\n| 1       | login  | 3            | 2024-01-01 10:00:00 | 2024-01-01 10:02:00 |\n| 1       | click  | 1            | 2024-01-01 10:03:00 | 2024-01-01 10:03:00 |\n| 1       | login  | 2            | 2024-01-01 10:05:00 | 2024-01-01 10:06:00 |\n\n这表示用户1有三次连续登录，然后一次点击，再两次连续登录 —— 每个都是独立的“操作链”。\n\n> ✅ 此查询准确识别了“连续操作相同 action 的用户”形成的链序列。", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 92, "group_id": 92, "sample_metadata": {}}}
{"index": 78, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE interaction_logs (log_id INT, session_id TEXT);\nQuestion: 查询每个会话的日志数量。\nSQL:", "target": "SELECT session_id, COUNT(*) as log_count FROM interaction_logs GROUP BY session_id;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.9259259259259259}, "extracted_prediction": "SELECT session_id, COUNT(log_id) AS log_count FROM interaction_logs GROUP BY session_id", "prediction": "SELECT session_id, COUNT(log_id) AS log_count\nFROM interaction_logs\nGROUP BY session_id;", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 78, "group_id": 78, "sample_metadata": {}}}
{"index": 12, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE users (user_id INT, name TEXT, registration_date DATE);\nQuestion: 查询注册日期在周末（星期六或星期日）的用户姓名和注册日期。\nSQL:", "target": "SELECT name, registration_date FROM users WHERE EXTRACT(DOW FROM registration_date) IN (0, 6);", "sample_score": {"score": {"value": {"sql_ast_sim": 0.41798941798941797}, "extracted_prediction": "SELECT name, registration_date FROM users WHERE strftime('%w', registration_date) IN ('0', '6')", "prediction": "SELECT name, registration_date\nFROM users\nWHERE strftime('%w', registration_date) IN ('0', '6');", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 12, "group_id": 12, "sample_metadata": {}}}
{"index": 60, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE documents (doc_id INT, title TEXT);\nQuestion: 查询文档表中重复的标题及其出现次数。\nSQL:", "target": "SELECT title, COUNT(*) as occurrence FROM documents GROUP BY title HAVING COUNT(*) > 1;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.9444444444444444}, "extracted_prediction": "SELECT title, COUNT(*) AS occurrence_count FROM documents GROUP BY title HAVING COUNT(*) > 1", "prediction": "SELECT title, COUNT(*) AS occurrence_count\nFROM documents\nGROUP BY title\nHAVING COUNT(*) > 1;", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 60, "group_id": 60, "sample_metadata": {}}}
{"index": 20, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE users (user_id INT, name TEXT, age INT);\nQuestion: 查询年龄大于所有用户平均年龄的用户姓名和年龄。\nSQL:", "target": "SELECT name, age FROM users WHERE age > (SELECT AVG(age) FROM users);", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT name, age FROM users WHERE age > (SELECT AVG(age) FROM users)", "prediction": "SELECT name, age\nFROM users\nWHERE age > (SELECT AVG(age) FROM users);", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 20, "group_id": 20, "sample_metadata": {}}}
{"index": 49, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE documents (doc_id INT, author TEXT);\nQuestion: 查询每个作者创建的文档数量。\nSQL:", "target": "SELECT author, COUNT(*) as doc_count FROM documents GROUP BY author;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.8666666666666667}, "extracted_prediction": "SELECT author, COUNT(doc_id) AS document_count FROM documents GROUP BY author", "prediction": "SELECT author, COUNT(doc_id) AS document_count\nFROM documents\nGROUP BY author;", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 49, "group_id": 49, "sample_metadata": {}}}
{"index": 13, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE users (user_id INT, age INT);\nQuestion: 查询每个年龄的用户数量user_count，并只显示数量大于5的年龄。\nSQL:", "target": "SELECT age, COUNT(*) as user_count FROM users GROUP BY age HAVING COUNT(*) > 5;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT age, COUNT(*) AS user_count FROM users GROUP BY age HAVING COUNT(*) > 5", "prediction": "SELECT age, COUNT(*) AS user_count\nFROM users\nGROUP BY age\nHAVING COUNT(*) > 5;", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 13, "group_id": 13, "sample_metadata": {}}}
{"index": 52, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE documents (doc_id INT, title TEXT);\nQuestion: 查询标题包含'设计'的文档ID和标题。\nSQL:", "target": "SELECT doc_id, title FROM documents WHERE title LIKE '%设计%';", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT doc_id, title FROM documents WHERE title LIKE '%设计%'", "prediction": "SELECT doc_id, title\nFROM documents\nWHERE title LIKE '%设计%';", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 52, "group_id": 52, "sample_metadata": {}}}
{"index": 96, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE interaction_logs (log_id INT, user_id INT, timestamp TIMESTAMP);\nQuestion: 查询每个用户的平均操作间隔（按秒计算）。\nSQL:", "target": "SELECT user_id, AVG(EXTRACT(EPOCH FROM (timestamp - LAG(timestamp) OVER (PARTITION BY user_id ORDER BY timestamp)))) as avg_interval_seconds FROM interaction_logs GROUP BY user_id;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.4815384615384615}, "extracted_prediction": "SELECT      user_id,     AVG(EXTRACT(EPOCH FROM (timestamp - prev_timestamp))) AS avg_interval_seconds FROM (     SELECT          user_id,         timestamp,         LAG(timestamp) OVER (PARTITION BY user_id ORDER BY timestamp) AS prev_timestamp     FROM interaction_logs ) AS timed_diffs WHERE prev_timestamp IS NOT NULL GROUP BY user_id", "prediction": "要计算每个用户的平均操作间隔（按秒计算），我们需要：\n\n1. 对每个用户（`user_id`）按时间戳（`timestamp`）排序；\n2. 计算相邻两次操作之间的时间差（以秒为单位）；\n3. 对每个用户的所有时间差求平均值。\n\n由于 SQL 本身不支持直接“计算相邻行差值”，我们需要使用窗口函数 `LAG()` 来获取前一次操作的时间戳，然后计算差值。\n\n以下是符合要求的 SQL 查询：\n\n```sql\nSELECT \n    user_id,\n    AVG(EXTRACT(EPOCH FROM (timestamp - prev_timestamp))) AS avg_interval_seconds\nFROM (\n    SELECT \n        user_id,\n        timestamp,\n        LAG(timestamp) OVER (PARTITION BY user_id ORDER BY timestamp) AS prev_timestamp\n    FROM interaction_logs\n) AS timed_diffs\nWHERE prev_timestamp IS NOT NULL\nGROUP BY user_id;\n```\n\n### 说明：\n- `LAG(timestamp) OVER (PARTITION BY user_id ORDER BY timestamp)`：获取每个用户按时间排序的前一条记录的时间戳。\n- `EXTRACT(EPOCH FROM (timestamp - prev_timestamp))`：计算两个时间戳之间的秒数差（PostgreSQL 语法，`EPOCH` 将时间差转为秒）。\n- `WHERE prev_timestamp IS NOT NULL`：排除第一条记录（没有前一条记录，无法计算间隔）。\n- `GROUP BY user_id`：按用户分组，计算每个用户的平均间隔。\n\n> ⚠️ 注意：如果使用的是其他数据库（如 MySQL、SQL Server），`EXTRACT(EPOCH FROM ...)` 的语法可能不同。例如：\n> - **MySQL**：使用 `TIMESTAMPDIFF(SECOND, prev_timestamp, timestamp)`\n> - **SQL Server**：使用 `DATEDIFF(SECOND, prev_timestamp, timestamp)`\n\n### 如果是 MySQL 版本：\n```sql\nSELECT \n    user_id,\n    AVG(TIMESTAMPDIFF(SECOND, prev_timestamp, timestamp)) AS avg_interval_seconds\nFROM (\n    SELECT \n        user_id,\n        timestamp,\n        LAG(timestamp) OVER (PARTITION BY user_id ORDER BY timestamp) AS prev_timestamp\n    FROM interaction_logs\n) AS timed_diffs\nWHERE prev_timestamp IS NOT NULL\nGROUP BY user_id;\n```\n\n请根据你使用的数据库系统选择合适的语法。上述查询基于 **PostgreSQL**，是最常见的标准实现。", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 96, "group_id": 96, "sample_metadata": {}}}
{"index": 53, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE documents (doc_id INT, project_id INT);\nQuestion: 查询每个项目的文档数量。\nSQL:", "target": "SELECT project_id, COUNT(*) as doc_count FROM documents GROUP BY project_id;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.8666666666666667}, "extracted_prediction": "SELECT project_id, COUNT(doc_id) AS document_count FROM documents GROUP BY project_id", "prediction": "SELECT project_id, COUNT(doc_id) AS document_count\nFROM documents\nGROUP BY project_id;", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 53, "group_id": 53, "sample_metadata": {}}}
{"index": 68, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE documents (doc_id INT, author TEXT, title TEXT, version INT);\nQuestion: 查询每个作者的文档中，版本号最高的文档标题。\nSQL:", "target": "SELECT author, title, version FROM documents d1 WHERE version = (SELECT MAX(version) FROM documents d2 WHERE d2.author = d1.author);", "sample_score": {"score": {"value": {"sql_ast_sim": 0.203030303030303}, "extracted_prediction": "SELECT author, title FROM (     SELECT author, title, version,            ROW_NUMBER() OVER (PARTITION BY author ORDER BY version DESC) AS rn     FROM documents ) ranked WHERE rn = 1", "prediction": "要查询每个作者的文档中版本号最高的文档标题，可以使用窗口函数 `ROW_NUMBER()` 或 `RANK()` 按作者分组，按版本号降序排序，然后取每组的第一条记录。\n\n以下是符合要求的 SQL 查询：\n\n```sql\nSELECT author, title\nFROM (\n    SELECT author, title, version,\n           ROW_NUMBER() OVER (PARTITION BY author ORDER BY version DESC) AS rn\n    FROM documents\n) ranked\nWHERE rn = 1;\n```\n\n### 说明：\n- `PARTITION BY author`：按作者分组。\n- `ORDER BY version DESC`：在每组内按版本号降序排列，最高版本排第一。\n- `ROW_NUMBER()`：为每组内的行分配唯一序号，确保即使有多个相同最高版本，也只取一个（按数据库内部顺序）。\n- 外层查询 `WHERE rn = 1`：只保留每组版本最高的那一条记录。\n\n> 如果允许一个作者有多个相同最高版本的文档，并希望全部返回，可以将 `ROW_NUMBER()` 替换为 `RANK()`。\n\n但根据题意“版本号最高的文档标题”，通常默认取一个，所以使用 `ROW_NUMBER()` 更合适。", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 68, "group_id": 68, "sample_metadata": {}}}
{"index": 94, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE interaction_logs (log_id INT, action TEXT, duration INT);\nQuestion: 查询每个操作类型的总持续时间。\nSQL:", "target": "SELECT action, SUM(duration) as total_duration FROM interaction_logs GROUP BY action;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT action, SUM(duration) AS total_duration FROM interaction_logs GROUP BY action", "prediction": "SELECT action, SUM(duration) AS total_duration\nFROM interaction_logs\nGROUP BY action;", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 94, "group_id": 94, "sample_metadata": {}}}
{"index": 41, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE orders (order_id INT, payment_method TEXT, amount DECIMAL(10,2));\nQuestion: 查询每个支付方式的总金额。\nSQL:", "target": "SELECT payment_method, SUM(amount) as total_amount FROM orders GROUP BY payment_method;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT payment_method, SUM(amount) AS total_amount FROM orders GROUP BY payment_method", "prediction": "SELECT payment_method, SUM(amount) AS total_amount\nFROM orders\nGROUP BY payment_method;", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 41, "group_id": 41, "sample_metadata": {}}}
{"index": 15, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE users (user_id INT, name TEXT, email TEXT);\nQuestion: 查询邮箱地址以'gmail.com'结尾的用户姓名和邮箱。\nSQL:", "target": "SELECT name, email FROM users WHERE email LIKE '%gmail.com';", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT name, email FROM users WHERE email LIKE '%@gmail.com'", "prediction": "SELECT name, email\nFROM users\nWHERE email LIKE '%@gmail.com';", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 15, "group_id": 15, "sample_metadata": {}}}
{"index": 22, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE users (user_id INT, country TEXT, registration_date DATE);\nQuestion: 查询每个国家的用户注册趋势，按年份统计数量。\nSQL:", "target": "SELECT country, EXTRACT(YEAR FROM registration_date) as year, COUNT(*) as user_count FROM users GROUP BY country, EXTRACT(YEAR FROM registration_date) ORDER BY country, year;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.43525641025641026}, "extracted_prediction": "SELECT      country,      strftime('%Y', registration_date) AS year,      COUNT(*) AS registration_count FROM      users GROUP BY      country,      strftime('%Y', registration_date) ORDER BY      country,      year", "prediction": "SELECT \n    country, \n    strftime('%Y', registration_date) AS year, \n    COUNT(*) AS registration_count\nFROM \n    users\nGROUP BY \n    country, \n    strftime('%Y', registration_date)\nORDER BY \n    country, \n    year;", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 22, "group_id": 22, "sample_metadata": {}}}
{"index": 50, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE documents (doc_id INT, title TEXT, modified_date DATE);\nQuestion: 查询最近一个月内修改过的文档标题和修改日期。\nSQL:", "target": "SELECT title, modified_date FROM documents WHERE modified_date >= CURRENT_DATE - INTERVAL '1 month';", "sample_score": {"score": {"value": {"sql_ast_sim": 0.7777777777777778}, "extracted_prediction": "SELECT title, modified_date FROM documents WHERE modified_date >= DATE('now', '-1 month')", "prediction": "SELECT title, modified_date\nFROM documents\nWHERE modified_date >= DATE('now', '-1 month');", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 50, "group_id": 50, "sample_metadata": {}}}
{"index": 54, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE documents (doc_id INT, title TEXT, created_date DATE);\nQuestion: 查询创建日期在2023年的文档标题和创建日期。\nSQL:", "target": "SELECT title, created_date FROM documents WHERE EXTRACT(YEAR FROM created_date) = 2023;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.39999999999999997}, "extracted_prediction": "SELECT title, created_date FROM documents WHERE created_date >= '2023-01-01' AND created_date <= '2023-12-31'", "prediction": "SELECT title, created_date\nFROM documents\nWHERE created_date >= '2023-01-01' AND created_date <= '2023-12-31';", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 54, "group_id": 54, "sample_metadata": {}}}
{"index": 17, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE users (user_id INT, username TEXT);\nQuestion: 查询用户表中重复的用户名及其出现次数。\nSQL:", "target": "SELECT username, COUNT(*) as occurrence FROM users GROUP BY username HAVING COUNT(*) > 1;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.9444444444444444}, "extracted_prediction": "SELECT username, COUNT(*) AS occurrence_count FROM users GROUP BY username HAVING COUNT(*) > 1", "prediction": "SELECT username, COUNT(*) AS occurrence_count\nFROM users\nGROUP BY username\nHAVING COUNT(*) > 1;", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 17, "group_id": 17, "sample_metadata": {}}}
{"index": 80, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE interaction_logs (log_id INT, timestamp TIMESTAMP);\nQuestion: 查询每个小时的操作频率（基于时间戳）。\nSQL:", "target": "SELECT EXTRACT(HOUR FROM timestamp) as hour, COUNT(*) as action_count FROM interaction_logs GROUP BY EXTRACT(HOUR FROM timestamp) ORDER BY hour;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.34791666666666665}, "extracted_prediction": "SELECT      DATE_TRUNC('hour', timestamp) AS hour,     COUNT(*) AS operation_count FROM      interaction_logs GROUP BY      DATE_TRUNC('hour', timestamp) ORDER BY      hour", "prediction": "SELECT \n    DATE_TRUNC('hour', timestamp) AS hour,\n    COUNT(*) AS operation_count\nFROM \n    interaction_logs\nGROUP BY \n    DATE_TRUNC('hour', timestamp)\nORDER BY \n    hour;", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 80, "group_id": 80, "sample_metadata": {}}}
{"index": 70, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE documents (doc_id INT, category TEXT, created_date DATE);\nQuestion: 查询每个类别的平均文档年龄（从创建日期到当前日期的天数）。\nSQL:", "target": "SELECT category, AVG(CURRENT_DATE - created_date) as avg_age_days FROM documents GROUP BY category;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.8611111111111112}, "extracted_prediction": "SELECT      category,      AVG(JULIANDAY('now') - JULIANDAY(created_date)) AS avg_age_in_days FROM      documents GROUP BY      category", "prediction": "SELECT \n    category, \n    AVG(JULIANDAY('now') - JULIANDAY(created_date)) AS avg_age_in_days\nFROM \n    documents\nGROUP BY \n    category;", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 70, "group_id": 70, "sample_metadata": {}}}
{"index": 8, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE users (user_id INT, username TEXT);\nQuestion: 查询用户名中包含'admin'的用户ID和用户名。\nSQL:", "target": "SELECT user_id, username FROM users WHERE username LIKE '%admin%';", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT user_id, username FROM users WHERE username LIKE '%admin%'", "prediction": "SELECT user_id, username\nFROM users\nWHERE username LIKE '%admin%';", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 8, "group_id": 8, "sample_metadata": {}}}
{"index": 65, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE documents (doc_id INT, created_date DATE, modified_date DATE);\nQuestion: 查询创建日期和修改日期相同的文档ID。\nSQL:", "target": "SELECT doc_id FROM documents WHERE created_date = modified_date;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT doc_id FROM documents WHERE created_date = modified_date", "prediction": "SELECT doc_id\nFROM documents\nWHERE created_date = modified_date;", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 65, "group_id": 65, "sample_metadata": {}}}
{"index": 95, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE interaction_logs (log_id INT, action TEXT);\nQuestion: 查询用户交互日志中的页面浏览量（action为'view'）的总数。\nSQL:", "target": "SELECT COUNT(*) as view_count FROM interaction_logs WHERE action = 'view';", "sample_score": {"score": {"value": {"sql_ast_sim": 0.9047619047619048}, "extracted_prediction": "SELECT COUNT(*) AS total_page_views FROM interaction_logs WHERE action = 'view'", "prediction": "SELECT COUNT(*) AS total_page_views\nFROM interaction_logs\nWHERE action = 'view';", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 95, "group_id": 95, "sample_metadata": {}}}
{"index": 10, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE users (user_id INT, name TEXT, age INT, registration_date DATE);\nQuestion: 查询年龄在20到40之间的用户，并按注册日期升序排列。\nSQL:", "target": "SELECT * FROM users WHERE age BETWEEN 20 AND 40 ORDER BY registration_date ASC;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT *  FROM users  WHERE age BETWEEN 20 AND 40  ORDER BY registration_date ASC", "prediction": "SELECT * \nFROM users \nWHERE age BETWEEN 20 AND 40 \nORDER BY registration_date ASC;", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 10, "group_id": 10, "sample_metadata": {}}}
{"index": 85, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE interaction_logs (log_id INT, user_id INT);\nQuestion: 查询日志表中用户ID为NULL的日志ID。\nSQL:", "target": "SELECT log_id FROM interaction_logs WHERE user_id IS NULL;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT log_id  FROM interaction_logs  WHERE user_id IS NULL", "prediction": "SELECT log_id \nFROM interaction_logs \nWHERE user_id IS NULL;", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 85, "group_id": 85, "sample_metadata": {}}}
{"index": 90, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE interaction_logs (log_id INT, timestamp TIMESTAMP);\nQuestion: 查询日志表中时间戳在夜间（22:00到06:00）的日志ID和时间戳。\nSQL:", "target": "SELECT log_id, timestamp FROM interaction_logs WHERE EXTRACT(HOUR FROM timestamp) >= 22 OR EXTRACT(HOUR FROM timestamp) < 6;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT log_id, timestamp FROM interaction_logs WHERE EXTRACT(HOUR FROM timestamp) >= 22    OR EXTRACT(HOUR FROM timestamp) < 6", "prediction": "SELECT log_id, timestamp\nFROM interaction_logs\nWHERE EXTRACT(HOUR FROM timestamp) >= 22\n   OR EXTRACT(HOUR FROM timestamp) < 6;", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 90, "group_id": 90, "sample_metadata": {}}}
{"index": 26, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE orders (order_id INT, user_id INT, amount DECIMAL(10,2));\nQuestion: 查询每个用户的订单总数和总金额。\nSQL:", "target": "SELECT user_id, COUNT(*) as order_count, SUM(amount) as total_amount FROM orders GROUP BY user_id;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.9444444444444445}, "extracted_prediction": "SELECT      user_id,      COUNT(order_id) AS order_count,      SUM(amount) AS total_amount FROM      orders GROUP BY      user_id", "prediction": "SELECT \n    user_id, \n    COUNT(order_id) AS order_count, \n    SUM(amount) AS total_amount\nFROM \n    orders\nGROUP BY \n    user_id;", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 26, "group_id": 26, "sample_metadata": {}}}
{"index": 7, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE users (user_id INT, country TEXT, is_active BOOLEAN);\nQuestion: 查询每个国家活跃用户（is_active为true）的数量active_users。\nSQL:", "target": "SELECT country, COUNT(*) as active_users FROM users WHERE is_active = TRUE GROUP BY country;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT country, COUNT(*) AS active_users FROM users WHERE is_active = TRUE GROUP BY country", "prediction": "SELECT country, COUNT(*) AS active_users\nFROM users\nWHERE is_active = TRUE\nGROUP BY country;", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 7, "group_id": 7, "sample_metadata": {}}}
{"index": 46, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE orders (order_id INT, amount DECIMAL(10,2));\nQuestion: 查询订单金额的分布，按金额范围分组（例如0-100, 101-500等）。\nSQL:", "target": "SELECT CASE WHEN amount <= 100 THEN '0-100' WHEN amount <= 500 THEN '101-500' ELSE '500+' END as amount_range, COUNT(*) as order_count FROM orders GROUP BY CASE WHEN amount <= 100 THEN '0-100' WHEN amount <= 500 THEN '101-500' ELSE '500+' END;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.6166666666666667}, "extracted_prediction": "SELECT      CASE          WHEN amount BETWEEN 0 AND 100 THEN '0-100'         WHEN amount BETWEEN 101 AND 500 THEN '101-500'         WHEN amount BETWEEN 501 AND 1000 THEN '501-1000'         WHEN amount > 1000 THEN '1000+'         ELSE '0'     END AS amount_range,     COUNT(*) AS order_count FROM orders GROUP BY      CASE          WHEN amount BETWEEN 0 AND 100 THEN '0-100'         WHEN amount BETWEEN 101 AND 500 THEN '101-500'         WHEN amount BETWEEN 501 AND 1000 THEN '501-1000'         WHEN amount > 1000 THEN '1000+'         ELSE '0'     END ORDER BY amount_range", "prediction": "SELECT \n    CASE \n        WHEN amount BETWEEN 0 AND 100 THEN '0-100'\n        WHEN amount BETWEEN 101 AND 500 THEN '101-500'\n        WHEN amount BETWEEN 501 AND 1000 THEN '501-1000'\n        WHEN amount > 1000 THEN '1000+'\n        ELSE '0'\n    END AS amount_range,\n    COUNT(*) AS order_count\nFROM orders\nGROUP BY \n    CASE \n        WHEN amount BETWEEN 0 AND 100 THEN '0-100'\n        WHEN amount BETWEEN 101 AND 500 THEN '101-500'\n        WHEN amount BETWEEN 501 AND 1000 THEN '501-1000'\n        WHEN amount > 1000 THEN '1000+'\n        ELSE '0'\n    END\nORDER BY amount_range;", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 46, "group_id": 46, "sample_metadata": {}}}
{"index": 56, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE documents (doc_id INT, version INT);\nQuestion: 查询版本号大于5的文档ID和版本号。\nSQL:", "target": "SELECT doc_id, version FROM documents WHERE version > 5;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT doc_id, version FROM documents WHERE version > 5", "prediction": "SELECT doc_id, version\nFROM documents\nWHERE version > 5;", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 56, "group_id": 56, "sample_metadata": {}}}
{"index": 39, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE orders (order_id INT, user_id INT, order_date DATE);\nQuestion: 查询每个用户的第一次订单日期。\nSQL:", "target": "SELECT user_id, MIN(order_date) as first_order_date FROM orders GROUP BY user_id;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT user_id, MIN(order_date) AS first_order_date FROM orders GROUP BY user_id", "prediction": "SELECT user_id, MIN(order_date) AS first_order_date\nFROM orders\nGROUP BY user_id;", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 39, "group_id": 39, "sample_metadata": {}}}
{"index": 51, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE documents (doc_id INT, category TEXT, version INT);\nQuestion: 查询每个类别的文档平均版本号。\nSQL:", "target": "SELECT category, AVG(version) as avg_version FROM documents GROUP BY category;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT category, AVG(version) AS avg_version FROM documents GROUP BY category", "prediction": "SELECT category, AVG(version) AS avg_version\nFROM documents\nGROUP BY category;", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 51, "group_id": 51, "sample_metadata": {}}}
{"index": 40, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE orders (order_id INT, amount DECIMAL(10,2));\nQuestion: 查询订单金额在500到1000之间的订单ID和金额。\nSQL:", "target": "SELECT order_id, amount FROM orders WHERE amount BETWEEN 500 AND 1000;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT order_id, amount FROM orders WHERE amount BETWEEN 500 AND 1000", "prediction": "SELECT order_id, amount\nFROM orders\nWHERE amount BETWEEN 500 AND 1000;", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 40, "group_id": 40, "sample_metadata": {}}}
{"index": 21, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE users (user_id INT, username TEXT);\nQuestion: 查询用户名长度超过10个字符的用户姓名。\nSQL:", "target": "SELECT username FROM users WHERE LENGTH(username) > 10;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT username FROM users WHERE LENGTH(username) > 10", "prediction": "SELECT username FROM users WHERE LENGTH(username) > 10;", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 21, "group_id": 21, "sample_metadata": {}}}
{"index": 27, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE orders (order_id INT, amount DECIMAL(10,2));\nQuestion: 查询订单金额最高的前10个订单的订单ID和金额。\nSQL:", "target": "SELECT order_id, amount FROM orders ORDER BY amount DESC LIMIT 10;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT order_id, amount FROM orders ORDER BY amount DESC LIMIT 10", "prediction": "SELECT order_id, amount\nFROM orders\nORDER BY amount DESC\nLIMIT 10;", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 27, "group_id": 27, "sample_metadata": {}}}
{"index": 36, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE orders (order_id INT, amount DECIMAL(10,2));\nQuestion: 查询订单金额最低的5个订单的订单ID和金额。\nSQL:", "target": "SELECT order_id, amount FROM orders ORDER BY amount ASC LIMIT 5;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT order_id, amount FROM orders ORDER BY amount ASC LIMIT 5", "prediction": "SELECT order_id, amount\nFROM orders\nORDER BY amount ASC\nLIMIT 5;", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 36, "group_id": 36, "sample_metadata": {}}}
{"index": 61, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE documents (doc_id INT, category TEXT);\nQuestion: 查询每个类别的文档数量，并只显示数量大于10的类别。\nSQL:", "target": "SELECT category, COUNT(*) as doc_count FROM documents GROUP BY category HAVING COUNT(*) > 10;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.9444444444444444}, "extracted_prediction": "SELECT category, COUNT(*) AS document_count FROM documents GROUP BY category HAVING COUNT(*) > 10", "prediction": "SELECT category, COUNT(*) AS document_count\nFROM documents\nGROUP BY category\nHAVING COUNT(*) > 10;", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 61, "group_id": 61, "sample_metadata": {}}}
{"index": 35, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE orders (order_id INT, user_id INT, amount DECIMAL(10,2));\nQuestion: 查询用户ID为1001的所有订单ID和金额。\nSQL:", "target": "SELECT order_id, amount FROM orders WHERE user_id = 1001;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT order_id, amount FROM orders WHERE user_id = 1001", "prediction": "SELECT order_id, amount\nFROM orders\nWHERE user_id = 1001;", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 35, "group_id": 35, "sample_metadata": {}}}
{"index": 45, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE orders (order_id INT, product_id INT);\nQuestion: 查询每个产品ID的订单数量。\nSQL:", "target": "SELECT product_id, COUNT(*) as order_count FROM orders GROUP BY product_id;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT product_id, COUNT(*) AS order_count FROM orders GROUP BY product_id", "prediction": "SELECT product_id, COUNT(*) AS order_count\nFROM orders\nGROUP BY product_id;", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 45, "group_id": 45, "sample_metadata": {}}}
{"index": 11, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE users (user_id INT, country TEXT);\nQuestion: 查询每个国家的用户数量user_count，并计算占所有国家总用户数的百分比percentage。\nSQL:", "target": "SELECT country, COUNT(*) as user_count, (COUNT(*) * 100.0 / (SELECT COUNT(*) FROM users)) as percentage FROM users GROUP BY country;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.6416666666666666}, "extracted_prediction": "SELECT      country,     COUNT(*) AS user_count,     ROUND(         COUNT(*) * 100.0 / (SELECT COUNT(*) FROM users),          2     ) AS percentage FROM      users GROUP BY      country ORDER BY      country", "prediction": "SELECT \n    country,\n    COUNT(*) AS user_count,\n    ROUND(\n        COUNT(*) * 100.0 / (SELECT COUNT(*) FROM users), \n        2\n    ) AS percentage\nFROM \n    users\nGROUP BY \n    country\nORDER BY \n    country;", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 11, "group_id": 11, "sample_metadata": {}}}
{"index": 9, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE login_logs (user_id INT, login_time TIMESTAMP);\nQuestion: 查询每个用户的最后一次登录时间last_login。\nSQL:", "target": "SELECT user_id, MAX(login_time) as last_login FROM login_logs GROUP BY user_id;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT user_id, MAX(login_time) AS last_login FROM login_logs GROUP BY user_id", "prediction": "SELECT user_id, MAX(login_time) AS last_login\nFROM login_logs\nGROUP BY user_id;", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 9, "group_id": 9, "sample_metadata": {}}}
{"index": 32, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE orders (order_id INT, order_date DATE);\nQuestion: 查询最近一周内的订单ID和订单日期。\nSQL:", "target": "SELECT order_id, order_date FROM orders WHERE order_date >= CURRENT_DATE - INTERVAL '7 days';", "sample_score": {"score": {"value": {"sql_ast_sim": 0.75}, "extracted_prediction": "SELECT order_id, order_date FROM orders WHERE order_date >= DATE_SUB(CURDATE(), INTERVAL 7 DAY)", "prediction": "SELECT order_id, order_date\nFROM orders\nWHERE order_date >= DATE_SUB(CURDATE(), INTERVAL 7 DAY);", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 32, "group_id": 32, "sample_metadata": {}}}
{"index": 5, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE users (user_id INT, name TEXT, age INT);\nQuestion: 查询年龄小于18或大于60的用户姓名和年龄，并按年龄排序。\nSQL:", "target": "SELECT name, age FROM users WHERE age < 18 OR age > 60 ORDER BY age;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT name, age FROM users WHERE age < 18 OR age > 60 ORDER BY age", "prediction": "SELECT name, age\nFROM users\nWHERE age < 18 OR age > 60\nORDER BY age;", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 5, "group_id": 5, "sample_metadata": {}}}
{"index": 43, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE orders (order_id INT, user_id INT, order_date DATE);\nQuestion: 查询每个用户的订单频率（平均每天订单数）。\nSQL:", "target": "SELECT user_id, COUNT(*) / COUNT(DISTINCT order_date) as avg_orders_per_day FROM orders GROUP BY user_id;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.8809523809523809}, "extracted_prediction": "SELECT      user_id,     COUNT(order_id) * 1.0 / (MAX(order_date) - MIN(order_date) + 1) AS avg_orders_per_day FROM      orders GROUP BY      user_id", "prediction": "要计算每个用户的“订单频率（平均每天订单数）”，我们需要：\n\n1. 统计每个用户 (`user_id`) 的总订单数。\n2. 计算每个用户订单覆盖的天数（即从最早订单日期到最晚订单日期的天数差 + 1）。\n3. 用总订单数除以天数，得到“平均每天订单数”。\n\n注意：题目中的“平均每天订单数”应理解为 **用户活跃期间的平均每日订单数**，而不是整个日历上的平均。\n\n### SQL 查询如下：\n\n```sql\nSELECT \n    user_id,\n    COUNT(order_id) * 1.0 / (MAX(order_date) - MIN(order_date) + 1) AS avg_orders_per_day\nFROM \n    orders\nGROUP BY \n    user_id;\n```\n\n### 说明：\n- `COUNT(order_id)`：每个用户的总订单数。\n- `MAX(order_date) - MIN(order_date)`：计算用户订单跨度的天数差（日期相减返回整数天数）。\n- `+ 1`：包含起始和结束日，例如从 2024-01-01 到 2024-01-03 是 3 天（3-1+1）。\n- `* 1.0`：确保除法是浮点除法，避免整数除法截断。\n\n> ✅ 此查询返回每个用户的平均每天订单数（基于其订单活跃期间）。\n\n### 注意：\n如果某个用户只有一笔订单，那么 `MAX - MIN + 1 = 1`，结果就是 1.0，符合预期。", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 43, "group_id": 43, "sample_metadata": {}}}
{"index": 18, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE users (user_id INT, registration_date DATE, last_login_date DATE);\nQuestion: 查询注册日期和最后登录日期相同的用户ID和日期。\nSQL:", "target": "SELECT user_id, registration_date FROM users WHERE registration_date = last_login_date;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT user_id, registration_date FROM users WHERE registration_date = last_login_date", "prediction": "SELECT user_id, registration_date\nFROM users\nWHERE registration_date = last_login_date;", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 18, "group_id": 18, "sample_metadata": {}}}
{"index": 72, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE documents (doc_id INT, project_id INT, views INT);\nQuestion: 查询每个项目的文档总浏览量。\nSQL:", "target": "SELECT project_id, SUM(views) as total_views FROM documents GROUP BY project_id;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT project_id, SUM(views) AS total_views FROM documents GROUP BY project_id", "prediction": "SELECT project_id, SUM(views) AS total_views\nFROM documents\nGROUP BY project_id;", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 72, "group_id": 72, "sample_metadata": {}}}
{"index": 81, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE interaction_logs (log_id INT, user_id INT, action TEXT);\nQuestion: 查询用户交互日志中的错误操作（action为'error'）的日志ID和用户ID。\nSQL:", "target": "SELECT log_id, user_id FROM interaction_logs WHERE action = 'error';", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT log_id, user_id FROM interaction_logs WHERE action = 'error'", "prediction": "SELECT log_id, user_id\nFROM interaction_logs\nWHERE action = 'error';", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 81, "group_id": 81, "sample_metadata": {}}}
{"index": 34, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE orders (order_id INT, order_date DATE);\nQuestion: 查询2023年每个月的订单数量变化。\nSQL:", "target": "SELECT EXTRACT(MONTH FROM order_date) as month, COUNT(*) as order_count FROM orders WHERE EXTRACT(YEAR FROM order_date) = 2023 GROUP BY EXTRACT(MONTH FROM order_date) ORDER BY month;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.39380952380952383}, "extracted_prediction": "SELECT      MONTH(order_date) AS month,     COUNT(order_id) AS order_count FROM      orders WHERE      YEAR(order_date) = 2023 GROUP BY      MONTH(order_date) ORDER BY      month", "prediction": "SELECT \n    MONTH(order_date) AS month,\n    COUNT(order_id) AS order_count\nFROM \n    orders\nWHERE \n    YEAR(order_date) = 2023\nGROUP BY \n    MONTH(order_date)\nORDER BY \n    month;", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 34, "group_id": 34, "sample_metadata": {}}}
{"index": 69, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE documents (doc_id INT, title TEXT, views INT);\nQuestion: 查询文档的浏览量排名前10的文档标题和浏览量。\nSQL:", "target": "SELECT title, views FROM documents ORDER BY views DESC LIMIT 10;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT title, views FROM documents ORDER BY views DESC LIMIT 10", "prediction": "SELECT title, views\nFROM documents\nORDER BY views DESC\nLIMIT 10;", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 69, "group_id": 69, "sample_metadata": {}}}
{"index": 79, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE interaction_logs (log_id INT, ip_address TEXT, timestamp TIMESTAMP);\nQuestion: 查询来自特定IP地址'192.168.1.1'的日志ID和时间戳。\nSQL:", "target": "SELECT log_id, timestamp FROM interaction_logs WHERE ip_address = '192.168.1.1';", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT log_id, timestamp FROM interaction_logs WHERE ip_address = '192.168.1.1'", "prediction": "SELECT log_id, timestamp\nFROM interaction_logs\nWHERE ip_address = '192.168.1.1';", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 79, "group_id": 79, "sample_metadata": {}}}
{"index": 28, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE orders (order_id INT, payment_method TEXT);\nQuestion: 查询每个支付方式的订单数量。\nSQL:", "target": "SELECT payment_method, COUNT(*) as order_count FROM orders GROUP BY payment_method;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT payment_method, COUNT(*) AS order_count FROM orders GROUP BY payment_method", "prediction": "SELECT payment_method, COUNT(*) AS order_count\nFROM orders\nGROUP BY payment_method;", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 28, "group_id": 28, "sample_metadata": {}}}
{"index": 75, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE interaction_logs (log_id INT, timestamp TIMESTAMP);\nQuestion: 查询在2023-10-01这天内的所有日志ID和时间戳。\nSQL:", "target": "SELECT log_id, timestamp FROM interaction_logs WHERE DATE(timestamp) = '2023-10-01';", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT log_id, timestamp FROM interaction_logs WHERE DATE(timestamp) = '2023-10-01'", "prediction": "SELECT log_id, timestamp\nFROM interaction_logs\nWHERE DATE(timestamp) = '2023-10-01';", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 75, "group_id": 75, "sample_metadata": {}}}
{"index": 47, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE orders (order_id INT, user_id INT, order_date DATE);\nQuestion: 查询每个用户的最后一次订单日期。\nSQL:", "target": "SELECT user_id, MAX(order_date) as last_order_date FROM orders GROUP BY user_id;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT user_id, MAX(order_date) AS last_order_date FROM orders GROUP BY user_id", "prediction": "SELECT user_id, MAX(order_date) AS last_order_date\nFROM orders\nGROUP BY user_id;", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 47, "group_id": 47, "sample_metadata": {}}}
{"index": 48, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE orders (order_id INT, user_id INT);\nQuestion: 查询订单表中没有用户ID的订单ID。\nSQL:", "target": "SELECT order_id FROM orders WHERE user_id IS NULL;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT order_id  FROM orders  WHERE user_id IS NULL", "prediction": "根据问题“查询订单表中没有用户ID的订单ID”，意思是查找 `user_id` 为 NULL 的订单的 `order_id`。\n\n对应的 SQL 查询语句如下：\n\n```sql\nSELECT order_id \nFROM orders \nWHERE user_id IS NULL;\n```", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 48, "group_id": 48, "sample_metadata": {}}}
{"index": 38, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE orders (order_id INT, order_date DATE, ship_date DATE);\nQuestion: 查询订单日期和发货日期相同的订单ID。\nSQL:", "target": "SELECT order_id FROM orders WHERE order_date = ship_date;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT order_id FROM orders WHERE order_date = ship_date", "prediction": "SELECT order_id\nFROM orders\nWHERE order_date = ship_date;", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 38, "group_id": 38, "sample_metadata": {}}}
{"index": 14, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE login_logs (user_id INT, login_time TIMESTAMP);\nQuestion: 查询最后登录时间在最近7天内的用户ID和登录时间。\nSQL:", "target": "SELECT user_id, login_time FROM login_logs WHERE login_time >= CURRENT_DATE - INTERVAL '7 days';", "sample_score": {"score": {"value": {"sql_ast_sim": 0.8333333333333334}, "extracted_prediction": "SELECT user_id, login_time FROM login_logs WHERE login_time >= NOW() - INTERVAL '7 days'", "prediction": "SELECT user_id, login_time\nFROM login_logs\nWHERE login_time >= NOW() - INTERVAL '7 days';", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 14, "group_id": 14, "sample_metadata": {}}}
{"index": 88, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE interaction_logs (log_id INT, ip_address TEXT, timestamp TIMESTAMP);\nQuestion: 查询日志中的异常IP地址（访问频率超过100次/天的IP）。\nSQL:", "target": "SELECT ip_address, COUNT(*) as access_count FROM interaction_logs WHERE DATE(timestamp) = CURRENT_DATE GROUP BY ip_address HAVING COUNT(*) > 100;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.4583333333333333}, "extracted_prediction": "SELECT ip_address FROM interaction_logs GROUP BY ip_address, DATE(timestamp) HAVING COUNT(*) > 100", "prediction": "要查询访问频率超过100次/天的异常IP地址，我们需要按 `ip_address` 和 `timestamp` 的日期部分进行分组，统计每天每个IP的访问次数，然后筛选出访问次数大于100的记录。\n\n在SQL中，可以使用 `DATE()` 函数提取日期部分（假设 `timestamp` 是标准的 TIMESTAMP 类型），然后使用 `GROUP BY` 和 `HAVING` 进行聚合筛选。\n\n以下是符合要求的SQL查询：\n\n```sql\nSELECT ip_address\nFROM interaction_logs\nGROUP BY ip_address, DATE(timestamp)\nHAVING COUNT(*) > 100;\n```\n\n### 说明：\n- `DATE(timestamp)`：提取时间戳中的日期部分（如 '2024-06-01'），用于按天分组。\n- `GROUP BY ip_address, DATE(timestamp)`：按IP地址和日期分组，统计每天每个IP的访问次数。\n- `HAVING COUNT(*) > 100`：筛选出访问次数超过100次的组。\n- 最终返回的是**异常IP地址**（即每天访问超过100次的IP）。\n\n> 注意：不同数据库系统对日期提取函数可能略有不同（如 PostgreSQL 用 `::date`，SQL Server 用 `CAST(timestamp AS DATE)`），但上述写法适用于 MySQL 和 SQLite 等主流系统。如果使用的是 PostgreSQL，可将 `DATE(timestamp)` 替换为 `timestamp::date`。", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 88, "group_id": 88, "sample_metadata": {}}}
{"index": 6, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE users (user_id INT, name TEXT, email TEXT);\nQuestion: 查询用户表中没有邮箱地址的用户姓名。\nSQL:", "target": "SELECT name FROM users WHERE email IS NULL OR email = '';", "sample_score": {"score": {"value": {"sql_ast_sim": 0.8333333333333334}, "extracted_prediction": "SELECT name FROM users WHERE email IS NULL", "prediction": "SELECT name FROM users WHERE email IS NULL;", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 6, "group_id": 6, "sample_metadata": {}}}
{"index": 44, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE orders (order_id INT, status TEXT, order_date DATE);\nQuestion: 查询订单状态为'pending'且订单日期超过30天的订单ID。\nSQL:", "target": "SELECT order_id FROM orders WHERE status = 'pending' AND order_date < CURRENT_DATE - INTERVAL '30 days';", "sample_score": {"score": {"value": {"sql_ast_sim": 0.7948717948717948}, "extracted_prediction": "SELECT order_id FROM orders WHERE status = 'pending'   AND order_date <= DATE('now', '-30 days')", "prediction": "SELECT order_id\nFROM orders\nWHERE status = 'pending'\n  AND order_date <= DATE('now', '-30 days');", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 44, "group_id": 44, "sample_metadata": {}}}
{"index": 62, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE documents (doc_id INT, created_date DATE);\nQuestion: 查询文档的创建年份分布。\nSQL:", "target": "SELECT EXTRACT(YEAR FROM created_date) as year, COUNT(*) as doc_count FROM documents GROUP BY EXTRACT(YEAR FROM created_date) ORDER BY year;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.17045454545454547}, "extracted_prediction": "SELECT YEAR(created_date) AS creation_year, COUNT(*) AS document_count FROM documents GROUP BY YEAR(created_date) ORDER BY creation_year", "prediction": "SELECT YEAR(created_date) AS creation_year, COUNT(*) AS document_count\nFROM documents\nGROUP BY YEAR(created_date)\nORDER BY creation_year;", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 62, "group_id": 62, "sample_metadata": {}}}
{"index": 74, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE interaction_logs (log_id INT, user_id INT);\nQuestion: 查询每个用户的操作日志数量。\nSQL:", "target": "SELECT user_id, COUNT(*) as log_count FROM interaction_logs GROUP BY user_id;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.9259259259259259}, "extracted_prediction": "SELECT user_id, COUNT(log_id) AS log_count FROM interaction_logs GROUP BY user_id", "prediction": "SELECT user_id, COUNT(log_id) AS log_count\nFROM interaction_logs\nGROUP BY user_id;", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 74, "group_id": 74, "sample_metadata": {}}}
{"index": 31, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE orders (order_id INT, status TEXT);\nQuestion: 查询订单状态分布，显示每个状态的订单数量。\nSQL:", "target": "SELECT status, COUNT(*) as order_count FROM orders GROUP BY status;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT status, COUNT(*) AS order_count FROM orders GROUP BY status", "prediction": "SELECT status, COUNT(*) AS order_count\nFROM orders\nGROUP BY status;", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 31, "group_id": 31, "sample_metadata": {}}}
{"index": 19, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE users (user_id INT, country TEXT, age INT);\nQuestion: 查询每个国家的用户年龄的标准差。\nSQL:", "target": "SELECT country, STDDEV(age) as age_stddev FROM users GROUP BY country;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT country, STDDEV(age) AS age_stddev FROM users GROUP BY country", "prediction": "SELECT country, STDDEV(age) AS age_stddev\nFROM users\nGROUP BY country;", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 19, "group_id": 19, "sample_metadata": {}}}
{"index": 33, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE orders (order_id INT, amount DECIMAL(10,2));\nQuestion: 查询订单金额大于平均订单金额的订单ID和金额。\nSQL:", "target": "SELECT order_id, amount FROM orders WHERE amount > (SELECT AVG(amount) FROM orders);", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT order_id, amount FROM orders WHERE amount > (SELECT AVG(amount) FROM orders)", "prediction": "SELECT order_id, amount\nFROM orders\nWHERE amount > (SELECT AVG(amount) FROM orders);", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 33, "group_id": 33, "sample_metadata": {}}}
{"index": 71, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE documents (doc_id INT, author TEXT);\nQuestion: 查询文档表中作者为空的文档ID。\nSQL:", "target": "SELECT doc_id FROM documents WHERE author IS NULL;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT doc_id FROM documents WHERE author IS NULL", "prediction": "SELECT doc_id FROM documents WHERE author IS NULL;", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 71, "group_id": 71, "sample_metadata": {}}}
{"index": 58, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE documents (doc_id INT, title TEXT);\nQuestion: 查询文档中标题长度超过50个字符的文档ID和标题。\nSQL:", "target": "SELECT doc_id, title FROM documents WHERE LENGTH(title) > 50;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT doc_id, title FROM documents WHERE LENGTH(title) > 50", "prediction": "SELECT doc_id, title\nFROM documents\nWHERE LENGTH(title) > 50;", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 58, "group_id": 58, "sample_metadata": {}}}
{"index": 4, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE users (user_id INT, registration_date DATE);\nQuestion: 查询2023年每个月month的用户注册数量user_count，并按月份升序排列。\nSQL:", "target": "SELECT EXTRACT(MONTH FROM registration_date) as month, COUNT(*) as user_count FROM users WHERE EXTRACT(YEAR FROM registration_date) = 2023 GROUP BY EXTRACT(MONTH FROM registration_date) ORDER BY month;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.29380952380952385}, "extracted_prediction": "SELECT      MONTH(registration_date) AS month,     COUNT(user_id) AS user_count FROM      users WHERE      YEAR(registration_date) = 2023 GROUP BY      MONTH(registration_date) ORDER BY      month ASC", "prediction": "SELECT \n    MONTH(registration_date) AS month,\n    COUNT(user_id) AS user_count\nFROM \n    users\nWHERE \n    YEAR(registration_date) = 2023\nGROUP BY \n    MONTH(registration_date)\nORDER BY \n    month ASC;", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 4, "group_id": 4, "sample_metadata": {}}}
{"index": 25, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE orders (order_id INT, status TEXT, amount DECIMAL(10,2));\nQuestion: 查询状态为'completed'且金额超过1000的订单数量。\nSQL:", "target": "SELECT COUNT(*) as order_count FROM orders WHERE status = 'completed' AND amount > 1000;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.8888888888888888}, "extracted_prediction": "SELECT COUNT(*)  FROM orders  WHERE status = 'completed' AND amount > 1000", "prediction": "SELECT COUNT(*) \nFROM orders \nWHERE status = 'completed' AND amount > 1000;", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 25, "group_id": 25, "sample_metadata": {}}}
{"index": 2, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE users (user_id INT, country TEXT, age INT);\nQuestion: 查询每个国家的用户平均年龄avg_age，并只显示平均年龄大于25的国家。\nSQL:", "target": "SELECT country, AVG(age) as avg_age FROM users GROUP BY country HAVING AVG(age) > 25;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT country, AVG(age) AS avg_age FROM users GROUP BY country HAVING AVG(age) > 25", "prediction": "SELECT country, AVG(age) AS avg_age\nFROM users\nGROUP BY country\nHAVING AVG(age) > 25;", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 2, "group_id": 2, "sample_metadata": {}}}
{"index": 3, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE user_accounts (account_id INT, username TEXT, signup_date DATE);\nQuestion: 查询注册日期最早的前10名用户的用户名和注册日期。\nSQL:", "target": "SELECT username, signup_date FROM user_accounts ORDER BY signup_date ASC LIMIT 10;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT username, signup_date FROM user_accounts ORDER BY signup_date ASC LIMIT 10", "prediction": "SELECT username, signup_date\nFROM user_accounts\nORDER BY signup_date ASC\nLIMIT 10;", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 3, "group_id": 3, "sample_metadata": {}}}
{"index": 82, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE interaction_logs (log_id INT, user_id INT, timestamp TIMESTAMP);\nQuestion: 查询每个用户的首次操作时间。\nSQL:", "target": "SELECT user_id, MIN(timestamp) as first_action_time FROM interaction_logs GROUP BY user_id;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.9259259259259259}, "extracted_prediction": "SELECT user_id, MIN(timestamp) AS first_interaction_time FROM interaction_logs GROUP BY user_id", "prediction": "SELECT user_id, MIN(timestamp) AS first_interaction_time\nFROM interaction_logs\nGROUP BY user_id;", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 82, "group_id": 82, "sample_metadata": {}}}
{"index": 93, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE interaction_logs (log_id INT, user_id INT, action TEXT, timestamp TIMESTAMP);\nQuestion: 查询日志表中操作重复的记录（相同用户、操作和时间戳）。\nSQL:", "target": "SELECT user_id, action, timestamp, COUNT(*) as duplicate_count FROM interaction_logs GROUP BY user_id, action, timestamp HAVING COUNT(*) > 1;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.16999999999999998}, "extracted_prediction": "SELECT log_id, user_id, action, timestamp FROM (     SELECT log_id, user_id, action, timestamp,            COUNT(*) OVER (PARTITION BY user_id, action, timestamp) AS cnt     FROM interaction_logs ) t WHERE cnt > 1", "prediction": "要查询日志表中**操作重复的记录**（即相同 `user_id`、`action` 和 `timestamp` 出现多次的记录），我们需要：\n\n1. 按 `user_id`, `action`, `timestamp` 分组；\n2. 筛选出出现次数大于 1 的组；\n3. 返回这些重复的完整记录。\n\n可以使用窗口函数或子查询实现。这里使用**窗口函数**的方式更清晰高效：\n\n```sql\nSELECT log_id, user_id, action, timestamp\nFROM (\n    SELECT log_id, user_id, action, timestamp,\n           COUNT(*) OVER (PARTITION BY user_id, action, timestamp) AS cnt\n    FROM interaction_logs\n) t\nWHERE cnt > 1;\n```\n\n### 说明：\n- `PARTITION BY user_id, action, timestamp`：按这三个字段分组，统计每组的记录数。\n- `COUNT(*) OVER (...) AS cnt`：为每行添加一个计数字段，表示该组合出现的次数。\n- 外层查询筛选 `cnt > 1`，即重复的记录。\n\n> 注意：此查询会返回**所有重复的记录行**（包括第一次出现的），而不是只返回“重复的组”。如果你只想知道哪些组合重复了，可以只选 `user_id, action, timestamp` 并去重，但题目要求是“查询重复的记录”，所以返回完整行是合理的。\n\n✅ 符合题意：查询操作重复的记录（相同用户、操作和时间戳）。", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 93, "group_id": 93, "sample_metadata": {}}}
{"index": 66, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE documents (doc_id INT, version INT);\nQuestion: 查询每个文档的版本升级情况（版本号增加）。\nSQL:", "target": "SELECT doc_id, version FROM documents WHERE version > 1;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.36818181818181817}, "extracted_prediction": "SELECT      doc_id,     version AS current_version,     LAG(version) OVER (PARTITION BY doc_id ORDER BY version) AS previous_version FROM      documents WHERE      version > LAG(version) OVER (PARTITION BY doc_id ORDER BY version)", "prediction": "要查询每个文档的版本升级情况（即版本号增加），我们需要比较同一个文档的不同版本，找出版本号比前一个版本大的记录。由于版本是递增的，我们可以使用窗口函数 `LAG()` 来获取每个文档的前一个版本号，然后比较当前版本是否大于前一个版本。\n\n以下是符合要求的 SQL 查询：\n\n```sql\nSELECT \n    doc_id,\n    version AS current_version,\n    LAG(version) OVER (PARTITION BY doc_id ORDER BY version) AS previous_version\nFROM \n    documents\nWHERE \n    version > LAG(version) OVER (PARTITION BY doc_id ORDER BY version);\n```\n\n### 说明：\n- `PARTITION BY doc_id`：按文档分组，确保只比较同一个文档的不同版本。\n- `ORDER BY version`：按版本号升序排列，确保顺序正确。\n- `LAG(version)`：获取当前行的前一行的版本号。\n- `WHERE version > LAG(version)`：筛选出版本号确实增加的记录（即升级情况）。\n\n> 注意：`LAG()` 在第一行（每个文档的最小版本）会返回 `NULL`，因此 `WHERE` 条件会自动过滤掉这些行，只保留有升级的记录。\n\n### 示例输出：\n| doc_id | current_version | previous_version |\n|--------|-----------------|------------------|\n| 1      | 2               | 1                |\n| 1      | 3               | 2                |\n| 2      | 2               | 1                |\n\n这表示文档1从1→2→3升级，文档2从1→2升级。", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 66, "group_id": 66, "sample_metadata": {}}}
{"index": 16, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE users (user_id INT, name TEXT, country TEXT, age INT);\nQuestion: 查询每个国家的最大年龄用户及其年龄。\nSQL:", "target": "SELECT country, name, MAX(age) as max_age FROM users GROUP BY country, name;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.1423076923076923}, "extracted_prediction": "SELECT country, name, age FROM (     SELECT country, name, age,            ROW_NUMBER() OVER (PARTITION BY country ORDER BY age DESC) AS rn     FROM users ) ranked WHERE rn = 1", "prediction": "要查询每个国家的最大年龄用户及其年龄，可以使用窗口函数 `ROW_NUMBER()` 或 `RANK()` 按国家分组，按年龄降序排序，然后取每组的第一条记录。\n\n以下是符合要求的 SQL 查询：\n\n```sql\nSELECT country, name, age\nFROM (\n    SELECT country, name, age,\n           ROW_NUMBER() OVER (PARTITION BY country ORDER BY age DESC) AS rn\n    FROM users\n) ranked\nWHERE rn = 1;\n```\n\n### 说明：\n- `PARTITION BY country`：按国家分组。\n- `ORDER BY age DESC`：在每个国家内按年龄降序排列。\n- `ROW_NUMBER()`：为每组分配唯一序号，年龄最大的为 1。\n- 外层查询 `WHERE rn = 1`：只保留每个国家年龄最大的用户。\n\n> 注意：如果有多个用户在同一个国家具有相同的最大年龄，`ROW_NUMBER()` 只会返回其中一个。如果希望返回所有并列最大年龄的用户，可以改用 `RANK()`：\n\n```sql\nSELECT country, name, age\nFROM (\n    SELECT country, name, age,\n           RANK() OVER (PARTITION BY country ORDER BY age DESC) AS rnk\n    FROM users\n) ranked\nWHERE rnk = 1;\n```\n\n推荐使用 `RANK()` 版本，以避免遗漏并列最大年龄的用户。", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 16, "group_id": 16, "sample_metadata": {}}}
{"index": 24, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE orders (order_id INT, order_date DATE, amount DECIMAL(10,2));\nQuestion: 查询2023年每个月的订单总金额。\nSQL:", "target": "SELECT EXTRACT(MONTH FROM order_date) as month, SUM(amount) as total_amount FROM orders WHERE EXTRACT(YEAR FROM order_date) = 2023 GROUP BY EXTRACT(MONTH FROM order_date) ORDER BY month;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.39380952380952383}, "extracted_prediction": "SELECT      MONTH(order_date) AS month,     SUM(amount) AS total_amount FROM      orders WHERE      YEAR(order_date) = 2023 GROUP BY      MONTH(order_date) ORDER BY      month", "prediction": "SELECT \n    MONTH(order_date) AS month,\n    SUM(amount) AS total_amount\nFROM \n    orders\nWHERE \n    YEAR(order_date) = 2023\nGROUP BY \n    MONTH(order_date)\nORDER BY \n    month;", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 24, "group_id": 24, "sample_metadata": {}}}
{"index": 29, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE orders (order_id INT, order_date DATE);\nQuestion: 查询订单日期在节假日（例如2023-12-25）内的订单ID和日期。\nSQL:", "target": "SELECT order_id, order_date FROM orders WHERE order_date = '2023-12-25';", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT order_id, order_date FROM orders WHERE order_date = '2023-12-25'", "prediction": "SELECT order_id, order_date\nFROM orders\nWHERE order_date = '2023-12-25';", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 29, "group_id": 29, "sample_metadata": {}}}
{"index": 0, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE users (user_id INT, username TEXT, country TEXT, registration_date DATE);\nQuestion: 查询每个国家在2023年注册的用户数量user_count，并按数量降序排列。\nSQL:", "target": "SELECT country, COUNT(*) as user_count FROM users WHERE EXTRACT(YEAR FROM registration_date) = 2023 GROUP BY country ORDER BY user_count DESC;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.64}, "extracted_prediction": "SELECT country, COUNT(*) AS user_count FROM users WHERE registration_date >= '2023-01-01' AND registration_date <= '2023-12-31' GROUP BY country ORDER BY user_count DESC", "prediction": "SELECT country, COUNT(*) AS user_count\nFROM users\nWHERE registration_date >= '2023-01-01' AND registration_date <= '2023-12-31'\nGROUP BY country\nORDER BY user_count DESC;", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 0, "group_id": 0, "sample_metadata": {}}}
{"index": 59, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE documents (doc_id INT, author TEXT, created_date DATE);\nQuestion: 查询每个作者的文档平均创建间隔（按天计算）。\nSQL:", "target": "SELECT author, AVG(created_date - LAG(created_date) OVER (PARTITION BY author ORDER BY created_date)) as avg_interval FROM documents GROUP BY author;", "sample_score": {"score": {"value": {"sql_ast_sim": 0.5028571428571429}, "extracted_prediction": "SELECT      author,     AVG(JULIANDAY(created_date) - JULIANDAY(prev_created_date)) AS avg_interval_days FROM (     SELECT          author,         created_date,         LAG(created_date) OVER (PARTITION BY author ORDER BY created_date) AS prev_created_date     FROM documents ) AS datediff_table WHERE prev_created_date IS NOT NULL GROUP BY author", "prediction": "要计算每个作者的文档平均创建间隔（按天计算），我们需要：\n\n1. 对每个作者的文档按创建日期排序；\n2. 计算相邻文档之间的日期差（以天为单位）；\n3. 对每个作者的这些间隔求平均值。\n\n由于 SQL 本身不直接支持“相邻行比较”，我们需要使用窗口函数 `LAG()` 来获取前一条记录的创建日期，然后计算差值。\n\n以下是符合要求的 SQL 查询：\n\n```sql\nSELECT \n    author,\n    AVG(JULIANDAY(created_date) - JULIANDAY(prev_created_date)) AS avg_interval_days\nFROM (\n    SELECT \n        author,\n        created_date,\n        LAG(created_date) OVER (PARTITION BY author ORDER BY created_date) AS prev_created_date\n    FROM documents\n) AS datediff_table\nWHERE prev_created_date IS NOT NULL\nGROUP BY author;\n```\n\n### 说明：\n- `LAG(created_date) OVER (PARTITION BY author ORDER BY created_date)`：获取每个作者按时间顺序的前一个文档的创建日期。\n- `JULIANDAY(date)`：SQLite 中用于将日期转换为儒略日数值，相减即得天数差（适用于 SQLite）。\n- `WHERE prev_created_date IS NOT NULL`：排除第一个文档（没有前一个文档，无法计算间隔）。\n- `AVG(...)`：计算每个作者所有相邻文档间隔的平均值（以天为单位）。\n\n> ⚠️ 注意：如果使用的是其他数据库（如 MySQL、PostgreSQL），日期差的计算方式略有不同。例如：\n> - **PostgreSQL**：`created_date - LAG(created_date) OVER (...)` 直接返回 `interval`，可用 `EXTRACT(EPOCH FROM ...)/86400` 转为天。\n> - **MySQL**：`DATEDIFF(created_date, LAG(created_date) OVER (...))`\n\n但根据题目未指定数据库，且 `JULIANDAY` 是 SQLite 常用函数，而 `CREATE TABLE` 语法也常见于 SQLite，**本答案采用 SQLite 兼容写法**。", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 59, "group_id": 59, "sample_metadata": {}}}
{"index": 30, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE orders (order_id INT, user_id INT, amount DECIMAL(10,2));\nQuestion: 查询每个用户的平均订单金额。\nSQL:", "target": "SELECT user_id, AVG(amount) as avg_amount FROM orders GROUP BY user_id;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT user_id, AVG(amount) AS avg_amount FROM orders GROUP BY user_id", "prediction": "SELECT user_id, AVG(amount) AS avg_amount\nFROM orders\nGROUP BY user_id;", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 30, "group_id": 30, "sample_metadata": {}}}
{"index": 23, "input": "**User**: \nConvert the following question into a SQL query based on the provided schema.\nSchema: CREATE TABLE users (user_id INT, age INT);\nQuestion: 查询用户表中年龄为NULL的用户ID。\nSQL:", "target": "SELECT user_id FROM users WHERE age IS NULL;", "sample_score": {"score": {"value": {"sql_ast_sim": 1.0}, "extracted_prediction": "SELECT user_id FROM users WHERE age IS NULL", "prediction": "SELECT user_id FROM users WHERE age IS NULL;", "explanation": null, "metadata": {}, "main_score_name": "sql_ast_sim"}, "sample_id": 23, "group_id": 23, "sample_metadata": {}}}

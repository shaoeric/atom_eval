{"question":"查询所有注册时间在2023年1月1日之后且年龄在25到35岁之间的用户，按注册时间降序排列，只显示前10条。","schema":["CREATE TABLE users (user_id INT PRIMARY KEY, username TEXT, email TEXT, age INT, gender TEXT, registration_date DATE, last_login_date DATE, status TEXT, city TEXT, phone TEXT);"],"ground_truth":"SELECT * FROM users WHERE registration_date > '2023-01-01' AND age BETWEEN 25 AND 35 ORDER BY registration_date DESC LIMIT 10;"}
{"question":"统计每个城市的用户数量，只显示用户数量大于100的城市，按用户数量降序排列。","schema":["CREATE TABLE users (user_id INT PRIMARY KEY, username TEXT, email TEXT, age INT, gender TEXT, registration_date DATE, last_login_date DATE, status TEXT, city TEXT, phone TEXT);"],"ground_truth":"SELECT city, COUNT(*) as user_count FROM users GROUP BY city HAVING COUNT(*) > 100 ORDER BY user_count DESC;"}
{"question":"查询最近30天内登录过且状态为活跃的用户，显示用户名、邮箱和最后登录时间。","schema":["CREATE TABLE users (user_id INT PRIMARY KEY, username TEXT, email TEXT, age INT, gender TEXT, registration_date DATE, last_login_date DATE, status TEXT, city TEXT, phone TEXT);"],"ground_truth":"SELECT username, email, last_login_date FROM users WHERE status = 'active' AND last_login_date >= DATE('now', '-30 days');"}
{"question":"找出邮箱域名是gmail.com的用户中，注册时间最早的前5名用户。","schema":["CREATE TABLE users (user_id INT PRIMARY KEY, username TEXT, email TEXT, age INT, gender TEXT, registration_date DATE, last_login_date DATE, status TEXT, city TEXT, phone TEXT);"],"ground_truth":"SELECT * FROM users WHERE email LIKE '%@gmail.com' ORDER BY registration_date ASC LIMIT 5;"}
{"question":"计算每个性别用户的平均年龄，并显示平均年龄大于30的性别分组。","schema":["CREATE TABLE users (user_id INT PRIMARY KEY, username TEXT, email TEXT, age INT, gender TEXT, registration_date DATE, last_login_date DATE, status TEXT, city TEXT, phone TEXT);"],"ground_truth":"SELECT gender, AVG(age) as avg_age FROM users GROUP BY gender HAVING AVG(age) > 30;"}
{"question":"查询2023年每个季度注册的用户数量，按季度排序。","schema":["CREATE TABLE users (user_id INT PRIMARY KEY, username TEXT, email TEXT, age INT, gender TEXT, registration_date DATE, last_login_date DATE, status TEXT, city TEXT, phone TEXT);"],"ground_truth":"SELECT CASE WHEN strftime('%m', registration_date) IN ('01','02','03') THEN 'Q1' WHEN strftime('%m', registration_date) IN ('04','05','06') THEN 'Q2' WHEN strftime('%m', registration_date) IN ('07','08','09') THEN 'Q3' ELSE 'Q4' END as quarter, COUNT(*) as count FROM users WHERE strftime('%Y', registration_date) = '2023' GROUP BY quarter ORDER BY quarter;"}
{"question":"找出用户名长度大于8且包含数字的用户，显示用户名和注册日期。","schema":["CREATE TABLE users (user_id INT PRIMARY KEY, username TEXT, email TEXT, age INT, gender TEXT, registration_date DATE, last_login_date DATE, status TEXT, city TEXT, phone TEXT);"],"ground_truth":"SELECT username, registration_date FROM users WHERE LENGTH(username) > 8 AND username GLOB '*[0-9]*';"}
{"question":"查询年龄在平均值以上的用户数量，按城市分组统计。","schema":["CREATE TABLE users (user_id INT PRIMARY KEY, username TEXT, email TEXT, age INT, gender TEXT, registration_date DATE, last_login_date DATE, status TEXT, city TEXT, phone TEXT);"],"ground_truth":"SELECT city, COUNT(*) as count FROM users WHERE age > (SELECT AVG(age) FROM users) GROUP BY city;"}
{"question":"找出注册超过1年但从未登录过的用户，显示用户ID、用户名和注册日期。","schema":["CREATE TABLE users (user_id INT PRIMARY KEY, username TEXT, email TEXT, age INT, gender TEXT, registration_date DATE, last_login_date DATE, status TEXT, city TEXT, phone TEXT);"],"ground_truth":"SELECT user_id, username, registration_date FROM users WHERE registration_date < DATE('now', '-1 year') AND (last_login_date IS NULL OR last_login_date = registration_date);"}
{"question":"统计每个状态（status）的用户数量，并计算各状态用户占总用户数的百分比。","schema":["CREATE TABLE users (user_id INT PRIMARY KEY, username TEXT, email TEXT, age INT, gender TEXT, registration_date DATE, last_login_date DATE, status TEXT, city TEXT, phone TEXT);"],"ground_truth":"SELECT status, COUNT(*) as count, ROUND(COUNT(*) * 100.0 / (SELECT COUNT(*) FROM users), 2) as percentage FROM users GROUP BY status;"}
{"question":"查询手机号以138开头的用户中，年龄最大的前3名用户信息。","schema":["CREATE TABLE users (user_id INT PRIMARY KEY, username TEXT, email TEXT, age INT, gender TEXT, registration_date DATE, last_login_date DATE, status TEXT, city TEXT, phone TEXT);"],"ground_truth":"SELECT * FROM users WHERE phone LIKE '138%' ORDER BY age DESC LIMIT 3;"}
{"question":"找出注册时间在周末（周六或周日）的用户，显示用户名、注册日期和星期几。","schema":["CREATE TABLE users (user_id INT PRIMARY KEY, username TEXT, email TEXT, age INT, gender TEXT, registration_date DATE, last_login_date DATE, status TEXT, city TEXT, phone TEXT);"],"ground_truth":"SELECT username, registration_date, CASE CAST(strftime('%w', registration_date) AS INTEGER) WHEN 0 THEN 'Sunday' WHEN 6 THEN 'Saturday' END as day_of_week FROM users WHERE strftime('%w', registration_date) IN ('0', '6');"}
{"question":"查询每个城市中年龄最大的用户，显示城市、用户名和年龄。","schema":["CREATE TABLE users (user_id INT PRIMARY KEY, username TEXT, email TEXT, age INT, gender TEXT, registration_date DATE, last_login_date DATE, status TEXT, city TEXT, phone TEXT);"],"ground_truth":"SELECT city, username, age FROM users u1 WHERE age = (SELECT MAX(age) FROM users u2 WHERE u2.city = u1.city);"}
{"question":"统计2023年每个月新增用户数量，只显示新增用户数超过50的月份。","schema":["CREATE TABLE users (user_id INT PRIMARY KEY, username TEXT, email TEXT, age INT, gender TEXT, registration_date DATE, last_login_date DATE, status TEXT, city TEXT, phone TEXT);"],"ground_truth":"SELECT strftime('%Y-%m', registration_date) as month, COUNT(*) as count FROM users WHERE strftime('%Y', registration_date) = '2023' GROUP BY month HAVING COUNT(*) > 50 ORDER BY month;"}
{"question":"查询邮箱地址中包含公司域名（包含'company'或'corp'）的用户，按注册时间升序排列。","schema":["CREATE TABLE users (user_id INT PRIMARY KEY, username TEXT, email TEXT, age INT, gender TEXT, registration_date DATE, last_login_date DATE, status TEXT, city TEXT, phone TEXT);"],"ground_truth":"SELECT * FROM users WHERE email LIKE '%company%' OR email LIKE '%corp%' ORDER BY registration_date ASC;"}
{"question":"找出年龄在所在城市平均年龄以上的用户，显示用户ID、用户名、城市和年龄。","schema":["CREATE TABLE users (user_id INT PRIMARY KEY, username TEXT, email TEXT, age INT, gender TEXT, registration_date DATE, last_login_date DATE, status TEXT, city TEXT, phone TEXT);"],"ground_truth":"SELECT user_id, username, city, age FROM users u1 WHERE age > (SELECT AVG(age) FROM users u2 WHERE u2.city = u1.city);"}
{"question":"查询注册时间距离今天正好365天的用户数量。","schema":["CREATE TABLE users (user_id INT PRIMARY KEY, username TEXT, email TEXT, age INT, gender TEXT, registration_date DATE, last_login_date DATE, status TEXT, city TEXT, phone TEXT);"],"ground_truth":"SELECT COUNT(*) FROM users WHERE registration_date = DATE('now', '-365 days');"}
{"question":"统计每个性别在不同城市的分布情况，显示性别、城市和用户数量，按性别和用户数量降序排列。","schema":["CREATE TABLE users (user_id INT PRIMARY KEY, username TEXT, email TEXT, age INT, gender TEXT, registration_date DATE, last_login_date DATE, status TEXT, city TEXT, phone TEXT);"],"ground_truth":"SELECT gender, city, COUNT(*) as count FROM users GROUP BY gender, city ORDER BY gender, count DESC;"}
{"question":"查询用户名以字母开头且长度为6到10个字符的用户，显示用户名和邮箱。","schema":["CREATE TABLE users (user_id INT PRIMARY KEY, username TEXT, email TEXT, age INT, gender TEXT, registration_date DATE, last_login_date DATE, status TEXT, city TEXT, phone TEXT);"],"ground_truth":"SELECT username, email FROM users WHERE username GLOB '[a-zA-Z]*' AND LENGTH(username) BETWEEN 6 AND 10;"}
{"question":"找出最后登录时间在最近7天内，且注册时间超过6个月的用户，显示用户名和最后登录时间。","schema":["CREATE TABLE users (user_id INT PRIMARY KEY, username TEXT, email TEXT, age INT, gender TEXT, registration_date DATE, last_login_date DATE, status TEXT, city TEXT, phone TEXT);"],"ground_truth":"SELECT username, last_login_date FROM users WHERE last_login_date >= DATE('now', '-7 days') AND registration_date < DATE('now', '-6 months');"}
{"question":"计算每个城市用户的平均注册时长（以天为单位），显示城市和平均天数。","schema":["CREATE TABLE users (user_id INT PRIMARY KEY, username TEXT, email TEXT, age INT, gender TEXT, registration_date DATE, last_login_date DATE, status TEXT, city TEXT, phone TEXT);"],"ground_truth":"SELECT city, AVG(julianday('now') - julianday(registration_date)) as avg_days FROM users GROUP BY city;"}
{"question":"查询状态为活跃且年龄在25-40岁之间的女性用户，按年龄升序排列，显示前20条。","schema":["CREATE TABLE users (user_id INT PRIMARY KEY, username TEXT, email TEXT, age INT, gender TEXT, registration_date DATE, last_login_date DATE, status TEXT, city TEXT, phone TEXT);"],"ground_truth":"SELECT * FROM users WHERE status = 'active' AND age BETWEEN 25 AND 40 AND gender = 'female' ORDER BY age ASC LIMIT 20;"}
{"question":"统计每个城市中不同性别的用户数量，使用透视表格式显示。","schema":["CREATE TABLE users (user_id INT PRIMARY KEY, username TEXT, email TEXT, age INT, gender TEXT, registration_date DATE, last_login_date DATE, status TEXT, city TEXT, phone TEXT);"],"ground_truth":"SELECT city, SUM(CASE WHEN gender = 'male' THEN 1 ELSE 0 END) as male_count, SUM(CASE WHEN gender = 'female' THEN 1 ELSE 0 END) as female_count, SUM(CASE WHEN gender NOT IN ('male', 'female') OR gender IS NULL THEN 1 ELSE 0 END) as other_count FROM users GROUP BY city;"}
{"question":"找出注册时间最早的用户所在的城市，并查询该城市所有用户的平均年龄。","schema":["CREATE TABLE users (user_id INT PRIMARY KEY, username TEXT, email TEXT, age INT, gender TEXT, registration_date DATE, last_login_date DATE, status TEXT, city TEXT, phone TEXT);"],"ground_truth":"SELECT city, AVG(age) as avg_age FROM users WHERE city = (SELECT city FROM users ORDER BY registration_date ASC LIMIT 1) GROUP BY city;"}
{"question":"查询2023年下半年（7-12月）注册的用户中，按月份统计注册人数，只显示注册人数最多的前3个月。","schema":["CREATE TABLE users (user_id INT PRIMARY KEY, username TEXT, email TEXT, age INT, gender TEXT, registration_date DATE, last_login_date DATE, status TEXT, city TEXT, phone TEXT);"],"ground_truth":"SELECT strftime('%Y-%m', registration_date) as month, COUNT(*) as count FROM users WHERE strftime('%Y', registration_date) = '2023' AND CAST(strftime('%m', registration_date) AS INTEGER) BETWEEN 7 AND 12 GROUP BY month ORDER BY count DESC LIMIT 3;"}
{"question":"查询订单总金额超过10000元的订单，显示订单号、用户ID、订单金额和下单时间，按金额降序排列。","schema":["CREATE TABLE orders (order_id INT PRIMARY KEY, user_id INT, order_date DATE, total_amount DECIMAL(10,2), status TEXT, payment_method TEXT, shipping_address TEXT, discount DECIMAL(10,2), tax DECIMAL(10,2), created_at TIMESTAMP);"],"ground_truth":"SELECT order_id, user_id, total_amount, order_date FROM orders WHERE total_amount > 10000 ORDER BY total_amount DESC;"}
{"question":"统计每个支付方式的订单数量和总金额，按总金额降序排列。","schema":["CREATE TABLE orders (order_id INT PRIMARY KEY, user_id INT, order_date DATE, total_amount DECIMAL(10,2), status TEXT, payment_method TEXT, shipping_address TEXT, discount DECIMAL(10,2), tax DECIMAL(10,2), created_at TIMESTAMP);"],"ground_truth":"SELECT payment_method, COUNT(*) as order_count, SUM(total_amount) as total_amount FROM orders GROUP BY payment_method ORDER BY total_amount DESC;"}
{"question":"查询2023年每个月的订单总金额，只显示总金额超过50000元的月份。","schema":["CREATE TABLE orders (order_id INT PRIMARY KEY, user_id INT, order_date DATE, total_amount DECIMAL(10,2), status TEXT, payment_method TEXT, shipping_address TEXT, discount DECIMAL(10,2), tax DECIMAL(10,2), created_at TIMESTAMP);"],"ground_truth":"SELECT strftime('%Y-%m', order_date) as month, SUM(total_amount) as total FROM orders WHERE strftime('%Y', order_date) = '2023' GROUP BY month HAVING SUM(total_amount) > 50000 ORDER BY month;"}
{"question":"找出折扣金额最高的前10个订单，显示订单号、总金额、折扣金额和实际支付金额。","schema":["CREATE TABLE orders (order_id INT PRIMARY KEY, user_id INT, order_date DATE, total_amount DECIMAL(10,2), status TEXT, payment_method TEXT, shipping_address TEXT, discount DECIMAL(10,2), tax DECIMAL(10,2), created_at TIMESTAMP);"],"ground_truth":"SELECT order_id, total_amount, discount, (total_amount - discount + tax) as final_amount FROM orders ORDER BY discount DESC LIMIT 10;"}
{"question":"查询状态为已完成且订单金额在平均值以上的订单数量，按用户ID分组统计。","schema":["CREATE TABLE orders (order_id INT PRIMARY KEY, user_id INT, order_date DATE, total_amount DECIMAL(10,2), status TEXT, payment_method TEXT, shipping_address TEXT, discount DECIMAL(10,2), tax DECIMAL(10,2), created_at TIMESTAMP);"],"ground_truth":"SELECT user_id, COUNT(*) as count FROM orders WHERE status = 'completed' AND total_amount > (SELECT AVG(total_amount) FROM orders) GROUP BY user_id;"}
{"question":"统计每个状态的订单数量和平均订单金额，按订单数量降序排列。","schema":["CREATE TABLE orders (order_id INT PRIMARY KEY, user_id INT, order_date DATE, total_amount DECIMAL(10,2), status TEXT, payment_method TEXT, shipping_address TEXT, discount DECIMAL(10,2), tax DECIMAL(10,2), created_at TIMESTAMP);"],"ground_truth":"SELECT status, COUNT(*) as count, AVG(total_amount) as avg_amount FROM orders GROUP BY status ORDER BY count DESC;"}
{"question":"查询最近30天内下单的订单，计算每个用户的订单总金额，只显示总金额超过5000元的用户。","schema":["CREATE TABLE orders (order_id INT PRIMARY KEY, user_id INT, order_date DATE, total_amount DECIMAL(10,2), status TEXT, payment_method TEXT, shipping_address TEXT, discount DECIMAL(10,2), tax DECIMAL(10,2), created_at TIMESTAMP);"],"ground_truth":"SELECT user_id, SUM(total_amount) as total FROM orders WHERE order_date >= DATE('now', '-30 days') GROUP BY user_id HAVING SUM(total_amount) > 5000 ORDER BY total DESC;"}
{"question":"找出订单金额在所在状态的平均金额以上的订单，显示订单号、状态和金额。","schema":["CREATE TABLE orders (order_id INT PRIMARY KEY, user_id INT, order_date DATE, total_amount DECIMAL(10,2), status TEXT, payment_method TEXT, shipping_address TEXT, discount DECIMAL(10,2), tax DECIMAL(10,2), created_at TIMESTAMP);"],"ground_truth":"SELECT order_id, status, total_amount FROM orders o1 WHERE total_amount > (SELECT AVG(total_amount) FROM orders o2 WHERE o2.status = o1.status);"}
{"question":"查询使用信用卡支付且订单金额大于1000元的订单，按下单时间降序排列，显示前50条。","schema":["CREATE TABLE orders (order_id INT PRIMARY KEY, user_id INT, order_date DATE, total_amount DECIMAL(10,2), status TEXT, payment_method TEXT, shipping_address TEXT, discount DECIMAL(10,2), tax DECIMAL(10,2), created_at TIMESTAMP);"],"ground_truth":"SELECT * FROM orders WHERE payment_method = 'credit_card' AND total_amount > 1000 ORDER BY order_date DESC LIMIT 50;"}
{"question":"统计2023年每个季度的订单总金额和平均订单金额，按季度排序。","schema":["CREATE TABLE orders (order_id INT PRIMARY KEY, user_id INT, order_date DATE, total_amount DECIMAL(10,2), status TEXT, payment_method TEXT, shipping_address TEXT, discount DECIMAL(10,2), tax DECIMAL(10,2), created_at TIMESTAMP);"],"ground_truth":"SELECT CASE WHEN strftime('%m', order_date) IN ('01','02','03') THEN 'Q1' WHEN strftime('%m', order_date) IN ('04','05','06') THEN 'Q2' WHEN strftime('%m', order_date) IN ('07','08','09') THEN 'Q3' ELSE 'Q4' END as quarter, SUM(total_amount) as total, AVG(total_amount) as avg_amount FROM orders WHERE strftime('%Y', order_date) = '2023' GROUP BY quarter ORDER BY quarter;"}
{"question":"查询折扣率（折扣金额/总金额）大于0.2的订单，显示订单号、总金额、折扣金额和折扣率，按折扣率降序排列。","schema":["CREATE TABLE orders (order_id INT PRIMARY KEY, user_id INT, order_date DATE, total_amount DECIMAL(10,2), status TEXT, payment_method TEXT, shipping_address TEXT, discount DECIMAL(10,2), tax DECIMAL(10,2), created_at TIMESTAMP);"],"ground_truth":"SELECT order_id, total_amount, discount, ROUND(discount * 100.0 / total_amount, 2) as discount_rate FROM orders WHERE discount * 1.0 / total_amount > 0.2 ORDER BY discount_rate DESC;"}
{"question":"找出每个用户订单金额最大的订单，显示用户ID、订单号和订单金额。","schema":["CREATE TABLE orders (order_id INT PRIMARY KEY, user_id INT, order_date DATE, total_amount DECIMAL(10,2), status TEXT, payment_method TEXT, shipping_address TEXT, discount DECIMAL(10,2), tax DECIMAL(10,2), created_at TIMESTAMP);"],"ground_truth":"SELECT user_id, order_id, total_amount FROM orders o1 WHERE total_amount = (SELECT MAX(total_amount) FROM orders o2 WHERE o2.user_id = o1.user_id);"}
{"question":"查询配送地址包含'北京'的订单，统计每个状态的订单数量。","schema":["CREATE TABLE orders (order_id INT PRIMARY KEY, user_id INT, order_date DATE, total_amount DECIMAL(10,2), status TEXT, payment_method TEXT, shipping_address TEXT, discount DECIMAL(10,2), tax DECIMAL(10,2), created_at TIMESTAMP);"],"ground_truth":"SELECT status, COUNT(*) as count FROM orders WHERE shipping_address LIKE '%北京%' GROUP BY status;"}
{"question":"统计每个支付方式在不同状态下的订单数量，使用交叉表格式显示。","schema":["CREATE TABLE orders (order_id INT PRIMARY KEY, user_id INT, order_date DATE, total_amount DECIMAL(10,2), status TEXT, payment_method TEXT, shipping_address TEXT, discount DECIMAL(10,2), tax DECIMAL(10,2), created_at TIMESTAMP);"],"ground_truth":"SELECT payment_method, SUM(CASE WHEN status = 'pending' THEN 1 ELSE 0 END) as pending_count, SUM(CASE WHEN status = 'completed' THEN 1 ELSE 0 END) as completed_count, SUM(CASE WHEN status = 'cancelled' THEN 1 ELSE 0 END) as cancelled_count FROM orders GROUP BY payment_method;"}
{"question":"查询订单金额在1000到5000元之间，且创建时间在最近3个月内的订单，按订单金额升序排列。","schema":["CREATE TABLE orders (order_id INT PRIMARY KEY, user_id INT, order_date DATE, total_amount DECIMAL(10,2), status TEXT, payment_method TEXT, shipping_address TEXT, discount DECIMAL(10,2), tax DECIMAL(10,2), created_at TIMESTAMP);"],"ground_truth":"SELECT * FROM orders WHERE total_amount BETWEEN 1000 AND 5000 AND created_at >= datetime('now', '-3 months') ORDER BY total_amount ASC;"}
{"question":"找出税费金额最高的前5个订单，显示订单号、总金额、税费和税费占比。","schema":["CREATE TABLE orders (order_id INT PRIMARY KEY, user_id INT, order_date DATE, total_amount DECIMAL(10,2), status TEXT, payment_method TEXT, shipping_address TEXT, discount DECIMAL(10,2), tax DECIMAL(10,2), created_at TIMESTAMP);"],"ground_truth":"SELECT order_id, total_amount, tax, ROUND(tax * 100.0 / total_amount, 2) as tax_rate FROM orders ORDER BY tax DESC LIMIT 5;"}
{"question":"查询2023年12月的订单，按日期统计每天的订单数量和总金额，只显示订单数量超过10的日期。","schema":["CREATE TABLE orders (order_id INT PRIMARY KEY, user_id INT, order_date DATE, total_amount DECIMAL(10,2), status TEXT, payment_method TEXT, shipping_address TEXT, discount DECIMAL(10,2), tax DECIMAL(10,2), created_at TIMESTAMP);"],"ground_truth":"SELECT order_date, COUNT(*) as count, SUM(total_amount) as total FROM orders WHERE strftime('%Y-%m', order_date) = '2023-12' GROUP BY order_date HAVING COUNT(*) > 10 ORDER BY order_date;"}
{"question":"统计每个用户的总订单数、总订单金额和平均订单金额，只显示订单数大于5的用户，按总金额降序排列。","schema":["CREATE TABLE orders (order_id INT PRIMARY KEY, user_id INT, order_date DATE, total_amount DECIMAL(10,2), status TEXT, payment_method TEXT, shipping_address TEXT, discount DECIMAL(10,2), tax DECIMAL(10,2), created_at TIMESTAMP);"],"ground_truth":"SELECT user_id, COUNT(*) as order_count, SUM(total_amount) as total_amount, AVG(total_amount) as avg_amount FROM orders GROUP BY user_id HAVING COUNT(*) > 5 ORDER BY total_amount DESC;"}
{"question":"查询订单金额大于平均值且状态为已完成的订单，显示订单号和金额，按金额降序排列。","schema":["CREATE TABLE orders (order_id INT PRIMARY KEY, user_id INT, order_date DATE, total_amount DECIMAL(10,2), status TEXT, payment_method TEXT, shipping_address TEXT, discount DECIMAL(10,2), tax DECIMAL(10,2), created_at TIMESTAMP);"],"ground_truth":"SELECT order_id, total_amount FROM orders WHERE total_amount > (SELECT AVG(total_amount) FROM orders) AND status = 'completed' ORDER BY total_amount DESC;"}
{"question":"找出每个支付方式中订单金额最大的订单，显示支付方式、订单号和金额。","schema":["CREATE TABLE orders (order_id INT PRIMARY KEY, user_id INT, order_date DATE, total_amount DECIMAL(10,2), status TEXT, payment_method TEXT, shipping_address TEXT, discount DECIMAL(10,2), tax DECIMAL(10,2), created_at TIMESTAMP);"],"ground_truth":"SELECT payment_method, order_id, total_amount FROM orders o1 WHERE total_amount = (SELECT MAX(total_amount) FROM orders o2 WHERE o2.payment_method = o1.payment_method);"}
{"question":"查询所有研发文档中，创建时间在2023年且文档大小超过1MB的文档，显示文档ID、标题、大小和创建时间，按大小降序排列。","schema":["CREATE TABLE research_docs (doc_id INT PRIMARY KEY, title TEXT, author TEXT, category TEXT, file_size INT, created_date DATE, updated_date DATE, version TEXT, status TEXT, tags TEXT, description TEXT);"],"ground_truth":"SELECT doc_id, title, file_size, created_date FROM research_docs WHERE strftime('%Y', created_date) = '2023' AND file_size > 1048576 ORDER BY file_size DESC;"}
{"question":"统计每个类别的文档数量和平均文件大小，按文档数量降序排列。","schema":["CREATE TABLE research_docs (doc_id INT PRIMARY KEY, title TEXT, author TEXT, category TEXT, file_size INT, created_date DATE, updated_date DATE, version TEXT, status TEXT, tags TEXT, description TEXT);"],"ground_truth":"SELECT category, COUNT(*) as doc_count, AVG(file_size) as avg_size FROM research_docs GROUP BY category ORDER BY doc_count DESC;"}
{"question":"查询最近6个月内更新的文档，找出每个作者更新的文档数量，只显示更新数量大于10的作者。","schema":["CREATE TABLE research_docs (doc_id INT PRIMARY KEY, title TEXT, author TEXT, category TEXT, file_size INT, created_date DATE, updated_date DATE, version TEXT, status TEXT, tags TEXT, description TEXT);"],"ground_truth":"SELECT author, COUNT(*) as update_count FROM research_docs WHERE updated_date >= DATE('now', '-6 months') GROUP BY author HAVING COUNT(*) > 10 ORDER BY update_count DESC;"}
{"question":"找出标题中包含'算法'或'设计'的文档，显示文档ID、标题、类别和创建日期，按创建日期降序排列。","schema":["CREATE TABLE research_docs (doc_id INT PRIMARY KEY, title TEXT, author TEXT, category TEXT, file_size INT, created_date DATE, updated_date DATE, version TEXT, status TEXT, tags TEXT, description TEXT);"],"ground_truth":"SELECT doc_id, title, category, created_date FROM research_docs WHERE title LIKE '%算法%' OR title LIKE '%设计%' ORDER BY created_date DESC;"}
{"question":"统计每个状态的文档数量和总文件大小，按总文件大小降序排列。","schema":["CREATE TABLE research_docs (doc_id INT PRIMARY KEY, title TEXT, author TEXT, category TEXT, file_size INT, created_date DATE, updated_date DATE, version TEXT, status TEXT, tags TEXT, description TEXT);"],"ground_truth":"SELECT status, COUNT(*) as count, SUM(file_size) as total_size FROM research_docs GROUP BY status ORDER BY total_size DESC;"}
{"question":"查询文件大小在平均值以上的文档，按类别分组统计数量，只显示数量大于5的类别。","schema":["CREATE TABLE research_docs (doc_id INT PRIMARY KEY, title TEXT, author TEXT, category TEXT, file_size INT, created_date DATE, updated_date DATE, version TEXT, status TEXT, tags TEXT, description TEXT);"],"ground_truth":"SELECT category, COUNT(*) as count FROM research_docs WHERE file_size > (SELECT AVG(file_size) FROM research_docs) GROUP BY category HAVING COUNT(*) > 5;"}
{"question":"找出每个作者创建的文档中，文件大小最大的文档，显示作者、文档ID、标题和大小。","schema":["CREATE TABLE research_docs (doc_id INT PRIMARY KEY, title TEXT, author TEXT, category TEXT, file_size INT, created_date DATE, updated_date DATE, version TEXT, status TEXT, tags TEXT, description TEXT);"],"ground_truth":"SELECT author, doc_id, title, file_size FROM research_docs r1 WHERE file_size = (SELECT MAX(file_size) FROM research_docs r2 WHERE r2.author = r1.author);"}
{"question":"查询版本号为v2.0及以上的文档，统计每个类别的文档数量。","schema":["CREATE TABLE research_docs (doc_id INT PRIMARY KEY, title TEXT, author TEXT, category TEXT, file_size INT, created_date DATE, updated_date DATE, version TEXT, status TEXT, tags TEXT, description TEXT);"],"ground_truth":"SELECT category, COUNT(*) as count FROM research_docs WHERE CAST(SUBSTR(version, 2) AS REAL) >= 2.0 GROUP BY category;"}
{"question":"统计2023年每个月创建的文档数量，只显示创建数量超过20的月份，按月份排序。","schema":["CREATE TABLE research_docs (doc_id INT PRIMARY KEY, title TEXT, author TEXT, category TEXT, file_size INT, created_date DATE, updated_date DATE, version TEXT, status TEXT, tags TEXT, description TEXT);"],"ground_truth":"SELECT strftime('%Y-%m', created_date) as month, COUNT(*) as count FROM research_docs WHERE strftime('%Y', created_date) = '2023' GROUP BY month HAVING COUNT(*) > 20 ORDER BY month;"}
{"question":"查询标签中包含'机器学习'的文档，显示文档ID、标题、作者和创建日期，按创建日期降序排列，显示前30条。","schema":["CREATE TABLE research_docs (doc_id INT PRIMARY KEY, title TEXT, author TEXT, category TEXT, file_size INT, created_date DATE, updated_date DATE, version TEXT, status TEXT, tags TEXT, description TEXT);"],"ground_truth":"SELECT doc_id, title, author, created_date FROM research_docs WHERE tags LIKE '%机器学习%' ORDER BY created_date DESC LIMIT 30;"}
{"question":"找出更新日期距离创建日期超过1年的文档，显示文档ID、标题、创建日期和更新日期。","schema":["CREATE TABLE research_docs (doc_id INT PRIMARY KEY, title TEXT, author TEXT, category TEXT, file_size INT, created_date DATE, updated_date DATE, version TEXT, status TEXT, tags TEXT, description TEXT);"],"ground_truth":"SELECT doc_id, title, created_date, updated_date FROM research_docs WHERE julianday(updated_date) - julianday(created_date) > 365;"}
{"question":"统计每个类别中不同状态的文档数量，使用透视表格式显示。","schema":["CREATE TABLE research_docs (doc_id INT PRIMARY KEY, title TEXT, author TEXT, category TEXT, file_size INT, created_date DATE, updated_date DATE, version TEXT, status TEXT, tags TEXT, description TEXT);"],"ground_truth":"SELECT category, SUM(CASE WHEN status = 'draft' THEN 1 ELSE 0 END) as draft_count, SUM(CASE WHEN status = 'published' THEN 1 ELSE 0 END) as published_count, SUM(CASE WHEN status = 'archived' THEN 1 ELSE 0 END) as archived_count FROM research_docs GROUP BY category;"}
{"question":"查询文件大小在1MB到10MB之间的文档，按类别统计数量和总大小，按总大小降序排列。","schema":["CREATE TABLE research_docs (doc_id INT PRIMARY KEY, title TEXT, author TEXT, category TEXT, file_size INT, created_date DATE, updated_date DATE, version TEXT, status TEXT, tags TEXT, description TEXT);"],"ground_truth":"SELECT category, COUNT(*) as count, SUM(file_size) as total_size FROM research_docs WHERE file_size BETWEEN 1048576 AND 10485760 GROUP BY category ORDER BY total_size DESC;"}
{"question":"找出每个作者在2023年创建的文档总大小，只显示总大小超过50MB的作者，按总大小降序排列。","schema":["CREATE TABLE research_docs (doc_id INT PRIMARY KEY, title TEXT, author TEXT, category TEXT, file_size INT, created_date DATE, updated_date DATE, version TEXT, status TEXT, tags TEXT, description TEXT);"],"ground_truth":"SELECT author, SUM(file_size) as total_size FROM research_docs WHERE strftime('%Y', created_date) = '2023' GROUP BY author HAVING SUM(file_size) > 52428800 ORDER BY total_size DESC;"}
{"question":"查询描述长度大于100个字符的文档，显示文档ID、标题和描述长度，按描述长度降序排列。","schema":["CREATE TABLE research_docs (doc_id INT PRIMARY KEY, title TEXT, author TEXT, category TEXT, file_size INT, created_date DATE, updated_date DATE, version TEXT, status TEXT, tags TEXT, description TEXT);"],"ground_truth":"SELECT doc_id, title, LENGTH(description) as desc_length FROM research_docs WHERE LENGTH(description) > 100 ORDER BY desc_length DESC;"}
{"question":"统计每个类别中文件大小最大的文档，显示类别、文档ID、标题和大小。","schema":["CREATE TABLE research_docs (doc_id INT PRIMARY KEY, title TEXT, author TEXT, category TEXT, file_size INT, created_date DATE, updated_date DATE, version TEXT, status TEXT, tags TEXT, description TEXT);"],"ground_truth":"SELECT category, doc_id, title, file_size FROM research_docs r1 WHERE file_size = (SELECT MAX(file_size) FROM research_docs r2 WHERE r2.category = r1.category);"}
{"question":"查询创建时间在周末的文档，统计每个类别的文档数量。","schema":["CREATE TABLE research_docs (doc_id INT PRIMARY KEY, title TEXT, author TEXT, category TEXT, file_size INT, created_date DATE, updated_date DATE, version TEXT, status TEXT, tags TEXT, description TEXT);"],"ground_truth":"SELECT category, COUNT(*) as count FROM research_docs WHERE strftime('%w', created_date) IN ('0', '6') GROUP BY category;"}
{"question":"找出标题长度大于30个字符且文件大小小于500KB的文档，显示文档ID、标题和文件大小。","schema":["CREATE TABLE research_docs (doc_id INT PRIMARY KEY, title TEXT, author TEXT, category TEXT, file_size INT, created_date DATE, updated_date DATE, version TEXT, status TEXT, tags TEXT, description TEXT);"],"ground_truth":"SELECT doc_id, title, file_size FROM research_docs WHERE LENGTH(title) > 30 AND file_size < 512000 ORDER BY file_size ASC;"}
{"question":"查询最近7天内访问的用户交互日志，统计每个用户的操作次数，只显示操作次数超过50的用户，按操作次数降序排列。","schema":["CREATE TABLE user_interaction_logs (log_id INT PRIMARY KEY, user_id INT, action_type TEXT, page_url TEXT, session_id TEXT, timestamp TIMESTAMP, ip_address TEXT, device_type TEXT, browser TEXT, duration INT, status_code INT);"],"ground_truth":"SELECT user_id, COUNT(*) as action_count FROM user_interaction_logs WHERE timestamp >= datetime('now', '-7 days') GROUP BY user_id HAVING COUNT(*) > 50 ORDER BY action_count DESC;"}
{"question":"统计每个操作类型（action_type）的日志数量和平均操作时长，按日志数量降序排列。","schema":["CREATE TABLE user_interaction_logs (log_id INT PRIMARY KEY, user_id INT, action_type TEXT, page_url TEXT, session_id TEXT, timestamp TIMESTAMP, ip_address TEXT, device_type TEXT, browser TEXT, duration INT, status_code INT);"],"ground_truth":"SELECT action_type, COUNT(*) as log_count, AVG(duration) as avg_duration FROM user_interaction_logs GROUP BY action_type ORDER BY log_count DESC;"}
{"question":"查询状态码为200且操作时长超过5秒的日志，显示日志ID、用户ID、操作类型和时长，按时长降序排列，显示前100条。","schema":["CREATE TABLE user_interaction_logs (log_id INT PRIMARY KEY, user_id INT, action_type TEXT, page_url TEXT, session_id TEXT, timestamp TIMESTAMP, ip_address TEXT, device_type TEXT, browser TEXT, duration INT, status_code INT);"],"ground_truth":"SELECT log_id, user_id, action_type, duration FROM user_interaction_logs WHERE status_code = 200 AND duration > 5 ORDER BY duration DESC LIMIT 100;"}
{"question":"找出每个会话（session_id）中的操作次数和总时长，只显示操作次数大于10的会话，按总时长降序排列。","schema":["CREATE TABLE user_interaction_logs (log_id INT PRIMARY KEY, user_id INT, action_type TEXT, page_url TEXT, session_id TEXT, timestamp TIMESTAMP, ip_address TEXT, device_type TEXT, browser TEXT, duration INT, status_code INT);"],"ground_truth":"SELECT session_id, COUNT(*) as action_count, SUM(duration) as total_duration FROM user_interaction_logs GROUP BY session_id HAVING COUNT(*) > 10 ORDER BY total_duration DESC;"}
{"question":"统计每个设备类型的日志数量和平均操作时长，按日志数量降序排列。","schema":["CREATE TABLE user_interaction_logs (log_id INT PRIMARY KEY, user_id INT, action_type TEXT, page_url TEXT, session_id TEXT, timestamp TIMESTAMP, ip_address TEXT, device_type TEXT, browser TEXT, duration INT, status_code INT);"],"ground_truth":"SELECT device_type, COUNT(*) as log_count, AVG(duration) as avg_duration FROM user_interaction_logs GROUP BY device_type ORDER BY log_count DESC;"}
{"question":"查询2023年每个月的日志数量，只显示日志数量超过10000的月份，按月份排序。","schema":["CREATE TABLE user_interaction_logs (log_id INT PRIMARY KEY, user_id INT, action_type TEXT, page_url TEXT, session_id TEXT, timestamp TIMESTAMP, ip_address TEXT, device_type TEXT, browser TEXT, duration INT, status_code INT);"],"ground_truth":"SELECT strftime('%Y-%m', timestamp) as month, COUNT(*) as log_count FROM user_interaction_logs WHERE strftime('%Y', timestamp) = '2023' GROUP BY month HAVING COUNT(*) > 10000 ORDER BY month;"}
{"question":"找出操作时长在平均值以上的日志，按用户ID分组统计数量，只显示数量大于20的用户。","schema":["CREATE TABLE user_interaction_logs (log_id INT PRIMARY KEY, user_id INT, action_type TEXT, page_url TEXT, session_id TEXT, timestamp TIMESTAMP, ip_address TEXT, device_type TEXT, browser TEXT, duration INT, status_code INT);"],"ground_truth":"SELECT user_id, COUNT(*) as count FROM user_interaction_logs WHERE duration > (SELECT AVG(duration) FROM user_interaction_logs) GROUP BY user_id HAVING COUNT(*) > 20;"}
{"question":"查询页面URL包含'product'的日志，统计每个操作类型的日志数量。","schema":["CREATE TABLE user_interaction_logs (log_id INT PRIMARY KEY, user_id INT, action_type TEXT, page_url TEXT, session_id TEXT, timestamp TIMESTAMP, ip_address TEXT, device_type TEXT, browser TEXT, duration INT, status_code INT);"],"ground_truth":"SELECT action_type, COUNT(*) as count FROM user_interaction_logs WHERE page_url LIKE '%product%' GROUP BY action_type;"}
{"question":"统计每个浏览器在不同设备类型下的日志数量，使用交叉表格式显示。","schema":["CREATE TABLE user_interaction_logs (log_id INT PRIMARY KEY, user_id INT, action_type TEXT, page_url TEXT, session_id TEXT, timestamp TIMESTAMP, ip_address TEXT, device_type TEXT, browser TEXT, duration INT, status_code INT);"],"ground_truth":"SELECT browser, SUM(CASE WHEN device_type = 'desktop' THEN 1 ELSE 0 END) as desktop_count, SUM(CASE WHEN device_type = 'mobile' THEN 1 ELSE 0 END) as mobile_count, SUM(CASE WHEN device_type = 'tablet' THEN 1 ELSE 0 END) as tablet_count FROM user_interaction_logs GROUP BY browser;"}
{"question":"查询IP地址以192.168开头的日志，找出每个用户的操作次数，按操作次数降序排列，显示前50个用户。","schema":["CREATE TABLE user_interaction_logs (log_id INT PRIMARY KEY, user_id INT, action_type TEXT, page_url TEXT, session_id TEXT, timestamp TIMESTAMP, ip_address TEXT, device_type TEXT, browser TEXT, duration INT, status_code INT);"],"ground_truth":"SELECT user_id, COUNT(*) as action_count FROM user_interaction_logs WHERE ip_address LIKE '192.168%' GROUP BY user_id ORDER BY action_count DESC LIMIT 50;"}
{"question":"找出每个用户操作时长最长的日志，显示用户ID、日志ID、操作类型和时长。","schema":["CREATE TABLE user_interaction_logs (log_id INT PRIMARY KEY, user_id INT, action_type TEXT, page_url TEXT, session_id TEXT, timestamp TIMESTAMP, ip_address TEXT, device_type TEXT, browser TEXT, duration INT, status_code INT);"],"ground_truth":"SELECT user_id, log_id, action_type, duration FROM user_interaction_logs l1 WHERE duration = (SELECT MAX(duration) FROM user_interaction_logs l2 WHERE l2.user_id = l1.user_id);"}
{"question":"查询状态码不为200的日志，统计每个状态码的日志数量和平均操作时长。","schema":["CREATE TABLE user_interaction_logs (log_id INT PRIMARY KEY, user_id INT, action_type TEXT, page_url TEXT, session_id TEXT, timestamp TIMESTAMP, ip_address TEXT, device_type TEXT, browser TEXT, duration INT, status_code INT);"],"ground_truth":"SELECT status_code, COUNT(*) as count, AVG(duration) as avg_duration FROM user_interaction_logs WHERE status_code != 200 GROUP BY status_code ORDER BY count DESC;"}
{"question":"统计2023年每个季度的日志总数量和平均操作时长，按季度排序。","schema":["CREATE TABLE user_interaction_logs (log_id INT PRIMARY KEY, user_id INT, action_type TEXT, page_url TEXT, session_id TEXT, timestamp TIMESTAMP, ip_address TEXT, device_type TEXT, browser TEXT, duration INT, status_code INT);"],"ground_truth":"SELECT CASE WHEN strftime('%m', timestamp) IN ('01','02','03') THEN 'Q1' WHEN strftime('%m', timestamp) IN ('04','05','06') THEN 'Q2' WHEN strftime('%m', timestamp) IN ('07','08','09') THEN 'Q3' ELSE 'Q4' END as quarter, COUNT(*) as total_count, AVG(duration) as avg_duration FROM user_interaction_logs WHERE strftime('%Y', timestamp) = '2023' GROUP BY quarter ORDER BY quarter;"}
{"question":"查询操作类型为'click'或'view'的日志，按设备类型统计数量和平均时长，按数量降序排列。","schema":["CREATE TABLE user_interaction_logs (log_id INT PRIMARY KEY, user_id INT, action_type TEXT, page_url TEXT, session_id TEXT, timestamp TIMESTAMP, ip_address TEXT, device_type TEXT, browser TEXT, duration INT, status_code INT);"],"ground_truth":"SELECT device_type, COUNT(*) as count, AVG(duration) as avg_duration FROM user_interaction_logs WHERE action_type IN ('click', 'view') GROUP BY device_type ORDER BY count DESC;"}
{"question":"找出每个会话中操作时长最长的日志，显示会话ID、日志ID、操作类型和时长，按时长降序排列。","schema":["CREATE TABLE user_interaction_logs (log_id INT PRIMARY KEY, user_id INT, action_type TEXT, page_url TEXT, session_id TEXT, timestamp TIMESTAMP, ip_address TEXT, device_type TEXT, browser TEXT, duration INT, status_code INT);"],"ground_truth":"SELECT session_id, log_id, action_type, duration FROM user_interaction_logs l1 WHERE duration = (SELECT MAX(duration) FROM user_interaction_logs l2 WHERE l2.session_id = l1.session_id) ORDER BY duration DESC;"}
{"question":"查询最近24小时内的日志，统计每个小时的日志数量，按小时排序。","schema":["CREATE TABLE user_interaction_logs (log_id INT PRIMARY KEY, user_id INT, action_type TEXT, page_url TEXT, session_id TEXT, timestamp TIMESTAMP, ip_address TEXT, device_type TEXT, browser TEXT, duration INT, status_code INT);"],"ground_truth":"SELECT strftime('%Y-%m-%d %H:00:00', timestamp) as hour, COUNT(*) as count FROM user_interaction_logs WHERE timestamp >= datetime('now', '-24 hours') GROUP BY hour ORDER BY hour;"}
{"question":"统计每个操作类型在不同设备类型下的平均操作时长，使用透视表格式显示。","schema":["CREATE TABLE user_interaction_logs (log_id INT PRIMARY KEY, user_id INT, action_type TEXT, page_url TEXT, session_id TEXT, timestamp TIMESTAMP, ip_address TEXT, device_type TEXT, browser TEXT, duration INT, status_code INT);"],"ground_truth":"SELECT action_type, AVG(CASE WHEN device_type = 'desktop' THEN duration END) as desktop_avg, AVG(CASE WHEN device_type = 'mobile' THEN duration END) as mobile_avg, AVG(CASE WHEN device_type = 'tablet' THEN duration END) as tablet_avg FROM user_interaction_logs GROUP BY action_type;"}
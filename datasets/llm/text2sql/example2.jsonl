{"question":"查询每个国家在2023年注册的用户数量user_count，并按数量降序排列。","schema":["CREATE TABLE users (user_id INT, username TEXT, country TEXT, registration_date DATE);"],"ground_truth":"SELECT country, COUNT(*) as user_count FROM users WHERE EXTRACT(YEAR FROM registration_date) = 2023 GROUP BY country ORDER BY user_count DESC;"}
{"question":"查询年龄大于30且最后登录时间在2023年之后的用户ID和用户名。","schema":["CREATE TABLE user_sessions (user_id INT, username TEXT, age INT, last_login TIMESTAMP);"],"ground_truth":"SELECT user_id, username FROM user_sessions WHERE age > 30 AND last_login >= '2023-01-01';"}
{"question":"查询每个国家的用户平均年龄avg_age，并只显示平均年龄大于25的国家。","schema":["CREATE TABLE users (user_id INT, country TEXT, age INT);"],"ground_truth":"SELECT country, AVG(age) as avg_age FROM users GROUP BY country HAVING AVG(age) > 25;"}
{"question":"查询注册日期最早的前10名用户的用户名和注册日期。","schema":["CREATE TABLE user_accounts (account_id INT, username TEXT, signup_date DATE);"],"ground_truth":"SELECT username, signup_date FROM user_accounts ORDER BY signup_date ASC LIMIT 10;"}
{"question":"查询2023年每个月month的用户注册数量user_count，并按月份升序排列。","schema":["CREATE TABLE users (user_id INT, registration_date DATE);"],"ground_truth":"SELECT EXTRACT(MONTH FROM registration_date) as month, COUNT(*) as user_count FROM users WHERE EXTRACT(YEAR FROM registration_date) = 2023 GROUP BY EXTRACT(MONTH FROM registration_date) ORDER BY month;"}
{"question":"查询年龄小于18或大于60的用户姓名和年龄，并按年龄排序。","schema":["CREATE TABLE users (user_id INT, name TEXT, age INT);"],"ground_truth":"SELECT name, age FROM users WHERE age < 18 OR age > 60 ORDER BY age;"}
{"question":"查询用户表中没有邮箱地址的用户姓名。","schema":["CREATE TABLE users (user_id INT, name TEXT, email TEXT);"],"ground_truth":"SELECT name FROM users WHERE email IS NULL OR email = '';"}
{"question":"查询每个国家活跃用户（is_active为true）的数量active_users。","schema":["CREATE TABLE users (user_id INT, country TEXT, is_active BOOLEAN);"],"ground_truth":"SELECT country, COUNT(*) as active_users FROM users WHERE is_active = TRUE GROUP BY country;"}
{"question":"查询用户名中包含'admin'的用户ID和用户名。","schema":["CREATE TABLE users (user_id INT, username TEXT);"],"ground_truth":"SELECT user_id, username FROM users WHERE username LIKE '%admin%';"}
{"question":"查询每个用户的最后一次登录时间last_login。","schema":["CREATE TABLE login_logs (user_id INT, login_time TIMESTAMP);"],"ground_truth":"SELECT user_id, MAX(login_time) as last_login FROM login_logs GROUP BY user_id;"}
{"question":"查询年龄在20到40之间的用户，并按注册日期升序排列。","schema":["CREATE TABLE users (user_id INT, name TEXT, age INT, registration_date DATE);"],"ground_truth":"SELECT * FROM users WHERE age BETWEEN 20 AND 40 ORDER BY registration_date ASC;"}
{"question":"查询每个国家的用户数量user_count，并计算占所有国家总用户数的百分比percentage。","schema":["CREATE TABLE users (user_id INT, country TEXT);"],"ground_truth":"SELECT country, COUNT(*) as user_count, (COUNT(*) * 100.0 / (SELECT COUNT(*) FROM users)) as percentage FROM users GROUP BY country;"}
{"question":"查询注册日期在周末（星期六或星期日）的用户姓名和注册日期。","schema":["CREATE TABLE users (user_id INT, name TEXT, registration_date DATE);"],"ground_truth":"SELECT name, registration_date FROM users WHERE EXTRACT(DOW FROM registration_date) IN (0, 6);"}
{"question":"查询每个年龄的用户数量user_count，并只显示数量大于5的年龄。","schema":["CREATE TABLE users (user_id INT, age INT);"],"ground_truth":"SELECT age, COUNT(*) as user_count FROM users GROUP BY age HAVING COUNT(*) > 5;"}
{"question":"查询最后登录时间在最近7天内的用户ID和登录时间。","schema":["CREATE TABLE login_logs (user_id INT, login_time TIMESTAMP);"],"ground_truth":"SELECT user_id, login_time FROM login_logs WHERE login_time >= CURRENT_DATE - INTERVAL '7 days';"}
{"question":"查询邮箱地址以'gmail.com'结尾的用户姓名和邮箱。","schema":["CREATE TABLE users (user_id INT, name TEXT, email TEXT);"],"ground_truth":"SELECT name, email FROM users WHERE email LIKE '%gmail.com';"}
{"question":"查询每个国家的最大年龄用户及其年龄。","schema":["CREATE TABLE users (user_id INT, name TEXT, country TEXT, age INT);"],"ground_truth":"SELECT country, name, MAX(age) as max_age FROM users GROUP BY country, name;"}
{"question":"查询用户表中重复的用户名及其出现次数。","schema":["CREATE TABLE users (user_id INT, username TEXT);"],"ground_truth":"SELECT username, COUNT(*) as occurrence FROM users GROUP BY username HAVING COUNT(*) > 1;"}
{"question":"查询注册日期和最后登录日期相同的用户ID和日期。","schema":["CREATE TABLE users (user_id INT, registration_date DATE, last_login_date DATE);"],"ground_truth":"SELECT user_id, registration_date FROM users WHERE registration_date = last_login_date;"}
{"question":"查询每个国家的用户年龄的标准差。","schema":["CREATE TABLE users (user_id INT, country TEXT, age INT);"],"ground_truth":"SELECT country, STDDEV(age) as age_stddev FROM users GROUP BY country;"}
{"question":"查询年龄大于所有用户平均年龄的用户姓名和年龄。","schema":["CREATE TABLE users (user_id INT, name TEXT, age INT);"],"ground_truth":"SELECT name, age FROM users WHERE age > (SELECT AVG(age) FROM users);"}
{"question":"查询用户名长度超过10个字符的用户姓名。","schema":["CREATE TABLE users (user_id INT, username TEXT);"],"ground_truth":"SELECT username FROM users WHERE LENGTH(username) > 10;"}
{"question":"查询每个国家的用户注册趋势，按年份统计数量。","schema":["CREATE TABLE users (user_id INT, country TEXT, registration_date DATE);"],"ground_truth":"SELECT country, EXTRACT(YEAR FROM registration_date) as year, COUNT(*) as user_count FROM users GROUP BY country, EXTRACT(YEAR FROM registration_date) ORDER BY country, year;"}
{"question":"查询用户表中年龄为NULL的用户ID。","schema":["CREATE TABLE users (user_id INT, age INT);"],"ground_truth":"SELECT user_id FROM users WHERE age IS NULL;"}
{"question":"查询2023年每个月的订单总金额。","schema":["CREATE TABLE orders (order_id INT, order_date DATE, amount DECIMAL(10,2));"],"ground_truth":"SELECT EXTRACT(MONTH FROM order_date) as month, SUM(amount) as total_amount FROM orders WHERE EXTRACT(YEAR FROM order_date) = 2023 GROUP BY EXTRACT(MONTH FROM order_date) ORDER BY month;"}
{"question":"查询状态为'completed'且金额超过1000的订单数量。","schema":["CREATE TABLE orders (order_id INT, status TEXT, amount DECIMAL(10,2));"],"ground_truth":"SELECT COUNT(*) as order_count FROM orders WHERE status = 'completed' AND amount > 1000;"}
{"question":"查询每个用户的订单总数和总金额。","schema":["CREATE TABLE orders (order_id INT, user_id INT, amount DECIMAL(10,2));"],"ground_truth":"SELECT user_id, COUNT(*) as order_count, SUM(amount) as total_amount FROM orders GROUP BY user_id;"}
{"question":"查询订单金额最高的前10个订单的订单ID和金额。","schema":["CREATE TABLE orders (order_id INT, amount DECIMAL(10,2));"],"ground_truth":"SELECT order_id, amount FROM orders ORDER BY amount DESC LIMIT 10;"}
{"question":"查询每个支付方式的订单数量。","schema":["CREATE TABLE orders (order_id INT, payment_method TEXT);"],"ground_truth":"SELECT payment_method, COUNT(*) as order_count FROM orders GROUP BY payment_method;"}
{"question":"查询订单日期在节假日（例如2023-12-25）内的订单ID和日期。","schema":["CREATE TABLE orders (order_id INT, order_date DATE);"],"ground_truth":"SELECT order_id, order_date FROM orders WHERE order_date = '2023-12-25';"}
{"question":"查询每个用户的平均订单金额。","schema":["CREATE TABLE orders (order_id INT, user_id INT, amount DECIMAL(10,2));"],"ground_truth":"SELECT user_id, AVG(amount) as avg_amount FROM orders GROUP BY user_id;"}
{"question":"查询订单状态分布，显示每个状态的订单数量。","schema":["CREATE TABLE orders (order_id INT, status TEXT);"],"ground_truth":"SELECT status, COUNT(*) as order_count FROM orders GROUP BY status;"}
{"question":"查询最近一周内的订单ID和订单日期。","schema":["CREATE TABLE orders (order_id INT, order_date DATE);"],"ground_truth":"SELECT order_id, order_date FROM orders WHERE order_date >= CURRENT_DATE - INTERVAL '7 days';"}
{"question":"查询订单金额大于平均订单金额的订单ID和金额。","schema":["CREATE TABLE orders (order_id INT, amount DECIMAL(10,2));"],"ground_truth":"SELECT order_id, amount FROM orders WHERE amount > (SELECT AVG(amount) FROM orders);"}
{"question":"查询2023年每个月的订单数量变化。","schema":["CREATE TABLE orders (order_id INT, order_date DATE);"],"ground_truth":"SELECT EXTRACT(MONTH FROM order_date) as month, COUNT(*) as order_count FROM orders WHERE EXTRACT(YEAR FROM order_date) = 2023 GROUP BY EXTRACT(MONTH FROM order_date) ORDER BY month;"}
{"question":"查询用户ID为1001的所有订单ID和金额。","schema":["CREATE TABLE orders (order_id INT, user_id INT, amount DECIMAL(10,2));"],"ground_truth":"SELECT order_id, amount FROM orders WHERE user_id = 1001;"}
{"question":"查询订单金额最低的5个订单的订单ID和金额。","schema":["CREATE TABLE orders (order_id INT, amount DECIMAL(10,2));"],"ground_truth":"SELECT order_id, amount FROM orders ORDER BY amount ASC LIMIT 5;"}
{"question":"查询每个订单状态的订单总金额。","schema":["CREATE TABLE orders (order_id INT, status TEXT, amount DECIMAL(10,2));"],"ground_truth":"SELECT status, SUM(amount) as total_amount FROM orders GROUP BY status;"}
{"question":"查询订单日期和发货日期相同的订单ID。","schema":["CREATE TABLE orders (order_id INT, order_date DATE, ship_date DATE);"],"ground_truth":"SELECT order_id FROM orders WHERE order_date = ship_date;"}
{"question":"查询每个用户的第一次订单日期。","schema":["CREATE TABLE orders (order_id INT, user_id INT, order_date DATE);"],"ground_truth":"SELECT user_id, MIN(order_date) as first_order_date FROM orders GROUP BY user_id;"}
{"question":"查询订单金额在500到1000之间的订单ID和金额。","schema":["CREATE TABLE orders (order_id INT, amount DECIMAL(10,2));"],"ground_truth":"SELECT order_id, amount FROM orders WHERE amount BETWEEN 500 AND 1000;"}
{"question":"查询每个支付方式的总金额。","schema":["CREATE TABLE orders (order_id INT, payment_method TEXT, amount DECIMAL(10,2));"],"ground_truth":"SELECT payment_method, SUM(amount) as total_amount FROM orders GROUP BY payment_method;"}
{"question":"查询订单表中重复的订单（基于用户ID和订单日期）。","schema":["CREATE TABLE orders (order_id INT, user_id INT, order_date DATE);"],"ground_truth":"SELECT user_id, order_date, COUNT(*) as duplicate_count FROM orders GROUP BY user_id, order_date HAVING COUNT(*) > 1;"}
{"question":"查询每个用户的订单频率（平均每天订单数）。","schema":["CREATE TABLE orders (order_id INT, user_id INT, order_date DATE);"],"ground_truth":"SELECT user_id, COUNT(*) / COUNT(DISTINCT order_date) as avg_orders_per_day FROM orders GROUP BY user_id;"}
{"question":"查询订单状态为'pending'且订单日期超过30天的订单ID。","schema":["CREATE TABLE orders (order_id INT, status TEXT, order_date DATE);"],"ground_truth":"SELECT order_id FROM orders WHERE status = 'pending' AND order_date < CURRENT_DATE - INTERVAL '30 days';"}
{"question":"查询每个产品ID的订单数量。","schema":["CREATE TABLE orders (order_id INT, product_id INT);"],"ground_truth":"SELECT product_id, COUNT(*) as order_count FROM orders GROUP BY product_id;"}
{"question":"查询订单金额的分布，按金额范围分组（例如0-100, 101-500等）。","schema":["CREATE TABLE orders (order_id INT, amount DECIMAL(10,2));"],"ground_truth":"SELECT CASE WHEN amount <= 100 THEN '0-100' WHEN amount <= 500 THEN '101-500' ELSE '500+' END as amount_range, COUNT(*) as order_count FROM orders GROUP BY CASE WHEN amount <= 100 THEN '0-100' WHEN amount <= 500 THEN '101-500' ELSE '500+' END;"}
{"question":"查询每个用户的最后一次订单日期。","schema":["CREATE TABLE orders (order_id INT, user_id INT, order_date DATE);"],"ground_truth":"SELECT user_id, MAX(order_date) as last_order_date FROM orders GROUP BY user_id;"}
{"question":"查询订单表中没有用户ID的订单ID。","schema":["CREATE TABLE orders (order_id INT, user_id INT);"],"ground_truth":"SELECT order_id FROM orders WHERE user_id IS NULL;"}
{"question":"查询每个作者创建的文档数量。","schema":["CREATE TABLE documents (doc_id INT, author TEXT);"],"ground_truth":"SELECT author, COUNT(*) as doc_count FROM documents GROUP BY author;"}
{"question":"查询最近一个月内修改过的文档标题和修改日期。","schema":["CREATE TABLE documents (doc_id INT, title TEXT, modified_date DATE);"],"ground_truth":"SELECT title, modified_date FROM documents WHERE modified_date >= CURRENT_DATE - INTERVAL '1 month';"}
{"question":"查询每个类别的文档平均版本号。","schema":["CREATE TABLE documents (doc_id INT, category TEXT, version INT);"],"ground_truth":"SELECT category, AVG(version) as avg_version FROM documents GROUP BY category;"}
{"question":"查询标题包含'设计'的文档ID和标题。","schema":["CREATE TABLE documents (doc_id INT, title TEXT);"],"ground_truth":"SELECT doc_id, title FROM documents WHERE title LIKE '%设计%';"}
{"question":"查询每个项目的文档数量。","schema":["CREATE TABLE documents (doc_id INT, project_id INT);"],"ground_truth":"SELECT project_id, COUNT(*) as doc_count FROM documents GROUP BY project_id;"}
{"question":"查询创建日期在2023年的文档标题和创建日期。","schema":["CREATE TABLE documents (doc_id INT, title TEXT, created_date DATE);"],"ground_truth":"SELECT title, created_date FROM documents WHERE EXTRACT(YEAR FROM created_date) = 2023;"}
{"question":"查询每个作者的文档总浏览量。","schema":["CREATE TABLE documents (doc_id INT, author TEXT, views INT);"],"ground_truth":"SELECT author, SUM(views) as total_views FROM documents GROUP BY author;"}
{"question":"查询版本号大于5的文档ID和版本号。","schema":["CREATE TABLE documents (doc_id INT, version INT);"],"ground_truth":"SELECT doc_id, version FROM documents WHERE version > 5;"}
{"question":"查询每个类别的文档中，最新修改的文档标题。","schema":["CREATE TABLE documents (doc_id INT, title TEXT, category TEXT, modified_date DATE);"],"ground_truth":"SELECT category, title, modified_date FROM documents d1 WHERE modified_date = (SELECT MAX(modified_date) FROM documents d2 WHERE d2.category = d1.category);"}
{"question":"查询文档中标题长度超过50个字符的文档ID和标题。","schema":["CREATE TABLE documents (doc_id INT, title TEXT);"],"ground_truth":"SELECT doc_id, title FROM documents WHERE LENGTH(title) > 50;"}
{"question":"查询每个作者的文档平均创建间隔（按天计算）。","schema":["CREATE TABLE documents (doc_id INT, author TEXT, created_date DATE);"],"ground_truth":"SELECT author, AVG(created_date - LAG(created_date) OVER (PARTITION BY author ORDER BY created_date)) as avg_interval FROM documents GROUP BY author;"}
{"question":"查询文档表中重复的标题及其出现次数。","schema":["CREATE TABLE documents (doc_id INT, title TEXT);"],"ground_truth":"SELECT title, COUNT(*) as occurrence FROM documents GROUP BY title HAVING COUNT(*) > 1;"}
{"question":"查询每个类别的文档数量，并只显示数量大于10的类别。","schema":["CREATE TABLE documents (doc_id INT, category TEXT);"],"ground_truth":"SELECT category, COUNT(*) as doc_count FROM documents GROUP BY category HAVING COUNT(*) > 10;"}
{"question":"查询文档的创建年份分布。","schema":["CREATE TABLE documents (doc_id INT, created_date DATE);"],"ground_truth":"SELECT EXTRACT(YEAR FROM created_date) as year, COUNT(*) as doc_count FROM documents GROUP BY EXTRACT(YEAR FROM created_date) ORDER BY year;"}
{"question":"查询作者为'张三'的所有文档标题和创建日期。","schema":["CREATE TABLE documents (doc_id INT, title TEXT, author TEXT, created_date DATE);"],"ground_truth":"SELECT title, created_date FROM documents WHERE author = '张三';"}
{"question":"查询每个文档的修改次数（基于修改日期是否多次）。","schema":["CREATE TABLE documents (doc_id INT, modified_date DATE);"],"ground_truth":"SELECT doc_id, COUNT(DISTINCT modified_date) as modification_count FROM documents GROUP BY doc_id;"}
{"question":"查询创建日期和修改日期相同的文档ID。","schema":["CREATE TABLE documents (doc_id INT, created_date DATE, modified_date DATE);"],"ground_truth":"SELECT doc_id FROM documents WHERE created_date = modified_date;"}
{"question":"查询每个文档的版本升级情况（版本号增加）。","schema":["CREATE TABLE documents (doc_id INT, version INT);"],"ground_truth":"SELECT doc_id, version FROM documents WHERE version > 1;"}
{"question":"查询文档表中没有类别的文档ID。","schema":["CREATE TABLE documents (doc_id INT, category TEXT);"],"ground_truth":"SELECT doc_id FROM documents WHERE category IS NULL OR category = '';"}
{"question":"查询每个作者的文档中，版本号最高的文档标题。","schema":["CREATE TABLE documents (doc_id INT, author TEXT, title TEXT, version INT);"],"ground_truth":"SELECT author, title, version FROM documents d1 WHERE version = (SELECT MAX(version) FROM documents d2 WHERE d2.author = d1.author);"}
{"question":"查询文档的浏览量排名前10的文档标题和浏览量。","schema":["CREATE TABLE documents (doc_id INT, title TEXT, views INT);"],"ground_truth":"SELECT title, views FROM documents ORDER BY views DESC LIMIT 10;"}
{"question":"查询每个类别的平均文档年龄（从创建日期到当前日期的天数）。","schema":["CREATE TABLE documents (doc_id INT, category TEXT, created_date DATE);"],"ground_truth":"SELECT category, AVG(CURRENT_DATE - created_date) as avg_age_days FROM documents GROUP BY category;"}
{"question":"查询文档表中作者为空的文档ID。","schema":["CREATE TABLE documents (doc_id INT, author TEXT);"],"ground_truth":"SELECT doc_id FROM documents WHERE author IS NULL;"}
{"question":"查询每个项目的文档总浏览量。","schema":["CREATE TABLE documents (doc_id INT, project_id INT, views INT);"],"ground_truth":"SELECT project_id, SUM(views) as total_views FROM documents GROUP BY project_id;"}
{"question":"查询文档标题以'报告'结尾的文档ID和标题。","schema":["CREATE TABLE documents (doc_id INT, title TEXT);"],"ground_truth":"SELECT doc_id, title FROM documents WHERE title LIKE '%报告';"}
{"question":"查询每个用户的操作日志数量。","schema":["CREATE TABLE interaction_logs (log_id INT, user_id INT);"],"ground_truth":"SELECT user_id, COUNT(*) as log_count FROM interaction_logs GROUP BY user_id;"}
{"question":"查询在2023-10-01这天内的所有日志ID和时间戳。","schema":["CREATE TABLE interaction_logs (log_id INT, timestamp TIMESTAMP);"],"ground_truth":"SELECT log_id, timestamp FROM interaction_logs WHERE DATE(timestamp) = '2023-10-01';"}
{"question":"查询每个操作类型的次数。","schema":["CREATE TABLE interaction_logs (log_id INT, action TEXT);"],"ground_truth":"SELECT action, COUNT(*) as action_count FROM interaction_logs GROUP BY action;"}
{"question":"查询操作次数最多的用户ID和操作次数。","schema":["CREATE TABLE interaction_logs (log_id INT, user_id INT);"],"ground_truth":"SELECT user_id, COUNT(*) as action_count FROM interaction_logs GROUP BY user_id ORDER BY action_count DESC LIMIT 1;"}
{"question":"查询每个会话的日志数量。","schema":["CREATE TABLE interaction_logs (log_id INT, session_id TEXT);"],"ground_truth":"SELECT session_id, COUNT(*) as log_count FROM interaction_logs GROUP BY session_id;"}
{"question":"查询来自特定IP地址'192.168.1.1'的日志ID和时间戳。","schema":["CREATE TABLE interaction_logs (log_id INT, ip_address TEXT, timestamp TIMESTAMP);"],"ground_truth":"SELECT log_id, timestamp FROM interaction_logs WHERE ip_address = '192.168.1.1';"}
{"question":"查询每个小时的操作频率（基于时间戳）。","schema":["CREATE TABLE interaction_logs (log_id INT, timestamp TIMESTAMP);"],"ground_truth":"SELECT EXTRACT(HOUR FROM timestamp) as hour, COUNT(*) as action_count FROM interaction_logs GROUP BY EXTRACT(HOUR FROM timestamp) ORDER BY hour;"}
{"question":"查询用户交互日志中的错误操作（action为'error'）的日志ID和用户ID。","schema":["CREATE TABLE interaction_logs (log_id INT, user_id INT, action TEXT);"],"ground_truth":"SELECT log_id, user_id FROM interaction_logs WHERE action = 'error';"}
{"question":"查询每个用户的首次操作时间。","schema":["CREATE TABLE interaction_logs (log_id INT, user_id INT, timestamp TIMESTAMP);"],"ground_truth":"SELECT user_id, MIN(timestamp) as first_action_time FROM interaction_logs GROUP BY user_id;"}
{"question":"查询操作日志中持续时间超过10秒的操作ID（假设有duration列）。","schema":["CREATE TABLE interaction_logs (log_id INT, duration INT);"],"ground_truth":"SELECT log_id FROM interaction_logs WHERE duration > 10;"}
{"question":"查询每个操作类型的平均持续时间。","schema":["CREATE TABLE interaction_logs (log_id INT, action TEXT, duration INT);"],"ground_truth":"SELECT action, AVG(duration) as avg_duration FROM interaction_logs GROUP BY action;"}
{"question":"查询日志表中用户ID为NULL的日志ID。","schema":["CREATE TABLE interaction_logs (log_id INT, user_id INT);"],"ground_truth":"SELECT log_id FROM interaction_logs WHERE user_id IS NULL;"}
{"question":"查询每个会话的起始和结束时间（最小和最大时间戳）。","schema":["CREATE TABLE interaction_logs (log_id INT, session_id TEXT, timestamp TIMESTAMP);"],"ground_truth":"SELECT session_id, MIN(timestamp) as start_time, MAX(timestamp) as end_time FROM interaction_logs GROUP BY session_id;"}
{"question":"查询操作频率最高的前10个用户ID和操作次数。","schema":["CREATE TABLE interaction_logs (log_id INT, user_id INT);"],"ground_truth":"SELECT user_id, COUNT(*) as action_count FROM interaction_logs GROUP BY user_id ORDER BY action_count DESC LIMIT 10;"}
{"question":"查询日志中的异常IP地址（访问频率超过100次/天的IP）。","schema":["CREATE TABLE interaction_logs (log_id INT, ip_address TEXT, timestamp TIMESTAMP);"],"ground_truth":"SELECT ip_address, COUNT(*) as access_count FROM interaction_logs WHERE DATE(timestamp) = CURRENT_DATE GROUP BY ip_address HAVING COUNT(*) > 100;"}
{"question":"查询每个操作类型的用户数量。","schema":["CREATE TABLE interaction_logs (log_id INT, user_id INT, action TEXT);"],"ground_truth":"SELECT action, COUNT(DISTINCT user_id) as user_count FROM interaction_logs GROUP BY action;"}
{"question":"查询日志表中时间戳在夜间（22:00到06:00）的日志ID和时间戳。","schema":["CREATE TABLE interaction_logs (log_id INT, timestamp TIMESTAMP);"],"ground_truth":"SELECT log_id, timestamp FROM interaction_logs WHERE EXTRACT(HOUR FROM timestamp) >= 22 OR EXTRACT(HOUR FROM timestamp) < 6;"}
{"question":"查询每个用户的最后操作时间。","schema":["CREATE TABLE interaction_logs (log_id INT, user_id INT, timestamp TIMESTAMP);"],"ground_truth":"SELECT user_id, MAX(timestamp) as last_action_time FROM interaction_logs GROUP BY user_id;"}
{"question":"查询操作链序列（连续操作相同action的用户）。","schema":["CREATE TABLE interaction_logs (log_id INT, user_id INT, action TEXT, timestamp TIMESTAMP);"],"ground_truth":"SELECT user_id, action, COUNT(*) as sequence_count FROM interaction_logs GROUP BY user_id, action HAVING COUNT(*) > 1;"}
{"question":"查询日志表中操作重复的记录（相同用户、操作和时间戳）。","schema":["CREATE TABLE interaction_logs (log_id INT, user_id INT, action TEXT, timestamp TIMESTAMP);"],"ground_truth":"SELECT user_id, action, timestamp, COUNT(*) as duplicate_count FROM interaction_logs GROUP BY user_id, action, timestamp HAVING COUNT(*) > 1;"}
{"question":"查询每个操作类型的总持续时间。","schema":["CREATE TABLE interaction_logs (log_id INT, action TEXT, duration INT);"],"ground_truth":"SELECT action, SUM(duration) as total_duration FROM interaction_logs GROUP BY action;"}
{"question":"查询用户交互日志中的页面浏览量（action为'view'）的总数。","schema":["CREATE TABLE interaction_logs (log_id INT, action TEXT);"],"ground_truth":"SELECT COUNT(*) as view_count FROM interaction_logs WHERE action = 'view';"}
{"question":"查询每个用户的平均操作间隔（按秒计算）。","schema":["CREATE TABLE interaction_logs (log_id INT, user_id INT, timestamp TIMESTAMP);"],"ground_truth":"SELECT user_id, AVG(EXTRACT(EPOCH FROM (timestamp - LAG(timestamp) OVER (PARTITION BY user_id ORDER BY timestamp)))) as avg_interval_seconds FROM interaction_logs GROUP BY user_id;"}
{"question":"查询日志表中会话ID为空的日志ID。","schema":["CREATE TABLE interaction_logs (log_id INT, session_id TEXT);"],"ground_truth":"SELECT log_id FROM interaction_logs WHERE session_id IS NULL OR session_id = '';"}
{"question":"查询操作日志的地理分布（基于IP地址的国家代码）。","schema":["CREATE TABLE interaction_logs (log_id INT, ip_country TEXT);"],"ground_truth":"SELECT ip_country, COUNT(*) as log_count FROM interaction_logs GROUP BY ip_country;"}